"use strict";(self.webpackChunkrbac=self.webpackChunkrbac||[]).push([[1764,459],{41435:(e,t,a)=>{a.d(t,{Dl:()=>l,dw:()=>n,e4:()=>s,ir:()=>r});var r,n,o=a(66029);!function(e){e.right="right",e.left="left"}(r||(r={})),function(e){e.up="up",e.down="down"}(n||(n={}));const l=o.createContext({onSelect:e=>{},id:"",toggleIndicatorClass:"",toggleIconClass:"",toggleTextClass:"",menuClass:"",itemClass:"",toggleClass:"",baseClass:"",baseComponent:"div",sectionClass:"",sectionTitleClass:"",sectionComponent:"section",disabledClass:"",plainTextClass:"",menuComponent:"ul"}),s=o.createContext({keyHandler:null,sendRef:null})},46818:(e,t,a)=>{a.d(t,{P8:()=>n});var r=a(78632);const n=()=>({className:r.Z.modifiers.nowrap})},39173:(e,t,a)=>{a.d(t,{Z:()=>m});var r=a(85893),n=a(94184),o=a.n(n),l=a(78956),s=a(6427),i=a(36530),c=function(){return c=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},c.apply(this,arguments)};const m=function(e){var t=e.className,a=e.title,n=e.actionsContent,m=e.ouiaId,u=e.ouiaSafe,d=void 0===u||u,p=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}(e,["className","title","actionsContent","ouiaId","ouiaSafe"]),f=o()(t),g="RHI/Header",y=(0,s.useOUIAId)(g,m,d);return(0,r.jsxs)(i.Flex,{justifyContent:{default:"justifyContentSpaceBetween"},children:[(0,r.jsx)(i.FlexItem,{children:(0,r.jsx)(l.Title,c({headingLevel:"h1",size:"2xl",className:f,"widget-type":"InsightsPageHeaderTitle","data-ouia-component-type":g,"data-ouia-component-id":y,"data-ouia-safe":d},p,{children:a}))}),n?(0,r.jsx)(i.FlexItem,{children:n}):null]})}},7876:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(85893),n=a(94184),o=a.n(n),l=function(){return l=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},l.apply(this,arguments)};const s=function(e){var t,a=e.type,n=e.children,s=e.className,i=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}(e,["type","children","className"]),c=o()(s,((t={})["ins-l-".concat(a)]=void 0!==a,t));return(0,r.jsxs)("section",l({},i,{className:c,children:[" ",n," "]}))}},23340:(e,t,a)=>{a.d(t,{MS:()=>o,aX:()=>r,qF:()=>n});const r=(e,t,a,r={})=>{const n=new URLSearchParams(e.search);let o=a.reduce(((e,t)=>{const a=n.getAll(t);return{...e,[t]:a.length>1?a:a[0]}}),{});return Object.keys(r).forEach((e=>{const t=r[e];o={...o,[e]:Array.isArray(o[e])?[...new Set([...o[e],...Array.isArray(t)?t:[t]])]:t?.length>0&&t||o[e]},Array.isArray(t)?t.forEach((t=>n.getAll(e).includes(t)||n.append(e,t))):n.get(e)||t&&n.set(e,t)})),t({pathname:e.pathname,search:n.toString()},{replace:!0}),o},n=(e,t)=>{const a=new URLSearchParams(e.search);return t.some((e=>a.get(e)))},o=(e,t,a)=>{const r=new URLSearchParams(e.search);Object.keys(a).forEach((e=>r.delete(e))),Object.keys(a).forEach((e=>{const t=a[e];Array.isArray(t)?t.forEach((t=>t&&r.append(e,t))):t&&r.set(e,t)})),t({pathname:e.pathname,search:r.toString()},{replace:!0})}},82617:(e,t,a)=>{a.d(t,{Z:()=>u});var r=a(66029),n=a.n(r),o=a(45697),l=a.n(o),s=a(62012),i=a(75629),c=a(12849);const m=e=>e?n().createElement(i.Breadcrumb,null,Object.values(e).map(((e,t)=>e.title?n().createElement(i.BreadcrumbItem,{key:e.title,isActive:e.isActive},e.to&&n().createElement(s.NavLink,{end:!0,to:e.to},e.title)||e.title):n().createElement(c.Vj,{key:t})))):null;m.propTypes={breadcrumbs:l().object};const u=m},13851:(e,t,a)=>{a.d(t,{Q:()=>E,y:()=>v});var r=a(66029),n=a.n(r),o=a(45697),l=a.n(o),s=a(64380),i=a(86304),c=a(12849),m=a(82617),u=a(85893),d=a(94184),p=a.n(d);const f=n().createContext("light");var g=a(6427),y=function(){return y=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},y.apply(this,arguments)};const h=function(e){var t=e.className,a=e.children,r=e.ouiaId,n=e.ouiaSafe,o=void 0===n||n,l=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}(e,["className","children","ouiaId","ouiaSafe"]),s=p()(t,"pf-v5-l-page-header","pf-v5-c-page-header","pf-v5-l-page__main-section","pf-v5-c-page__main-section"),i="RHI/Header",c=(0,g.useOUIAId)(i,r,o);return(0,u.jsx)(f.Consumer,{children:function(e){var t,r;void 0===e&&(e="light");var n=p()(((t={})["pf-m-".concat(e,"-200")]="dark"===e,t),((r={})["pf-m-light"]="light"===e,r));return(0,u.jsx)("section",y({"data-ouia-component-type":i,"data-ouia-component-id":c,"data-ouia-safe":o},l,{className:"".concat(s," ").concat(n),"widget-type":"InsightsPageHeader",children:a}))}})};var b=a(39173);const E=({children:e,breadcrumbs:t})=>n().createElement(r.Fragment,null,t&&n().createElement("section",{className:"pf-v5-c-page__main-breadcrumb"},n().createElement(m.Z,{...t})),n().createElement(h,{className:"rbac-page-header"},e));E.propTypes={children:l().oneOfType([l().arrayOf(l().node),l().node]).isRequired,breadcrumbs:l().array,paddingBottom:l().bool},E.defaultProps={paddingBottom:!1};const v=({title:e,renderTitleTag:t,description:a,children:o})=>n().createElement(r.Fragment,null,n().createElement(i.Flex,null,n().createElement(i.FlexItem,{className:"pf-v5-u-mb-sm"},n().createElement(b.Z,{title:e||n().createElement(c.h2,null),className:"rbac-page-header__title"})),n().createElement(i.FlexItem,{alignSelf:{modifier:"alignSelfCenter"}},t&&t())),a&&n().createElement(s.TextContent,{className:"rbac-page-header__description"},"string"==typeof a?n().createElement(s.Text,{component:s.TextVariants.p},a):a),o);v.propTypes={title:l().node,renderTitleTag:l().func,description:l().node,children:l().oneOfType([l().node,l().arrayOf(l().node)])}},69493:(e,t,a)=>{a.d(t,{Z:()=>u});var r=a(66029),n=a.n(r),o=a(55573),l=a(45697),s=a.n(l),i=a(94184),c=a.n(i);const m=({className:e,row:t,...a})=>n().createElement(o.e,{className:c()(e,{"rbac-c-group-default":t.isPlatformDefault||t.isAdminDefault}),row:t,...a});m.propTypes={row:s().shape({isAdminDefault:s().bool,isPlatformDefault:s().bool}),className:s().string};const u=m},7841:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var r=a(66029),n=a.n(r),o=a(62012),l=a(7732),s=a(56869),i=a(46818),c=a(31055),m=a(23539),u=a(25387),d=a(55140),p=a(7876),f=a(86706),g=a(97246),y=a(1439),h=a.n(y),b=a(91693),E=a.n(b),v=a(77029),Z=a.n(v),k=a(78972),C=a(64380),O=a(78173),x=a(75863),w=a(61696),M=a(49004),N=a(34844),S=a(94184),I=a.n(S),j=a(45697),P=a.n(j),_=a(62410),R=a(12913),A=a(64756),T=a(29301),B=a(14289),D=a(75614),L=a(2550);const F=({id:e,uuid:t,bodyContent:a})=>{const[o,l]=(0,r.useState)(!1),s=(0,r.useRef)(null);return n().createElement("span",{ref:s,key:`${t}-popover`,id:e},n().createElement(k.Popover,{zIndex:"110",position:"right",isVisible:o,shouldClose:()=>l(!1),hideOnOutsideClick:!0,bodyContent:a,appendTo:s.current},n().createElement(h(),{onClick:()=>l(!o),className:I()("pf-v5-c-question-circle-icon",{"icon-active":o})})))};F.propTypes={id:P().string.isRequired,uuid:P().string.isRequired,bodyContent:P().string.isRequired};var $=a(77044),G=a(13851),H=a(69493),q=a(74982),z=a(23340),V=a(86601);const U=()=>{const e=(0,u.YB)(),t=(0,f.useDispatch)(),a=(0,o.useNavigate)(),y=(0,o.useLocation)(),h=(0,d.Z)(),b=e=>t((0,$.bt)({...e,usesMetaInURL:!0,chrome:h,platformDefault:!1,adminDefault:!1})),{orgAdmin:v,userAccessAdministrator:k}=(0,r.useContext)(V.Z),S=v||k,I=(0,r.useRef)(null),j=[{title:e.formatMessage(L.Z.name),key:"name",transforms:[l.p]},{title:e.formatMessage(L.Z.roles),cellTransforms:[s.z],transforms:[i.P8]},{title:e.formatMessage(L.Z.members),cellTransforms:[s.z],transforms:[i.P8]},{title:e.formatMessage(L.Z.lastModified),key:"modified",transforms:[l.p]}],[P,U]=(0,r.useState)({index:Number(S),direction:"asc"}),[W,X]=(0,r.useState)([]),[Q,Y]=(0,r.useState)([]),[J,K]=(0,r.useState)({}),ee=`${"desc"===P?.direction?"-":""}${j[P?.index-Number(S)].key}`,{groups:te,pagination:ae,filters:re,isLoading:ne}=(0,f.useSelector)((({groupReducer:{groups:{data:e,filters:t,pagination:a},isLoading:r,adminGroup:n,systemGroup:o}})=>({groups:[...n?.name?.match(new RegExp(t.name,"i"))?[n]:[],...o?.name?.match(new RegExp(t.name,"i"))?[o]:[],...e?.filter((({platform_default:e,admin_default:t}={})=>!(e||t)))||[]],pagination:{limit:a?.limit??(v?q.HE:q.he).limit,offset:a?.offset??(v?q.HE:q.he).offset,count:a?.count,redirected:a?.redirected},filters:t,isLoading:r,systemGroup:o})),f.shallowEqual),[oe,le]=(0,r.useState)(re?.name||"");(0,r.useEffect)((()=>{(0,q.oG)(y,a,ae.limit,ae.offset)}),[ae.offset,ae.limit,ae.count,ae.redirected]),(0,r.useEffect)((()=>{(0,z.MS)(y,a,{name:oe})}),[oe]),(0,r.useEffect)((()=>{const{limit:e,offset:r}=(0,q.rj)(y,a,ae),{name:n}=(0,z.aX)(y,a,["name"],{name:oe});le(n),h.appNavClick({id:"groups",secondaryNav:!0}),b({limit:e,offset:r,orderBy:ee,filters:{name:n}}),t((0,$.fB)({filterValue:n,chrome:h})),t((0,$.WD)({filterValue:n,chrome:h}))}),[]),(0,r.useEffect)((()=>{y.pathname.includes("detail")?(0,T.Gw)(y,a):((0,q.Zc)(y)||(0,q.oG)(y,a,ae.limit,ae.offset),oe?.length>0&&!(0,z.qF)(y,["name"])&&(0,z.aX)(y,a,["name"],{name:oe}))}),[y.pathname]);const se=te.map((e=>e.platform_default||e.admin_default?{...e,principalCount:"All"+(e.admin_default?" org admins":"")}:e)),ie=(0,r.useCallback)(((e,a)=>t((0,$.lM)(e,{limit:100},a))),[t]),ce=(0,r.useCallback)((e=>t((0,$.mt)(e,void 0,{limit:100}))),[t]),me=((e,t,a,o=[])=>{const l=(0,u.YB)(),s=[{title:l.formatMessage(L.Z.roleName)},{title:l.formatMessage(L.Z.description)},{title:l.formatMessage(L.Z.lastModified)}],i=[{title:l.formatMessage(L.Z.orgAdministrator)},{title:l.formatMessage(L.Z.firstName)},{title:l.formatMessage(L.Z.lastName)},{title:l.formatMessage(L.Z.username)},{title:l.formatMessage(L.Z.email)},{title:l.formatMessage(L.Z.status)}];return t.reduce(((t,{uuid:c,name:m,roleCount:u,principalCount:d,modified:p,roles:f,members:g,platform_default:y,admin_default:h,isLoadingRoles:b,isLoadingMembers:v},k)=>{const S=`compound-roles-${c}`,I=`compound-members-${c}`;return[...t,{uuid:c,isAdminDefault:h,isPlatformDefault:y,selected:Boolean(a&&a.find((e=>e.uuid===c))),cells:[{title:e?n().createElement(n().Fragment,null,n().createElement(A.Z,{key:`${c}-link`,state:{uuid:c},to:B.Z["group-detail-roles"].link.replace(":groupId",y?D.Cn:c)},m),n().createElement(r.Fragment,null,(y||h)&&n().createElement(F,{id:`default${h?"-admin":""}-group-popover`,uuid:c,key:`${c}-popover`,bodyContent:l.formatMessage(h?L.Z.orgAdminInheritedRoles:L.Z.usersInheritedRoles)}))):m},{title:u,props:{isOpen:2===o[c],ariaControls:S}},{title:d,props:y||h?{className:"rbac-c-not-expandable-cell"}:{isOpen:3===o[c],ariaControls:I}},{title:n().createElement(_.Z,{date:p,type:(0,T.mh)(p)})}]},{uuid:`${c}-roles`,parent:3*k,compoundParent:1,fullWidth:!0,noPadding:!0,cells:[{props:{colSpan:7,className:"pf-m-no-padding"},title:b?n().createElement(R.Z,{rows:u,variant:x.B.compact,columns:s.map((e=>e.title))}):u>0?n().createElement(w.i,{id:S,ouiaId:S,"aria-label":"Compound roles table",variant:x.B.compact,cells:s,rows:f?.map((e=>({cells:[{title:n().createElement(A.Z,{to:B.Z["role-detail"].link.replace(":roleId",e.uuid)},e.name)},e.description,n().createElement(r.Fragment,{key:`${c}-modified`},n().createElement(_.Z,{date:p,type:(0,T.mh)(p)}))]})))},n().createElement(M.x,null),n().createElement(N.R,null)):n().createElement(C.Text,{id:S,className:"pf-u-mx-lg pf-u-my-sm"},l.formatMessage(L.Z.noGroupRoles))}]},{uuid:`${c}-members`,parent:3*k,compoundParent:2,fullWidth:!0,noPadding:!0,cells:[{props:{colSpan:7,className:"pf-m-no-padding"},title:v?n().createElement(R.Z,{rows:d,variant:x.B.compact,columns:i.map((e=>e.title))}):d>0?n().createElement(w.i,{id:I,ouiaId:I,"aria-label":"Compound members table",variant:x.B.compact,cells:i,rows:g?.map((e=>[n().createElement(C.TextContent,{key:e.is_org_admin},e?.is_org_admin?n().createElement(E(),{key:"yes-icon",className:"pf-u-mx-sm"}):n().createElement(Z(),{key:"no-icon",className:"pf-u-mx-sm"}),l.formatMessage(e?.is_org_admin?L.Z.yes:L.Z.no)),e.first_name,e.last_name,e.username,e.email,n().createElement(O.Label,{key:e.is_active,color:e.is_active?"green":"grey"},l.formatMessage(e?.is_active?L.Z.active:L.Z.inactive))]))},n().createElement(M.x,null),n().createElement(N.R,null)):h||y?"":n().createElement(C.Text,{id:I,className:"pf-u-mx-lg pf-u-my-sm"},l.formatMessage(L.Z.noGroupMembers))}]}]}),[])})(S,se,W,J),ue=ae.count===Q.length;return n().createElement(m.Stack,{className:"rbac-c-groups"},n().createElement(m.StackItem,null,n().createElement(G.Q,{paddingBottom:!0},n().createElement(G.y,{title:e.formatMessage(L.Z.groups)}))),n().createElement(m.StackItem,null,n().createElement(p.Z,{type:"content",id:"tab-groups"},n().createElement(g.M,{data:te,rows:me,sortBy:P,onSort:(e,t,r)=>{const n=`${"desc"===r?"-":""}${j[t-Number(S)].key}`;U({index:t,direction:r}),(0,z.MS)(y,a,{name:oe}),b({...ae,orderBy:n,filters:{name:oe}})},columns:j,isExpandable:!0,onExpand:(e,t,a,r,n)=>{r?K({...J,[n.uuid]:-1}):(K({...J,[n.uuid]:a+Number(!S)}),a+Number(!S)===2&&ie(n.uuid,{isPlatformDefault:n.isPlatformDefault,isAdminDefault:n.isAdminDefault}),a+Number(!S)===3&&ce(n.uuid))},isSelectable:S,isRowSelectable:e=>!(e.platform_default||e.admin_default||e.system),checkedRows:W,setCheckedItems:e=>{X((t=>e(t).filter((({platform_default:e,admin_default:t})=>!(e||t))).map((({uuid:e,name:t})=>({uuid:e,name:t})))))},actionResolver:({isPlatformDefault:t,isAdminDefault:r})=>t||r||!S?null:[{title:e.formatMessage(L.Z.edit),onClick:(e,t,r)=>a((0,A.n)(B.Z["edit-group"].link).replace(":groupId",r.uuid))},{title:e.formatMessage(L.Z.delete),onClick:(e,t,r)=>{Y([r]),a((0,A.n)(B.Z["remove-group"].link.replace(":groupId",r.uuid)))}}],titlePlural:e.formatMessage(L.Z.groups).toLowerCase(),titleSingular:e.formatMessage(L.Z.group).toLowerCase(),ouiaId:"groups-table",pagination:ae,filterValue:oe,fetchData:({name:e,count:t,limit:r,offset:n})=>((0,z.MS)(y,a,{name:e}),b({count:t,limit:r,offset:n,orderBy:ee,filters:{name:e}})),setFilterValue:({name:e=""})=>le(e),toolbarButtons:()=>[...S?[n().createElement(A.Z,{to:B.Z["add-group"].link,key:"add-group",className:"rbac-m-hide-on-sm"},n().createElement(c.Button,{ouiaId:"create-group-button",variant:"primary","aria-label":"Create group"},e.formatMessage(L.Z.createGroup))),{label:e.formatMessage(L.Z.createGroup),props:{className:"rbac-m-hide-on-md"},onClick:()=>a((0,A.n)(B.Z["add-group"].link))},{label:e.formatMessage(L.Z.edit),props:{isDisabled:!(1===W.length)},onClick:()=>a((0,A.n)(B.Z["edit-group"].link.replace(":groupId",W[0].uuid)))},{label:e.formatMessage(L.Z.delete),props:{isDisabled:!W.length>0},onClick:()=>{Y(W),a((0,A.n)(B.Z["remove-group"].link.replace(":groupId",W.map((({uuid:e})=>e)))))}}]:[]],isLoading:ne,filterPlaceholder:e.formatMessage(L.Z.name).toLowerCase(),rowWrapper:H.Z,tableId:"groups",textFilterRef:I}),n().createElement(r.Suspense,null,n().createElement(o.Outlet,{context:{pagination:ae,filters:re,[B.Z["add-group"].path]:{orderBy:ee,postMethod:e=>{le(""),b(e)}},[B.Z["edit-group"].path]:{postMethod:e=>{le(""),b({...e,orderBy:ee})},cancelRoute:(0,T.zk)(B.Z.groups.link,ae,re),submitRoute:(0,T.zk)(B.Z.groups.link,{...ae,offset:0},re)},[B.Z["remove-group"].path]:{postMethod:(e,t)=>{b({...t,filters:{name:ue?"":oe},orderBy:ee}),ue&&le(""),X(W.filter((t=>!e.includes(t.uuid))))},cancelRoute:(0,T.zk)(B.Z.groups.link,ae,re),submitRoute:(0,T.zk)(B.Z.groups.link,{...ae,offset:0},ue?{}:re)}}})))))}}}]);
//# sourceMappingURL=../sourcemaps/1764.98533d108ed6d08bae9a4e558c3a3a3a.js.map