(self.webpackChunkinsights_rbac_frontend=self.webpackChunkinsights_rbac_frontend||[]).push([[7905],{7081:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>s,lb:()=>i,wl:()=>o});var n=r(40400);const i={name:"PlusCircleIcon",height:512,width:512,svgPath:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z",yOffset:0,xOffset:0},o=(0,n.IU)(i),s=o},80810:(e,t,r)=>{"use strict";r.d(t,{W1:()=>o,ZP:()=>s,xQ:()=>i});var n=r(40400);const i={name:"SearchIcon",height:512,width:512,svgPath:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z",yOffset:0,xOffset:0},o=(0,n.IU)(i),s=o},21167:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var n=r(4942),i=r(29439),o=r(57262),s=r(92950),a=r.n(s),c=r(45697),l=r.n(c),u=r(41800),p=r(61338);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=function(e){var t=e.isOpen,r=e.handleClose,n=e.permission,c=e.resourceDefinitions,l=(0,s.useState)((function(){return{filterValue:"",rows:c.map((function(e){return e.attributeFilter.value})).slice(0,p.he.limit),pagination:d(d({},p.he),{},{count:c.length})}})),f=(0,i.Z)(l,2),m=f[0],v=m.rows,h=m.pagination,y=m.filterValue,b=f[1],g=function(e){var t=e.name,r=void 0===t?"":t,n=e.limit,i=e.offset,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return b((function(e){var t=e.pagination,s=e.filterValue,a=c.map((function(e){return e.attributeFilter.value})).filter((function(e){return e.includes(r)})).slice(i,n);return{rows:a,filterValue:o?r:s,pagination:d(d({},t),{},{offset:o?0:i,limit:n,count:a.length})}}))};return a().createElement(o.Modal,{actions:[a().createElement(o.Button,{key:"close-action",variant:"primary",onClick:r},"Close")],variant:"large",isOpen:t,onClose:r,title:"Resource definitions",description:a().createElement("p",null,"View resource definitions for the ",a().createElement("strong",null,n)," permission")},a().createElement(u.M,{columns:[""],data:v,filterValue:y,setFilterValue:function(e){return g(e,!0)},pagination:h,ouiaId:"resource-definition-table",noData:0===c.length,createRows:function(e){return e.map((function(e){return{cells:[e]}}))},titlePlural:"Resource definitions",titleSingular:"Resource definition",noDataDescription:["There are no resource definitions for ".concat(n," permission")],fetchData:g,tableId:"resource-definitions-modal"}))};m.propTypes={isOpen:l().bool,handleClose:l().func.isRequired,permission:l().string.isRequired,resourceDefinitions:l().arrayOf(l().shape({attributeFilter:l().shape({value:l().string.isRequired}).isRequired})).isRequired};const v=m},54250:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>U});var n=r(92950),i=r.n(n),o=r(45697),s=r.n(o),a=r(29439),c=r(93433),l=r(63053),u=r(4942),p=r(45987),f=r(28216),d=r(36580),m=r(15861),v=r(87757),h=r.n(v),y=(0,r(89400).TR)();function b(e){return g.apply(this,arguments)}function g(){return(g=(0,m.Z)(h().mark((function e(t){var r,n,i,o,s,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.limit,n=t.offset,i=t.username,o=t.application,s=void 0===o?"":o,a=t.orderBy,e.next=3,y.getPrincipalAccess(s,i,a,r,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=r(61338),P=r(41800),R=function(e){var t=e.onClick,r=e.access;return 0===r.resourceDefinitions.length?i().createElement("span",null,"N/A"):i().createElement("a",{onClick:function(){return t(),!1}},r.resourceDefinitions.length)};R.propTypes={onClick:s().func.isRequired,access:s().shape({resourceDefinitions:s().array.isRequired}).isRequired};const w=R;var D=["permission"],E=r(21167),j=r(1936),k=["application"];function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Z=function(e){var t=e.filters,r=e.setFilters,o=e.apps,s=e.hasActiveFilters,l=e.showResourceDefinitions,m=(0,n.useState)({rdOpen:!1}),v=(0,a.Z)(m,2),h=v[0],y=h.rdOpen,g=h.rdPermission,R=h.resourceDefinitions,Z=v[1],x=(0,n.useRef)([{title:"Application",key:"application",transforms:[j.sortable]},{title:"Resource type",key:"resource_type",transforms:[j.sortable]},{title:"Operation",key:"verb",transforms:[j.sortable]}].concat((0,c.Z)(l?[{title:"Resource definitions"}]:[]))).current,S=(0,f.useDispatch)(),C=(0,f.useSelector)((function(e){return{permissions:e.accessReducer.access,isLoading:e.accessReducer.isLoading}}),f.shallowEqual),T=C.permissions,q=C.isLoading,A=function(e){var t=e.application,r=(0,p.Z)(e,k),n=(null==t?void 0:t.length)>0?t:o;S(function(e){return{type:d.ft,payload:b(e)}}(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({application:n.join(",")},r)))},I=function(e){return Z({rdOpen:!0,rdPermission:T.data[e].permission,resourceDefinitions:T.data[e].resourceDefinitions})};(0,n.useEffect)((function(){A(O.he)}),[]);var _=(null==T?void 0:T.data)||[];return i().createElement(n.Fragment,null,i().createElement(P.M,{columns:x,createRows:function(e){return function(e,t,r){return e.reduce((function(e,o,s){var l=o.permission,u=(0,p.Z)(o,D),f=l.split(":"),d=(0,a.Z)(f,3),m=d[0],v=d[1],h=d[2];return[].concat((0,c.Z)(e),[{cells:[m,v,h].concat((0,c.Z)(t?[i().createElement(n.Fragment,{key:"rd"},i().createElement(w,{onClick:function(){return r(s)},access:u}))]:[]))}])}),[])}(e,l,I)},data:_,fetchData:A,filters:t,setFilterValue:r,isLoading:q,pagination:null==T?void 0:T.meta,ouiaId:"permissions-table",titlePlural:"permissions",titleSingular:"permission",noData:!q&&!s&&0===_.length,noDataDescription:["You do not have individual permissions for Insights.","Contact your Org. Administrator for more information."],tableId:"mua-access"}),i().createElement(n.Suspense,{fallback:i().createElement(n.Fragment,null)},y&&i().createElement(E.default,{resourceDefinitions:R,isOpen:y,handleClose:function(){return Z({rdOpen:!1})},permission:g})))};Z.propTypes={filters:s().arrayOf(s().object).isRequired,setFilters:s().func.isRequired,apps:s().arrayOf(s().string).isRequired,hasActiveFilters:s().bool,showResourceDefinitions:s().bool};const x=Z;var S=r(334),C=r(23279),T=r.n(C),q=r(28090),A=r(19571);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V=(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,21167))})),L=[{title:"Roles",key:"display_name",transforms:[j.sortable]},"Description",{title:"Permissions",cellTransforms:[j.compoundExpand,(0,j.cellWidth)(20)]}],M=function(e){var t=e.fetchRoles,r=e.fetchRoleForPrincipal,o=e.roles,s=e.isLoading,l=e.rolesWithAccess,p=e.filters,f=e.setFilters,d=e.apps,m=e.showResourceDefinitions,v=(0,n.useState)({}),h=(0,a.Z)(v,2),y=h[0],b=h[1],g=(0,n.useState)({rdOpen:!1}),O=(0,a.Z)(g,2),R=O[0],D=R.rdOpen,E=R.rdPermission,k=R.resourceDefinitions,F=O[1];(0,n.useEffect)((function(){t({limit:20,offset:0,orderBy:"display_name",scope:"principal",application:d.join(",")})}),[]);var Z=(0,n.useCallback)(T()((function(e,r,n,i,o,s){var a=(null==i?void 0:i.length)>0?i:d;return t({limit:e,offset:r,scope:"principal",orderBy:s,name:n,application:a.join(","),permission:o})}),800),[]);return i().createElement(n.Fragment,null,i().createElement(P.M,{filters:p,columns:L,isCompact:!1,isExpandable:!0,onExpand:function(e,t,n,i,o){i?b((function(e){return _(_({},e),{},(0,u.Z)({},o.uuid,-1))})):(b((function(e){return _(_({},e),{},(0,u.Z)({},o.uuid,n))})),2===n&&r(o.uuid))},createRows:function(e){return null==e?void 0:e.reduce((function(e,t,r){var o=t.uuid,s=t.display_name,a=t.name,u=t.description,p=t.accessCount;return[].concat((0,c.Z)(e),[{uuid:o,cells:[{title:s||a,props:{component:"th",isOpen:!1}},{title:u,props:{isOpen:!1}},{title:p,props:{isOpen:2===y[o]}}]},{uuid:"".concat(o,"-groups"),parent:2*r,compoundParent:2,cells:[{props:{colSpan:4,className:"pf-m-no-padding"},title:null!=l&&l[o]?i().createElement(j.Table,{ouiaId:"permissions-in-role-nested-table","aria-label":"Simple Table",borders:!1,variant:j.TableVariant.compact,cells:["Application","Resource type","Operation"].concat((0,c.Z)(m?["Resource definitions"]:[])),rows:l[o].access.map((function(e){return{cells:[].concat((0,c.Z)(e.permission.split(":")),(0,c.Z)(m?[i().createElement(n.Fragment,{key:"rd"},i().createElement(w,{onClick:function(){return F({rdOpen:!0,rdPermission:e.permission,resourceDefinitions:e.resourceDefinitions})},access:e}))]:[]))}}))},i().createElement(j.TableHeader,null),i().createElement(j.TableBody,null)):i().createElement(A.Wi,null)}]}])}),[])},ouiaId:"roles-table",data:o.data,fetchData:function(e){var t=e.limit,r=e.offset,n=e.name,i=e.application,o=e.permission,s=e.orderBy;Z(t,r,n,i,o,void 0===s?"display_name":s)},sortBy:{index:0,direction:"asc"},emptyFilters:{name:"",application:[]},setFilterValue:f,isLoading:s,pagination:o.meta,filterPlaceholder:"role name",titlePlural:"roles",titleSingular:"role",tableId:"mua-roles"}),i().createElement(n.Suspense,{fallback:i().createElement(n.Fragment,null)},D&&i().createElement(V,{resourceDefinitions:k,isOpen:D,handleClose:function(){return F({rdOpen:!1})},permission:E})))};M.propTypes={fetchRoles:s().func,fetchRoleForPrincipal:s().func,fetchUsers:s().func,roles:s().object,isLoading:s().bool,rolesWithAccess:s().object,filters:s().arrayOf(s().object).isRequired,setFilters:s().func.isRequired,apps:s().arrayOf(s().string).isRequired,showResourceDefinitions:s().bool};const W=(0,S.withRouter)((0,f.connect)((function(e){var t=e.roleReducer;return{roles:t.roles,isLoading:t.isLoading,rolesWithAccess:t.rolesWithAccess}}),(function(e){return{fetchRoles:function(t){return e((0,q.vd)(t))},fetchRoleForPrincipal:function(t){return e((0,q.DV)(t))}}}))(M));var B=function(e){var t=e.apps,r=(0,n.useContext)(l.Z),o=(0,n.useState)(""),s=(0,a.Z)(o,2),u=s[0],p=s[1],f=(0,n.useState)(""),d=(0,a.Z)(f,2),m=d[0],v=d[1],h=(0,n.useState)([]),y=(0,a.Z)(h,2),b=y[0],g=y[1],O=function(e){var t=e.name,r=e.application,n=e.permission;"string"==typeof t&&p(t),"string"==typeof n&&v(n),r&&g("string"==typeof r?[]:r)},P=function(e){var t=e.isOrgAdmin,r=e.name,n=void 0===r?"":r,i=e.application;return[{key:"application",value:void 0===i?[]:i,placeholder:"Filter by application",type:"checkbox",items:e.apps.map((function(e){return{label:e,value:e}}))}].concat((0,c.Z)(t?[{key:"name",type:"text",value:n,label:"Role name",placeholder:"Filter by role name"}]:[]))}({apps:t,isOrgAdmin:r,name:u,application:b,permission:m});return r?i().createElement(W,{setFilters:O,filters:P,apps:t}):i().createElement(x,{setFilters:O,filters:P,apps:t,hasActiveFilters:u.length>0||b.length>0})};B.propTypes={apps:s().arrayOf(s().string).isRequired};const N=B;var z=function(e){var t=e.apps;return i().createElement(N,{apps:t})};z.propTypes={apps:s().arrayOf(s().string).isRequired};const U=z},63012:(e,t,r)=>{var n=r(97786),i=r(10611),o=r(71811);e.exports=function(e,t,r){for(var s=-1,a=t.length,c={};++s<a;){var l=t[s],u=n(e,l);r(u,l)&&i(c,o(l,e),u)}return c}},10611:(e,t,r)=>{var n=r(34865),i=r(71811),o=r(65776),s=r(13218),a=r(40327);e.exports=function(e,t,r,c){if(!s(e))return e;for(var l=-1,u=(t=i(t,e)).length,p=u-1,f=e;null!=f&&++l<u;){var d=a(t[l]),m=r;if("__proto__"===d||"constructor"===d||"prototype"===d)return e;if(l!=p){var v=f[d];void 0===(m=c?c(v,d,f):void 0)&&(m=s(v)?v:o(t[l+1])?[]:{})}n(f,d,m),f=f[d]}return e}},27561:(e,t,r)=>{var n=r(67990),i=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},67990:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},23279:(e,t,r)=>{var n=r(13218),i=r(7771),o=r(14841),s=Math.max,a=Math.min;e.exports=function(e,t,r){var c,l,u,p,f,d,m=0,v=!1,h=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var r=c,n=l;return c=l=void 0,m=t,p=e.apply(n,r)}function g(e){return m=e,f=setTimeout(P,t),v?b(e):p}function O(e){var r=e-d;return void 0===d||r>=t||r<0||h&&e-m>=u}function P(){var e=i();if(O(e))return R(e);f=setTimeout(P,function(e){var r=t-(e-d);return h?a(r,u-(e-m)):r}(e))}function R(e){return f=void 0,y&&c?b(e):(c=l=void 0,p)}function w(){var e=i(),r=O(e);if(c=arguments,l=this,d=e,r){if(void 0===f)return g(d);if(h)return clearTimeout(f),f=setTimeout(P,t),b(d)}return void 0===f&&(f=setTimeout(P,t)),p}return t=o(t)||0,n(r)&&(v=!!r.leading,u=(h="maxWait"in r)?s(o(r.maxWait)||0,t):u,y="trailing"in r?!!r.trailing:y),w.cancel=function(){void 0!==f&&clearTimeout(f),m=0,c=d=l=f=void 0},w.flush=function(){return void 0===f?p:R(i())},w}},7771:(e,t,r)=>{var n=r(55639);e.exports=function(){return n.Date.now()}},35937:(e,t,r)=>{var n=r(29932),i=r(67206),o=r(63012),s=r(46904);e.exports=function(e,t){if(null==e)return{};var r=n(s(e),(function(e){return[e]}));return t=i(t),o(e,r,(function(e,r){return t(e,r[0])}))}},14841:(e,t,r)=>{var n=r(27561),i=r(13218),o=r(33448),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=a.test(e);return r||c.test(e)?l(e.slice(2),r?2:8):s.test(e)?NaN:+e}}}]);
//# sourceMappingURL=../sourcemaps/7905.60925a7d6aa7dce07ea71cb070808511.js.map