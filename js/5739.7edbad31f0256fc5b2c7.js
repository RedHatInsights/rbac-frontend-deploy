(self.webpackChunkrbac=self.webpackChunkrbac||[]).push([[5739,459],{31495:(e,t,r)=>{"use strict";r.d(t,{Mi:()=>s,Uv:()=>o,wk:()=>l,z1:()=>i});var a=r(66029),n=r(80164);const o={isManagedSidebar:!1,isSidebarOpen:!1,onSidebarToggle:()=>null,width:null,height:null,getBreakpoint:n.iu,getVerticalBreakpoint:n.xb},i=a.createContext(o),s=i.Provider,l=i.Consumer},60817:function(e,t,r){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)},n=this&&this.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Portal=t.NotificationPortal=t.NotificationPortalBase=void 0;var i=r(85893),s=r(86706),l=o(r(72837)),c=r(53446),m=r(79206);t.NotificationPortalBase=function(e){var t=e.clearNotifications,r=n(e,["clearNotifications"]),o=(0,s.useSelector)((function(e){return e.notifications})),m=(0,s.useDispatch)();return(0,i.jsx)(l.default,a({notifications:o,removeNotification:function(e){return m((0,c.removeNotification)(e))},onClearAll:t||function(){return m((0,c.clearNotifications)())}},r))},t.NotificationPortal=function(e){var r=e.silent,o=void 0===r||r,s=n(e,["silent"]);return(0,i.jsx)(m.ErrorBoundary,{headerTitle:"Notifications portal",silent:o,children:(0,i.jsx)(t.NotificationPortalBase,a({},s))})};var d=r(72837);Object.defineProperty(t,"Portal",{enumerable:!0,get:function(){return o(d).default}}),t.default=t.NotificationPortal},72871:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,n)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(60817);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o(i).default}}),n(r(60817),t)},71355:function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.notificationsMiddleware=t.clearNotifications=t.removeNotification=t.addNotification=t.CLEAR_NOTIFICATIONS=t.REMOVE_NOTIFICATION=t.ADD_NOTIFICATION=t.notificationsReducers=t.notifications=t.NotificationsPortal=void 0;var n=r(72871);Object.defineProperty(t,"NotificationsPortal",{enumerable:!0,get:function(){return a(n).default}});var o=r(24778);Object.defineProperty(t,"notifications",{enumerable:!0,get:function(){return a(o).default}}),Object.defineProperty(t,"notificationsReducers",{enumerable:!0,get:function(){return o.notificationsReducers}});var i=r(68129);Object.defineProperty(t,"ADD_NOTIFICATION",{enumerable:!0,get:function(){return i.ADD_NOTIFICATION}}),Object.defineProperty(t,"REMOVE_NOTIFICATION",{enumerable:!0,get:function(){return i.REMOVE_NOTIFICATION}}),Object.defineProperty(t,"CLEAR_NOTIFICATIONS",{enumerable:!0,get:function(){return i.CLEAR_NOTIFICATIONS}});var s=r(53446);Object.defineProperty(t,"addNotification",{enumerable:!0,get:function(){return s.addNotification}}),Object.defineProperty(t,"removeNotification",{enumerable:!0,get:function(){return s.removeNotification}}),Object.defineProperty(t,"clearNotifications",{enumerable:!0,get:function(){return s.clearNotifications}});var l=r(84885);Object.defineProperty(t,"notificationsMiddleware",{enumerable:!0,get:function(){return a(l).default}})},68129:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLEAR_NOTIFICATIONS=t.REMOVE_NOTIFICATION=t.ADD_NOTIFICATION=void 0;var r="@@INSIGHTS-CORE/NOTIFICATIONS/";t.ADD_NOTIFICATION="".concat(r,"ADD_NOTIFICATION"),t.REMOVE_NOTIFICATION="".concat(r,"REMOVE_NOTIFICATION"),t.CLEAR_NOTIFICATIONS="".concat(r,"CLEAR_NOTIFICATIONS"),t.default={ADD_NOTIFICATION:t.ADD_NOTIFICATION,REMOVE_NOTIFICATION:t.REMOVE_NOTIFICATION,CLEAR_NOTIFICATIONS:t.CLEAR_NOTIFICATIONS}},53446:function(e,t,r){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.clearNotifications=t.removeNotification=t.addNotification=void 0;var n=r(68129);t.addNotification=function(e){return{type:n.ADD_NOTIFICATION,payload:a({id:("notification","cloud-servicesnotification-"+(new Date).getTime()+Math.random().toString(36).slice(2))},e)}},t.removeNotification=function(e){return{type:n.REMOVE_NOTIFICATION,payload:e}},t.clearNotifications=function(){return{type:n.CLEAR_NOTIFICATIONS}},t.default={addNotification:t.addNotification,removeNotification:t.removeNotification,clearNotifications:t.clearNotifications}},24778:function(e,t,r){"use strict";var a=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.notifications=t.notificationsReducers=t.defaultState=void 0;var n=r(68129);t.defaultState=[],t.notificationsReducers=function(e,r){switch(void 0===e&&(e=t.defaultState),r.type){case n.ADD_NOTIFICATION:return o=e,i=r.payload,a(a([],o,!0),[i],!1);case n.REMOVE_NOTIFICATION:return function(e,t){var r=t.payload,n=e.findIndex((function(e){return e.id===r}));return a(a([],e.slice(0,n),!0),e.slice(n+1),!0)}(e,r);case n.CLEAR_NOTIFICATIONS:return[];default:return e}var o,i},t.notifications=t.notificationsReducers,t.default=t.notifications},79206:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ErrorBoundary:()=>a.Z,default:()=>a.Z}),r(27351);var a=r(49314)},87767:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var a=r(31055),n=r(66029),o=r.n(n),i=r(45697),s=r.n(i),l=(r(27361),r(48880));s().oneOfType([s().string,s().func,s().object]),s().func.isRequired,s().node.isRequired,s().bool,s().func.isRequired,s().node.isRequired,s().func.isRequired;const c=({renderNextButton:e,disableBack:t,handlePrev:r,buttonLabels:{cancel:i,back:s},context:c})=>{const m=(0,l.default)(),{success:d,error:u,submitting:p}=(0,n.useContext)(c);return d||void 0===u||u||p?null:o().createElement(n.Fragment,null,e(),o().createElement(a.Button,{type:"button",variant:"secondary",isDisabled:t,onClick:r},s),o().createElement(a.Button,{type:"button",variant:"link",onClick:m.onCancel},i))};c.propTypes={disableBack:s().bool,handlePrev:s().func.isRequired,handleNext:s().func.isRequired,nextStep:s().oneOfType([s().string,s().shape({when:s().string.isRequired,stepMapper:s().object.isRequired}),s().func]),buttonLabels:s().shape({submit:s().node.isRequired,cancel:s().node.isRequired,back:s().node.isRequired,next:s().node.isRequired}).isRequired,context:s().object.isRequired,renderNextButton:s().func};const m=c},56640:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var a=r(66029),n=r.n(a),o=r(31055),i=r(70363),s=r(25387),l=r(45697),c=r.n(l),m=r(2550),d=r(56756);const u=({context:e,title:t,text:r,customFooter:l})=>{const c=(0,s.YB)(),{jumpToStep:u}=(0,a.useContext)(i.default),{setWizardError:p}=(0,a.useContext)(e);return n().createElement(d.Te,{errorTitle:t,errorDescription:r,customFooter:l||n().createElement(o.Button,{onClick:()=>{p(void 0),u(0)},variant:o.ButtonVariant.primary},c.formatMessage(m.Z.returnToStepNumber,{number:1}))})};u.propTypes={context:c().object.isRequired,title:c().string.isRequired,text:c().string.isRequired,customFooter:c().element};const p=u},56280:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddRoleWizardContext:()=>ve,default:()=>Te,mapperExtension:()=>be});var a=r(66029),n=r.n(a),o=r(45697),i=r.n(o),s=r(86706),l=r(25387),c=r(71355),m=r(51912),d=r(67850),u=r(8340),p=r(9820),f=r(29301),g=r(55140),y=r(64124),v=r(52229),h=r(74503),E=r(15950),b=r(64380),I=r(72232),T=r(19443),N=r(47625),O=r(48880),C=r(60167),x=r(2550),M=r(2034);const R=async e=>{const t=(0,l.Sn)(),r=(0,l.dp)({locale:C.S,messages:M},t);if(!e)return;const a=await(0,T.vd)({limit:10,offset:0,name:e,nameMatch:"exact"}).catch((e=>{console.error(e)})),n=await(0,T.vd)({limit:10,offset:0,displayName:e,nameMatch:"exact"}).catch((e=>{console.error(e)}));if(a?.data?.length>0||n?.data?.length>0)throw r.formatMessage(x.Z.nameAlreadyTaken)},Z=(0,N.Z)(R),S=({name:e})=>{const t=(0,O.default)();return(0,a.useEffect)((()=>(setTimeout((()=>t.change(e,"1"))),()=>t.change(e,""))),[]),null};S.propTypes={name:i().string.isRequired};var _=r(56640);const A=({formFields:e})=>{const t=(0,l.YB)(),{submitting:r,error:o,setWizardError:i}=(0,a.useContext)(ve),{getState:s}=(0,O.default)();return(0,a.useEffect)((()=>{i(void 0),R(s().values["role-name"]).then((()=>i(!1))).catch((()=>i(!0)))}),[]),void 0===o||r?n().createElement(h.Bullseye,null,n().createElement(E.Spinner,{size:"xl"})):!0===o?n().createElement(_.Z,{context:ve,title:t.formatMessage(x.Z.roleNameTakenTitle),text:t.formatMessage(x.Z.roleNameTakenText)}):n().createElement("div",{className:"rbac"},n().createElement(I.Title,{headingLevel:"h1",size:"xl",className:"pf-v5-u-mb-sm"},t.formatMessage(x.Z.reviewDetails)),n().createElement(b.TextContent,{className:"pf-v5-u-mb-md"},n().createElement(b.Text,null,t.formatMessage(x.Z.reviewRoleDetails))),e?.[0]?.[0])};A.propTypes={formFields:i().array};const F=A,k=({formFields:e})=>{const t=(0,l.YB)();return n().createElement("div",{className:"rbac"},n().createElement(I.Title,{headingLevel:"h1",size:"xl",className:"pf-v5-u-mb-lg"},t.formatMessage(x.Z.defineCostResources)),e)};k.propTypes={formFields:i().array};const w=k;var D=r(87767),P=r(92884),j=r(68539),B=r(13563),q=r(79083),G=r(55218),L=r(31055),V=r(95376),z=r(71214),W=r.n(z),H=r(64756),$=r(14289);const Y=({onClose:e})=>{const{setHideForm:t,setWizardSuccess:r}=(0,a.useContext)(ve),o=(0,l.YB)();return n().createElement(V.EmptyState,{variant:V.EmptyStateVariant.lg},n().createElement(V.EmptyStateHeader,{titleText:n().createElement(n().Fragment,null,o.formatMessage(x.Z.roleCreatedSuccessfully)),icon:n().createElement(V.EmptyStateIcon,{color:"green",icon:W()}),headingLevel:"h4"}),n().createElement(V.EmptyStateBody,null),n().createElement(V.EmptyStateFooter,null,n().createElement(L.Button,{onClick:e,variant:"primary"},o.formatMessage(x.Z.exit)),n().createElement(V.EmptyStateActions,null,n().createElement(L.Button,{onClick:()=>{t(!1),r(!1)},variant:"link"},o.formatMessage(x.Z.createAnotherRole)),n().createElement(L.Button,{component:e=>n().createElement(H.Z,{to:$.Z.groups.link,...e}),variant:"link"},o.formatMessage(x.Z.addRoleToGroup)))))};Y.propTypes={onClose:i().func.isRequired};const U=Y;var Q=r(73893),K=r(5904),X=r(97246),J=r(81169),ee=r(7732);const te=({roleReducer:{rolesForWizard:e,isWizardLoading:t}})=>({roles:e.data,pagination:e.meta,isWizardLoading:t});var re=r(55594),ae=r(23539),ne=r(9545);const oe=(e,t)=>n().createElement("div",{className:"rbac-c-sticky"},n().createElement(ne.Grid,{className:"rbac-c-sticky--title"},e.map((t=>n().createElement(ne.GridItem,{span:12/e.length,key:t},t)))),n().createElement(ne.Grid,{className:"rbac-c-sticky--data"},t.map((t=>t.cells.map((t=>n().createElement(ne.GridItem,{span:12/e.length,key:t},t)))))));var ie=r(51880),se=r(47108);var le=r(16987),ce=r(56591),me=r(45047),de=r(9294);const ue=e=>{const t=(0,l.YB)(),{input:r}=(0,J.Z)(e),o=(0,O.default)(),{"role-name":i,"role-description":s}=o.getState().values,[c,m]=(0,a.useState)(i||""),[d,u]=(0,a.useState)(),[p,g]=(0,a.useState)(s),y=e=>{const t=(0,f.vE)(e);r.onChange(void 0),Z(t).then((()=>{r.onChange(t),u(void 0)})).catch((e=>{u(e),r.onChange(void 0)})),m(e)};(0,a.useEffect)((()=>{c?.length>0&&y(c)}),[]);const v=((e,t)=>void 0===e||t||e?.length>150?"error":"default")(c,d),h=(e=>e?.length>150?"error":"default")(p);return n().createElement(ae.Stack,{hasGutter:!0},n().createElement(ae.StackItem,{className:"rbac-l-stack__item-summary"},n().createElement(le.FormGroup,{label:t.formatMessage(x.Z.roleName),isRequired:!0},n().createElement(de.TextInput,{id:"role-name",value:c,type:"text",validated:v,onBlur:()=>""===c&&m(void 0),onChange:(e,t)=>y(t),"aria-label":"Role name"}),"error"===v&&n().createElement(le.FormHelperText,null,n().createElement(ce.HelperText,null,n().createElement(ce.HelperTextItem,{variant:v},c?d:t.formatMessage(x.Z.required)))))),n().createElement(ae.StackItem,null,n().createElement(le.FormGroup,{label:t.formatMessage(x.Z.roleDescription)},n().createElement(me.TextArea,{id:"role-description",value:p,validated:h,onChange:(e,t)=>{g(t),o.change("role-description",t)},"aria-label":"Role description",resizeOrientation:"vertical"}),"error"===h&&n().createElement(le.FormHelperText,null,n().createElement(ce.HelperText,null,n().createElement(ce.HelperTextItem,{variant:h},t.formatMessage(x.Z.maxCharactersWarning,{number:150})))))))};ue.propTypes={name:i().string,description:i().string};const pe=ue;var fe=r(84414);class ge extends n().Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){if(!e.message.includes(this.props.silentErrorString))throw this.setState({hasError:!1}),e}render(){return this.state.hasError?null:this.props.children}}ge.propTypes={children:i().node.isRequired,silentErrorString:i().string.isRequired};const ye=ge,ve=(0,a.createContext)({success:!1,submitting:!1,error:void 0}),he=e=>n().createElement(d.ZP,{...e,showFormControls:!1}),Ee=({Content:e,...t})=>n().createElement(e,{...t});Ee.propTypes={Content:i().elementType.isRequired};const be={"set-name":pe,"base-role-table":e=>{const t=(0,l.YB)(),r=(0,s.useDispatch)(),o=e=>r((0,B.hs)(e)),[i,c]=(0,a.useState)(""),{roles:m,pagination:d,isWizardLoading:u}=(0,s.useSelector)(te,s.shallowEqual),{input:p}=(0,J.Z)(e),g=(0,O.default)(),y=[{title:""},{title:t.formatMessage(x.Z.name),key:"display_name",transforms:[ee.p]},{title:t.formatMessage(x.Z.description)}],[v,h]=(0,a.useState)({index:1,direction:"asc"}),E=`${"desc"===v?.direction?"-":""}${y[v?.index].key}`;return(0,a.useEffect)((()=>{o({limit:50,offset:0,itemCount:0,orderBy:E})}),[]),n().createElement("div",null,n().createElement(K.Alert,{variant:"info",isInline:!0,title:t.formatMessage(x.Z.granularPermissionsWillBeCopied)}),n().createElement(X.M,{columns:y,rows:(e=>e.map((e=>({cells:[{title:n().createElement(Q.Radio,{id:`${e.uuid}-radio`,name:`${e.name}-radio`,"aria-label":`${e.name}-radio`,ouiaId:`${e.name}-radio`,value:e.uuid,isChecked:p.value.uuid===e.uuid,onChange:()=>{g.batch((()=>{p.onChange(e),g.change("role-copy-name",`Copy of ${e.display_name||e.name}`),g.change("role-copy-description",e.description),g.change("add-permissions-table",[]),g.change("base-permissions-loaded",!1),g.change("not-allowed-permissions",[])}))}}),props:{className:"pf-v5-c-table__check"}},e.display_name||e.name,e.description]}))))(m),data:m,fetchData:e=>{o((0,f.jl)(e))},filterValue:i,setFilterValue:({name:e})=>c(e),isLoading:u,sortBy:v,onSort:(e,t,r)=>{const a=`${"desc"===r?"-":""}${y[t].key}`;h({index:t,direction:r}),o({...d,offset:0,orderBy:a})},pagination:d,titlePlural:t.formatMessage(x.Z.roles),titleSingular:t.formatMessage(x.Z.role),filterPlaceholder:t.formatMessage(x.Z.roleName).toLowerCase(),ouiaId:"roles-table",isCompact:!0,tableId:"base-role"}))},"add-permissions-table":re.Z,"cost-resources":se.Z,"inventory-groups-role":ie.Z,review:()=>{const e=(0,l.YB)(),t=(0,q.useFlag)("platform.rbac.groups-to-workspaces-rename"),r=(0,O.default)(),{"role-name":a,"role-description":o,"role-copy-name":i,"role-copy-description":s,"add-permissions-table":c,"resource-definitions":m,"has-cost-resources":d,"inventory-group-permissions":u,"role-type":p}=r.getState().values,f=[e.formatMessage(x.Z.application),e.formatMessage(x.Z.resourceType),e.formatMessage(x.Z.operation)],g=c.map((e=>({cells:e.uuid.split(":")}))),y=(m||[]).map((({permission:e,resources:t})=>({cells:[e,t.join(", ")]}))),v=(u||[]).map((({permission:t,groups:r})=>({cells:[t,r?.map((t=>null===t?.id?e.formatMessage(x.Z.ungroupedSystems):t?.name)).join(", ")]})));return n().createElement(n().Fragment,null,n().createElement(ae.Stack,null,n().createElement(ae.StackItem,{className:"rbac-l-stack__item-summary"},n().createElement(ne.Grid,null,n().createElement(ne.GridItem,{sm:12,md:2},n().createElement(b.Text,{component:b.TextVariants.h4,className:"rbac-bold-text"},e.formatMessage(x.Z.name))),n().createElement(ne.GridItem,{sm:12,md:10},n().createElement(b.Text,{component:b.TextVariants.p},"create"===p?a:i))),n().createElement(ne.Grid,null,n().createElement(ne.GridItem,{sm:12,md:2},n().createElement(b.Text,{component:b.TextVariants.h4,className:"rbac-bold-text"},e.formatMessage(x.Z.description))),n().createElement(ne.GridItem,{sm:12,md:10},n().createElement(b.Text,{component:b.TextVariants.p},"create"===p?o:s))),n().createElement(ne.Grid,null,n().createElement(ne.GridItem,{sm:12,md:2},n().createElement(b.Text,{component:b.TextVariants.h4,className:"rbac-bold-text"},e.formatMessage(x.Z.permissions))),n().createElement(ne.GridItem,{sm:12,md:10},oe(f,g))),u&&n().createElement(ne.Grid,null,n().createElement(ne.GridItem,{sm:12,md:2},n().createElement(b.Text,{component:b.TextVariants.h4,className:"rbac-bold-text"},e.formatMessage(x.Z.resourceDefinitions))),n().createElement(ne.GridItem,{sm:12,md:10},oe([e.formatMessage(x.Z.permission),e.formatMessage(t?x.Z.workspacesDefinition:x.Z.groupDefinition)],v))),d&&n().createElement(ne.Grid,null,n().createElement(ne.GridItem,{sm:12,md:2},n().createElement(b.Text,{component:b.TextVariants.h4,className:"rbac-bold-text"},e.formatMessage(x.Z.resourceDefinitions))),n().createElement(ne.GridItem,{sm:12,md:10},oe([e.formatMessage(x.Z.permission),e.formatMessage(x.Z.resourceDefinitions)],y))))))},description:Ee,"type-selector":e=>{const t=(0,l.YB)(),{input:r}=(0,J.Z)(e),o=(0,O.default)(),[i,s]=(0,a.useState)(o.getState().values["role-type"]),c=e=>{s(e),r.onChange(e),o.change("add-permissions-table",[]),o.change("base-permissions-loaded",!1),o.change("not-allowed-permissions",[])};return n().createElement("div",null,n().createElement(Q.Radio,{isChecked:"create"===i,className:"pf-v5-u-mb-sm",name:"role-type-create",onChange:()=>c("create"),label:t.formatMessage(x.Z.createRoleFromScratch),id:"role-type-create",value:"create"}),n().createElement(Q.Radio,{isChecked:"copy"===i,name:"role-type-copy",onChange:()=>c("copy"),label:t.formatMessage(x.Z.copyAnExistingRole),id:"role-type-copy",value:"copy"}))}},Ie=({pagination:e,filters:t,orderBy:r})=>{const o=(0,l.YB)(),i=(0,s.useDispatch)(),d=(0,fe.Z)(),h=(0,g.Z)(),E=(0,q.useFlag)("platform.rbac.groups-to-workspaces-rename"),[b,I]=(0,a.useState)({success:!1,submitting:!1,error:void 0,hideForm:!1}),[T,N]=(0,a.useState)(!1),O=(0,a.useRef)(document.createElement("div")),[R,_]=(0,a.useState)();(0,a.useEffect)((()=>{_(((e,t)=>{const r=(0,l.Sn)(),a=(0,l.dp)({locale:C.S,messages:M},r);return{fields:[{component:"wizard",name:"wizard",isDynamic:!0,inModal:!0,showTitles:!0,crossroads:["role-type"],title:a.formatMessage(x.Z.createRole),style:{overflow:"hidden"},container:e,fields:[{title:a.formatMessage(x.Z.createRole),name:"step-1",nextStep:{when:"role-type",stepMapper:{copy:"name-and-description",create:"add-permissions"}},fields:[{component:"type-selector",name:"role-type",isRequired:!0,validate:[{type:y.Z.REQUIRED}]},{component:"set-name",name:"role-name",type:"text",validate:[{type:y.Z.REQUIRED},{type:y.Z.MAX_LENGTH,threshold:150}],condition:{when:"role-type",is:"create"}},{component:"text-field",name:"role-description",hideField:!0},{component:"base-role-table",name:"copy-base-role",label:a.formatMessage(x.Z.baseRole),isRequired:!0,condition:{when:"role-type",is:"copy"},validate:[{type:y.Z.REQUIRED}]},{condition:{when:"role-type",is:"create"},component:"description",name:"fixasyncvalidation",Content:S},{condition:{when:"role-type",is:"copy"},component:"description",name:"fixasyncvalidation2",Content:S}]},{title:a.formatMessage(x.Z.nameAndDescription),name:"name-and-description",nextStep:"add-permissions",fields:[{component:"text-field",name:"role-copy-name",type:"text",label:a.formatMessage(x.Z.roleName),isRequired:!0,validate:[Z,{type:y.Z.REQUIRED},{type:"max-length",threshold:150}]},{component:"text-field",name:"role-copy-description",type:"text",label:a.formatMessage(x.Z.roleDescription),validate:[{type:"max-length",threshold:150}]}]},{name:"add-permissions",title:a.formatMessage(x.Z.addPermissions),StepTemplate:v.Z,nextStep:({values:e})=>(0,P.j)("add-permissions",e),fields:[{component:"add-permissions-table",name:"add-permissions-table"}]},{title:a.formatMessage(t?x.Z.workspacesAccessTitle:x.Z.inventoryGroupsAccessTitle),name:"inventory-groups-role",StepTemplate:j.Z,nextStep:({values:e})=>(0,P.j)("inventory-groups-role",e),fields:[{component:"plain-text",name:"cost-resources",label:n().createElement("p",{className:"pf-v5-u-mb-md"},a.formatMessage(t?x.Z.applyWorkspacesRolePermission:x.Z.applyInventoryGroupsRolePermission))},{component:"inventory-groups-role",name:"inventory-groups-role",validate:[(e=[])=>e?.every((({groups:e,permission:t})=>e?.length>0&&t))?void 0:a.formatMessage(x.Z.assignAtLeastOneInventoryGroup)]}]},{name:"cost-resources-definition",title:a.formatMessage(x.Z.defineCostResources),nextStep:"review",StepTemplate:w,fields:[{component:"plain-text",name:"text-description",label:n().createElement("p",{className:"pf-v5-u-mb-md"},a.formatMessage(x.Z.applyCostPermissionText))},{component:"cost-resources",name:"cost-resources",validate:[(e=[])=>e?.every((({resources:e})=>e?.length>0))?void 0:a.formatMessage(x.Z.assignAtLeastOneResource)]}]},{name:"review",title:a.formatMessage(x.Z.reviewDetails),buttons:e=>n().createElement(D.Z,{...e,context:ve}),StepTemplate:F,fields:[{component:"review",name:"review"}]}]}]}})(O.current,E))}),[]);const A=()=>d({pathname:$.Z.roles.link,search:(0,f.GT)({page:1,per_page:e.limit,...t})}),k=()=>{b.success||i((0,c.addNotification)({variant:"warning",title:o.formatMessage(x.Z.creatingRoleCanceled),dismissDelay:8e3})),N(!1),d({pathname:$.Z.roles.link,search:(0,f.GT)({page:1,per_page:e.limit,...t})})};return R?n().createElement(ve.Provider,{value:{...b,setWizardError:e=>I((t=>({...t,error:e}))),setWizardSuccess:e=>I((t=>({...t,success:e}))),setHideForm:e=>I((t=>({...t,hideForm:e})))}},n().createElement(ye,{silentErrorString:"focus-trap"},n().createElement(G.Z,{title:o.formatMessage(x.Z.exitItemCreation,{item:o.formatMessage(x.Z.role).toLocaleLowerCase()}),confirmButtonLabel:o.formatMessage(x.Z.discard),isOpen:T,onClose:()=>{O.current.hidden=!1,N(!1)},onConfirm:k},o.formatMessage(x.Z.discardedInputsWarning))),b.hideForm?b.success?n().createElement(p.e,{title:o.formatMessage(x.Z.createRole),isOpen:!0,onClose:A,steps:[{name:"success",component:n().createElement(U,{onClose:A}),isFinishedStep:!0}]}):null:n().createElement(m.Z,{schema:R,container:O,subscription:{values:!0},FormTemplate:he,initialValues:{"role-type":"create"},componentMapper:{...u.ZP,...be},onSubmit:t=>{const{"role-name":a,"role-description":n,"role-copy-name":o,"role-copy-description":s,"add-permissions-table":l,"inventory-groups-role":c,"cost-resources":m,"role-type":d}=t,u=l.map((e=>e.uuid)),p={applications:[...new Set(l.map((({uuid:e})=>e.split(":")[0])))],description:("create"===d?n:s)||null,name:"create"===d?a:o,access:l.reduce(((e,{uuid:t,requires:r=[]})=>[...e,...[t,...r.filter((e=>!u.includes(e)))].map((e=>{let t;return e.includes("cost-management")?t={key:`cost-management.${e.split(":")[1]}`,operation:"in",value:m?.find((t=>t.permission===e))?.resources}:e.includes("inventory")&&(t={key:"group.id",operation:"in",value:c?.find((t=>t.permission===e))?.groups?.map((e=>e?.id))}),{permission:e,resourceDefinitions:t?[{attributeFilter:t}]:[]}}))]),[])};return i((0,B.fA)(p)).then((()=>{I((e=>({...e,submitting:!1,success:!0,hideForm:!0}))),i((0,B.Kt)({limit:e.limit,orderBy:r,usesMetaInURL:!0,chrome:h}))})).catch((()=>{I((e=>({...e,submitting:!1,success:!1,hideForm:!0}))),i((0,B.Kt)({limit:e.limit,orderBy:r,usesMetaInURL:!0,chrome:h})),A()}))},onCancel:e=>{Boolean(e&&e["role-name"]||e["role-description"]||e["copy-base-role"])?(O.current.hidden=!0,N(!0)):k()}})):null};Ie.propTypes={pagination:i().shape({limit:i().number.isRequired}).isRequired,filters:i().shape({name:i().string}).isRequired,orderBy:i().string};const Te=Ie},47625:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(99166);const n=(e,t=250,r={onlyResolvesLast:!1})=>(0,a.Z)(e,t,r)},92084:()=>{},38299:()=>{},16166:()=>{}}]);
//# sourceMappingURL=../sourcemaps/5739.301e94fcfc81cce2d7bafdd809fe2773.js.map