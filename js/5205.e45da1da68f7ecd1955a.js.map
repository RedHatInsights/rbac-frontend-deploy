{"version":3,"sources":["webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/add-role-wizard.scss","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/review.scss","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/add-permissions-template.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/validators.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/review-template.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/add-role-success.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/base-role-table.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/DisabledRowWrapper.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/add-permissions.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/review.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/cost-resources.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/add-role-wizard.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/type-selector.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/schema.js","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/add-role-wizard.scss?73d5","webpack://insights-rbac-frontend/./src/smart-components/role/add-role-new/review.scss?a601"],"names":["exports","___CSS_LOADER_API_IMPORT___","push","module","id","AddPermissionTemplate","formFields","formOptions","useFormApi","useState","getState","values","selectedPermissions","setSelectedPermissions","unresolvedSplats","applications","filter","app","find","uuid","includes","addPermissions","className","length","ChipGroup","categoryName","reduce","acc","i","map","Chip","key","color","isTruncated","onClick","p","Title","headingLevel","size","TextContent","Text","Popover","headerContent","bodyContent","Button","variant","props","propTypes","PropTypes","asyncValidator","roleName","undefined","fetchRoles","limit","offset","name","nameMatch","error","console","response","data","debouncedAsyncValidator","asyncDebounce","ValidatorReset","useEffect","setTimeout","change","ReviewTemplate","useContext","AddRoleWizardContext","submitting","setWizardError","then","Bullseye","Spinner","context","title","text","setHideForm","EmptyState","EmptyStateVariant","EmptyStateIcon","icon","CheckCircleIcon","EmptyStateBody","component","Link","to","EmptyStateSecondaryActions","columns","transforms","sortable","selector","roleReducer","rolesForWizard","isLoading","roles","pagination","meta","DisabledRowWrapper","row","disableSelection","Tooltip","content","href","exitDelay","entryDelay","RowWrapper","permissionReducer","permission","options","application","operation","resource","expandSplats","isLoadingExpandSplats","isRecordLoading","selectedRole","resourceTypes","costReducer","permissions","resource_type","verb","baseRole","applicationOptions","resourceOptions","operationOptions","expandedPermissions","AddPermissionsTable","dispatch","useDispatch","fetchData","apiProps","listPermissions","fetchOptions","listPermissionOptions","useSelector","shallowEqual","input","useFieldApi","resources","operations","filters","setFilters","roleType","isToggled","setIsToggled","filterBy","setFilterBy","value","setValue","getResourceType","r","split","debounbcedGetApplicationOptions","useCallback","debouncePromise","field","join","resourceType","debounbcedGetResourceOptions","debounbcedGetOperationOptions","baseRoleUuid","fetchRole","getResourceDefinitions","resetExpandSplats","onChange","basePermissions","access","Set","patterns","replace","count","some","f","match","calculateSelected","curr","0","preparedFilterItems","item","label","res","op","emptyItem","isDisabled","filterItemOverflow","Object","keys","isSelectable","isCompact","borders","createRows","cells","selected","Boolean","filterValue","noData","noDataDescription","setFilterValue","checkedRows","setCheckedItems","newSelection","titlePlural","titleSingular","showMoreTitle","onFilter","onShowMore","e","placeholder","type","groups","items","slice","isFilterable","rowWrapper","tableId","stickyTable","rows","Grid","col","GridItem","span","cell","loadingResources","isLoadingResources","reducer","state","action","prevState","isOpen","selection","option","filteredOptions","filtervalue","createContext","success","FormTemplate","showFormControls","Description","Content","rest","mapperExtension","fetchRolesForWizard","itemCount","orderBy","Alert","isInline","role","Radio","aria-label","ouiaId","isChecked","batch","display_name","description","config","mappedProps","filterPlaceholder","useReducer","dispatchLocaly","path","getResource","resourceDefinitions","entries","hasGutter","md","TextVariants","sm","FormGroup","isRequired","Select","SelectVariant","typeAheadAriaLabel","onToggle","onSelect","event","selectAll","onClear","selections","target","aria-labelledby","placeholderText","hasInlineFilter","SelectOption","index","review","copyName","copyDescription","hasCostResources","resourceDefinitionsRows","Stack","StackItem","checked","setChecked","handleChange","val","AddRoleWizard","history","hideForm","wizardContextValue","setWizardContextValue","cancelWarningVisible","setCancelWarningVisible","container","useRef","document","createElement","schema","setSchema","fields","isDynamic","inModal","showTitles","crossroads","nextStep","when","stepMapper","copy","create","validate","validatorTypes","condition","is","threshold","StepTemplate","every","buttons","schemaBuilder","current","hidden","onCancel","addNotification","dismissDelay","dismissable","Provider","prev","setWizardSuccess","onModalCancel","onConfirmCancel","Wizard","onClose","steps","isFinishedStep","subscription","initialValues","componentMapper","onSubmit","formData","roleData","attributeFilter","createRole","fetchRolesWithPolicies","api","__esModule","default","update","locals","hot","invalidate","oldLocals","accept","a","b","isEqualLocals","dispose"],"mappings":"qHAEAA,EADkC,EAAQ,MAChCC,EAA4B,IAE9BC,KAAK,CAACC,EAAOC,GAAI,wiJAAyiJ,KAElkJD,EAAOH,QAAUA,G,iBCJjBA,EADkC,EAAQ,MAChCC,EAA4B,IAE9BC,KAAK,CAACC,EAAOC,GAAI,q/BAAs/B,KAE/gCD,EAAOH,QAAUA,G,q/BCCjB,IAAMK,EAAwB,SAAC,GAAmB,UAAjBC,EAAiB,EAAjBA,WACzBC,GAAcC,SAD4B,GAEMC,cAASF,EAAYG,WAAWC,OAAO,0BAA4B,IAFzE,WAEzCC,EAFyC,KAEpBC,EAFoB,KAI1CC,GACJ,UAAAP,EAAYG,WAAWC,cAAvB,mBAAgC,yBAAhC,mBAAmDI,oBAAnD,eAAiEC,QAAO,SAACC,GAAD,QAAUL,aAAD,EAACA,EAAqBM,MAAK,qBAAGC,KAAgBC,SAASH,YACxI,GACII,EAAiBf,EAAW,GAAG,GACrC,OACE,yBAAKgB,UAAU,QACZV,EAAoBW,OAAS,EAC5B,yBAAKD,UAAU,4BACb,kBAACE,EAAA,EAAD,CAAWC,aAAa,wBAErBb,EACEc,QAAO,SAACC,EAAKC,GAAN,OAAaA,GAAb,WAAmBD,MAAM,IAChCE,KAAI,gBAAGV,EAAH,EAAGA,KAAH,OACH,kBAACW,EAAA,EAAD,CAAMC,IAAKZ,EAAMa,MAAM,OAAOC,aAAW,EAACC,QAAS,kBAAMrB,EAAuBD,EAAoBI,QAAO,SAACmB,GAAD,OAAOA,EAAEhB,OAASA,QAC1HA,QAKT,KACJ,kBAACiB,EAAA,EAAD,CAAOC,aAAa,KAAKC,KAAK,KAAKhB,UAAU,mCAA7C,mBAGA,kBAACiB,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,8CAE+B,IAA5B1B,EAAiBS,QAChB,kBAACkB,EAAA,EAAD,CACEC,cAAc,iDACdC,YAAY,0HAEZ,kBAACC,EAAA,GAAD,CAAQC,QAAQ,QAAhB,8CAC6C,kBAAC,KAAD,UAMpD,CACC,CAAC,EAAD,KAEOxB,GAFP,IAGIyB,MAAO,EAAF,KACAzB,EAAeyB,OADf,IAEHlC,sBACAC,iCASdR,EAAsB0C,UAAY,CAChCzC,WAAY0C,WAGd,U,uFChEaC,EAAc,+BAAG,WAAOC,GAAP,4EACvBA,EADuB,8CAEnBC,GAFmB,wBAKLC,QAAW,CAAEC,MAAO,GAAIC,OAAQ,EAAGC,KAAML,EAAUM,UAAW,UAA9D,OAA+E,SAACC,GACrGC,QAAQD,MAAMA,MANY,aAUxBE,OALEA,EALsB,SAUxB,UAAAA,EAAUC,YAAV,eAAgBrC,QAAS,GAVD,qBAWpB,8BAXoB,qCAcrB4B,GAdqB,2CAAH,sDAiBdU,GAA0BC,OAAcb,GAExCc,EAAiB,SAAC,GAAa,IAAXR,EAAW,EAAXA,KACzBhD,GAAcC,SAQpB,OANAwD,gBAAU,WAGR,OAFAC,YAAW,kBAAM1D,EAAY2D,OAAOX,EAAM,QAEnC,kBAAMhD,EAAY2D,OAAOX,EAAM,OACrC,IAEI,M,ulBCxBT,IAAMY,EAAiB,SAAC,GAAmB,MAAjB7D,EAAiB,EAAjBA,WAAiB,GACK8D,gBAAWC,IAAjDC,EADiC,EACjCA,WAAYb,EADqB,EACrBA,MAAOc,EADc,EACdA,eACnB7D,GAAaF,SAAbE,SAQR,OAPAsD,gBAAU,WACRO,OAAepB,GACfF,EAAevC,IAAWC,OAAO,cAC9B6D,MAAK,kBAAMD,GAAe,MAD7B,OAES,kBAAMA,GAAe,QAC7B,SAEkB,IAAVd,GAAyBa,EAEhC,kBAACG,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,CAASpC,KAAK,SAKN,IAAVmB,EAEA,kBAAC,IAAD,CACEkB,QAASN,GACTO,MAAM,0BACNC,KAAK,6FAMT,yBAAKvD,UAAU,QACb,kBAACc,EAAA,EAAD,CAAOC,aAAa,KAAKC,KAAK,KAAKhB,UAAU,yBAA7C,kBAGA,kBAACiB,EAAA,EAAD,CAAajB,UAAU,yBACrB,kBAACkB,EAAA,EAAD,gFAED,CAAC,CAAC,KAAKlC,SAAN,UAAMA,EAAa,UAAnB,aAAM,EAAkB,QAKhC6D,EAAepB,UAAY,CACzBzC,WAAY0C,WAGd,U,6GCnBA,SA7BuB,WAAM,IACnB8B,GAAgBV,gBAAWC,IAA3BS,YACR,OACE,kBAACC,GAAA,EAAD,CAAYlC,QAASmC,YACnB,kBAACC,GAAA,EAAD,CAAgBjD,MAAM,QAAQkD,KAAMC,QACpC,kBAAC/C,EAAA,EAAD,CAAOC,aAAa,KAAKC,KAAK,MAA9B,4CAGA,kBAAC8C,GAAA,EAAD,MACA,kBAACxC,EAAA,GAAD,CAAQyC,UAAW,SAACvC,GAAD,OAAW,kBAAC,GAAAwC,KAAD,KAAMC,GAAG,UAAazC,KAAWD,QAAQ,WAAvE,QAGA,kBAAC2C,GAAA,EAAD,KACE,kBAAC5C,EAAA,GAAD,CACEV,QAAS,WACP4C,GAAY,IAEdjC,QAAQ,QAJV,uBAQA,kBAACD,EAAA,GAAD,CAAQyC,UAAW,SAACvC,GAAD,OAAW,kBAAC,GAAAwC,KAAD,KAAMC,GAAG,WAAczC,KAAWD,QAAQ,QAAxE,wB,0ECjBF4C,GAAU,CAAC,GAAI,CAAEb,MAAO,OAAQ7C,IAAK,eAAgB2D,WAAY,CAACC,cAAa,eAC/EC,GAAW,SAAC,GAAD,QAAGC,YAAeC,EAAlB,EAAkBA,eAAgBC,EAAlC,EAAkCA,UAAlC,MAAqD,CACpEC,MAAOF,EAAelC,KACtBqC,WAAYH,EAAeI,KAC3BH,c,oDCTWI,GAAqB,SAAC,GAAD,IAAGC,EAAH,EAAGA,IAAQtD,EAAX,sBAChCsD,EAAIC,iBACF,kBAACC,GAAA,EAAD,CACEC,QACE,qJACwH,IACtH,uBAAGC,KAAK,sBAAR,0CAGJC,UAAW,KACXC,WAAY,MAEZ,kBAAC,GAAAC,WAAD,KAAYrF,UAAU,0BAA0B8E,IAAKA,GAAStD,KAGhE,kBAAC,GAAA6D,WAAD,KAAYP,IAAKA,GAAStD,K,qkBAG9BqD,GAAmBpD,UAAY,CAC7BD,MAAOE,WACPoD,IAAKpD,YCbP,IAAMyC,GAAU,CAAC,cAAe,gBAAiB,aAC3CG,GAAW,SAAC,GAAD,QACfgB,kBACEC,EAFa,EAEbA,WACAd,EAHa,EAGbA,UAHa,IAIbe,QAAWC,EAJE,EAIFA,YAAaC,EAJX,EAIWA,UAAWC,EAJtB,EAIsBA,SACnCC,EALa,EAKbA,aACAC,EANa,EAMbA,sBANa,IAQftB,YAAeuB,EARA,EAQAA,gBAAiBC,EARjB,EAQiBA,aACjBC,EATA,EASfC,YAAeD,cATA,MAUV,CACLE,YAAaX,EAAWjD,KAAK/B,KAAI,wEAA8D,GAA3DkF,EAAH,EAAGA,YAA4BE,EAA/B,EAAgBQ,cAAyBC,EAAzC,EAAyCA,KAAMb,EAA/C,EAA+CA,WAA/C,MAAsE,CACrGE,cACAE,WACAD,UAAWU,EACXvG,KAAM0F,MAERZ,WAAYY,EAAWX,KACvBH,UAAWA,GAAaqB,EACxBO,SAAUN,EACVO,mBAAoBb,EAAYnD,KAAK5C,QAAO,SAACC,GAAD,MAAiB,MAARA,KACrD4G,gBAAiBZ,EAASrD,KAAK5C,QAAO,SAACC,GAAD,MAAiB,MAARA,KAC/C6G,iBAAkBd,EAAUpD,KAAK5C,QAAO,SAACC,GAAD,MAAiB,MAARA,KACjD8G,oBAAqBb,EAAatD,KAAK/B,KAAI,qBAAGgF,cAC9CM,wBACAG,cAAeA,EAAc1D,OAGzBoE,GAAsB,SAAC,GAA8D,IAA5DpH,EAA4D,EAA5DA,oBAAqBC,EAAuC,EAAvCA,uBAA2BiC,EAAY,wDACnFmF,GAAWC,mBACXC,EAAY,SAACC,GAAD,OAAcH,GAASI,SAAgBD,KACnDE,EAAe,SAACF,GAAD,OAAcH,GAASM,SAAsBH,KAHuB,GAerFI,iBAAY5C,GAAU6C,gBAVxBjB,EALuF,EAKvFA,YACAzB,EANuF,EAMvFA,UACAE,EAPuF,EAOvFA,WACA0B,EARuF,EAQvFA,SACAC,EATuF,EASvFA,mBACAC,EAVuF,EAUvFA,gBACAC,EAXuF,EAWvFA,iBACAC,EAZuF,EAYvFA,oBACAZ,EAbuF,EAavFA,sBACAG,EAduF,EAcvFA,cAEMoB,GAAUC,QAAY7F,GAAtB4F,MACFnI,GAAcC,SAjBqE,GAmB3DC,cAAS,CAAEM,aAAc,GAAI6H,UAAW,GAAIC,WAAY,KAnBG,WAmBlFC,EAnBkF,KAmBzEC,EAnByE,KAoBnFC,EAAWzI,EAAYG,WAAWC,OAAO,aApB0C,GAqBvDF,eAAS,GArB8C,WAqBlFwI,EArBkF,KAqBvEC,EArBuE,QAsBzDzI,cAAS,IAtBgD,WAsBlF0I,EAtBkF,KAsBxEC,EAtBwE,QAuB/D3I,gBAvB+D,WAuBlF4I,EAvBkF,KAuB3EC,EAvB2E,KA0BnFC,EAAkB,SAAC1C,GAAD,OAAgBS,EAAcpG,MAAK,SAACsI,GAAD,aAAOA,EAAEH,SAAF,UAAYxC,EAAW4C,MAAM,YAA7B,aAAY,EAAwB,QAehGC,GAAkCC,kBACtCC,SACE,gBAAG7I,EAAH,EAAGA,aAAc6H,EAAjB,EAAiBA,UAAWC,EAA5B,EAA4BA,WAA5B,OACEP,EAAa,CACXuB,MAAO,cACPxG,MAAO,GACP0D,YAAahG,EAAa+I,OAC1BC,aAAcnB,EAAUkB,OACxBpC,KAAMmB,EAAWiB,WAErB,KAEF,IAEIE,GAA+BL,kBACnCC,SACE,gBAAG7I,EAAH,EAAGA,aAAc6H,EAAjB,EAAiBA,UAAWC,EAA5B,EAA4BA,WAA5B,OACEP,EAAa,CACXuB,MAAO,gBACPxG,MAAO,GACP0D,YAAahG,EAAa+I,OAC1BC,aAAcnB,EAAUkB,OACxBpC,KAAMmB,EAAWiB,WAErB,KAEF,IAEIG,GAAgCN,kBACpCC,SACE,gBAAG7I,EAAH,EAAGA,aAAc6H,EAAjB,EAAiBA,UAAWC,EAA5B,EAA4BA,WAA5B,OACEP,EAAa,CAAEuB,MAAO,OAAQxG,MAAO,GAAI0D,YAAahG,EAAa+I,OAAQC,aAAcnB,EAAUkB,OAAQpC,KAAMmB,EAAWiB,WAC9H,KAEF,KAGF9F,gBAAU,WAAM,MACRkG,EAAY,UAAG3J,EAAYG,WAAWC,OAAO,yBAAjC,aAAG,EAAiDQ,KAYtE,MAXiB,SAAb6H,GAAuBkB,GACzBjC,GAASkC,SAAUD,IAGrBjC,GAASmC,WACT7J,EAAY2D,OAAO,sBAAsB,GACzCiE,EAAUlC,GACVqC,EAAa,CAAEuB,MAAO,cAAexG,MAAO,KAC5CiF,EAAa,CAAEuB,MAAO,gBAAiBxG,MAAO,KAC9CiF,EAAa,CAAEuB,MAAO,OAAQxG,MAAO,KAE9B,kBAAM4E,GAASoC,eACrB,KAEHrG,gBAAU,WACRgG,EAA6BlB,GAC7BmB,EAA8BnB,KAC7B,CAACA,EAAQ/H,gBAEZiD,gBAAU,WACR0F,EAAgCZ,GAChCmB,EAA8BnB,KAC7B,CAACA,EAAQF,aAEZ5E,gBAAU,WACR0F,EAAgCZ,GAChCkB,EAA6BlB,KAC5B,CAACA,EAAQD,cAEZ7E,gBAAU,WACR0E,EAAM4B,SAAS1J,KACd,CAACA,KAEJoD,gBAAU,WAAM,MACd,MACG2D,GACY,SAAbqB,GACAzI,EAAYG,WAAWC,OAAO,4BAC9BC,EAAoBW,OAAS,IAC7B,UAAAhB,EAAYG,WAAWC,OAAO,yBAA9B,eAAiDQ,SAASwG,aAA1D,EAA0DA,EAAUxG,OACpEgG,GACApB,GAPF,CAYA,IAAMwE,GAAkB5C,aAAA,EAAAA,EAAU6C,SAAU,GAC5C,GAAmC,IAA/BzC,EAAoBxG,aAAiD,IAA1B4F,EAAuC,CACpF,IAAMpG,EAAe,IAAI,IAAI0J,IAAIF,EAAgB1I,KAAI,qBAAGgF,WAA4B4C,MAAM,KAAK,QAC/FxB,GAASf,SAAa,CAAEH,YAAahG,EAAa+I,cAC7C,CACL,IAAMY,EAAWH,EAAgB1I,KAAI,qBAAGgF,WAA4B8D,QAAQ,IAAK,SACjF9J,GAAuB,kBACrBkH,EACG/G,QAAO,SAACmB,GAAD,MAA2B,oBAApBA,EAAEsH,MAAM,KAAK,IAA2E,KAA9CF,EAAgBpH,IAAM,CAAEyI,MAAO,IAAKA,SAC5F5J,QAAO,SAACmB,GAAD,OAAOuI,EAASG,MAAK,SAACC,GAAD,OAAO3I,EAAE4I,MAAMD,SAC3CjJ,KAAI,SAACgF,GAAD,MAAiB,CAAE1F,KAAM0F,SAElCtG,EAAY2D,OAAO,2BAA2B,OAE/C,CAACsD,EAAaG,IAEjB,IAIMqD,EAAoB,SAAChK,GAAD,OACxBA,EAAOU,QACL,SAACC,EAAKsJ,GAAN,MAAgB,CACdC,EAAA,SACKvJ,aADL,EACKA,EAAM,IADX,UAEGsJ,GAAO,OAGZ,CAAEC,EAAG,MAGHC,EAAsB,CAC1BpK,aAAc,IAAI6G,GAAoB5G,QAAO,SAACoK,GAAD,OAAUA,EAAKhK,SAAS+H,MAAWtH,KAAI,SAACZ,GAAD,MAAU,CAAEoK,MAAOpK,EAAKoI,MAAOpI,MACnH2H,UAAW,IAAIf,GAAiB7G,QAAO,SAACoK,GAAD,OAAUA,EAAKhK,SAAS+H,MAAWtH,KAAI,SAACyJ,GAAD,MAAU,CAAED,MAAOC,EAAKjC,MAAOiC,MAC7GzC,WAAY,IAAIf,GAAkB9G,QAAO,SAACoK,GAAD,OAAUA,EAAKhK,SAAS+H,MAAWtH,KAAI,SAAC0J,GAAD,MAAS,CAAEF,MAAOE,EAAIlC,MAAOkC,OAGzGC,EAAY,CAChBH,MAAO,kDACPI,YAAY,GAGRC,EAAqBP,EAAoBQ,OAAOC,KAAKT,GAAqB9B,GAAgB,IAAI9H,OAhJ7E,GAiJvB,OACE,yBAAKD,UAAU,gCACb,kBAAC,KAAD,KACEmE,QAASA,GACToG,cAAc,EACdC,WAAW,EACXC,SAAS,EACTC,WArJa,SAACxE,GAAD,OACjBA,EAAY3F,KAAI,gBAAGkF,EAAH,EAAGA,YAAaE,EAAhB,EAAgBA,SAAUD,EAA1B,EAA0BA,UAAW7F,EAArC,EAAqCA,KAArC,MAAiD,CAC/DA,KAAM,GAAF,OAAK4F,EAAL,YAAoBE,EAApB,YAAgCD,GACpCiF,MAAO,CACL,CACErH,MAAOmC,GAETE,EACAD,GAEFkF,SAAUC,QAAQvL,GAAuBA,EAAoBM,MAAK,SAACkF,GAAD,OAASA,EAAIjF,OAASA,MACxFkF,iBAAkC,oBAAhBU,GAAuF,KAAjDwC,EAAgBpI,IAAS,CAAEyJ,MAAO,IAAKA,WA2I7FhH,KAAM4D,EACN4E,YAAa,GACbC,OAAgC,KAAxB7E,aAAA,EAAAA,EAAajG,QACrB+K,kBAAmB,CACjB,gNAIFnE,UAAW,YAA4D,IAAzD9E,EAAyD,EAAzDA,MAAOC,EAAkD,EAAlDA,OAAQvC,EAA0C,EAA1CA,aAAc6H,EAA4B,EAA5BA,UAAWC,EAAiB,EAAjBA,WACpDV,EAAU,CACR9E,QACAC,SACAyD,aAAchG,GAAgB+H,EAAQ/H,cAAc+I,OACpDC,cAAenB,GAAaE,EAAQF,WAAWkB,OAC/CpC,MAAOmB,GAAcC,EAAQD,YAAYiB,UAG7CyC,eAAgB,YAA6C,IAA1CxL,EAA0C,EAA1CA,aAAc6H,EAA4B,EAA5BA,UAAWC,EAAiB,EAAjBA,WAC1CE,EAAW,eACND,GACC/H,EAAe,CAAEA,gBAAiB+H,EAAQ/H,cAC1C6H,EAAY,CAAEA,aAAcE,EAAQF,WACpCC,EAAa,CAAEA,cAAeC,EAAQD,cAG9C9C,UAAWA,GAAaoB,EACxBlB,WAAU,SAAOA,GAAP,IAAmB2E,MAAO3E,EAAW2E,QAC/C4B,YAAa5L,EACb6L,gBA/DkB,SAACC,GACvB7L,EAAuB6L,EAAa9L,GAAqBiB,KAAI,kBAAe,CAAEV,KAAjB,EAAGA,WA+D5DwL,YAAY,cACZC,cAAc,aACdC,cAAe5D,EAAY,WAAa,WACxC6D,SAAU,SAAC3D,GAAD,OAAcC,EAAYD,IACpC4D,WACErB,EACI,WACExC,GAAa,kBAAOD,WAEtB9F,EAENmH,SAAU,SAAC0C,EAAG3D,GACZD,EAAY,IACZE,EAASD,IAEXA,MAAOA,EACPP,QAAS,CACP,CACE/G,IAAK,eACLsH,MAAOP,EAAQ/H,aACfkM,YAAa,wBACbC,KAAM,QACNhB,SAAUlB,EAAkBlC,EAAQ/H,cACpCoM,OAAQ,CACN,CACED,KAAM/B,EAAoBpK,aAAaQ,OAAS,EAAI,WAAa,QACjE6L,MACEjC,EAAoBpK,aAAaQ,OAAS,EACtC,IAAI4J,EAAoBpK,cAAcsM,MAAM,EAAGpE,OAAY9F,EAlNxD,IAmNH,CAACqI,MAIb,CACEzJ,IAAK,YACLsH,MAAOP,EAAQF,UACfqE,YAAa,0BACbC,KAAM,QACNhB,SAAUlB,EAAkBlC,EAAQF,WACpCuE,OAAQ,CACN,CACED,KAAM/B,EAAoBvC,UAAUrH,OAAS,EAAI,WAAa,QAC9D6L,MACEjC,EAAoBvC,UAAUrH,OAAS,EACnC,IAAI4J,EAAoBvC,WAAWyE,MAAM,EAAGpE,OAAY9F,EAlOrD,IAmOH,CAACqI,MAIb,CACEzJ,IAAK,aACLsH,MAAOP,EAAQD,WACfoE,YAAa,sBACbC,KAAM,QACNhB,SAAUlB,EAAkBlC,EAAQD,YACpCsE,OAAQ,CACN,CACED,KAAM/B,EAAoBtC,WAAWtH,OAAS,EAAI,WAAa,QAC/D6L,MACEjC,EAAoBtC,WAAWtH,OAAS,EACpC,IAAI4J,EAAoBtC,YAAYwE,MAAM,EAAGpE,OAAY9F,EAlPtD,IAmPH,CAACqI,OAKf8B,cAAc,EACdC,WAAYpH,GACZqH,QAAQ,wBACJ1K,MAMZkF,GAAoBjF,UAAY,CAC9BnC,oBAAqBoC,UACrBnC,uBAAwBmC,UAG1B,Y,oDClUMyK,GAAc,SAAChI,EAASiI,GAAV,OAClB,yBAAKpM,UAAU,sBACb,kBAACqM,GAAA,EAAD,CAAMrM,UAAU,6BACbmE,EAAQ5D,KAAI,SAAC+L,GAAD,OACX,kBAACC,GAAA,EAAD,CAAUC,KAAM,GAAKrI,EAAQlE,OAAQQ,IAAK6L,GACvCA,OAIP,kBAACD,GAAA,EAAD,CAAMrM,UAAU,4BACboM,EAAK7L,KAAI,SAACuE,GAAD,OACRA,EAAI6F,MAAMpK,KAAI,SAACkM,GAAD,OACZ,kBAACF,GAAA,EAAD,CAAUC,KAAM,GAAKrI,EAAQlE,OAAQQ,IAAKgM,GACvCA,Y,ynBCXb,IAAMnI,GAAW,SAAC,GAAD,QAAG2B,YAAeD,EAAlB,EAAkBA,cAAevB,EAAjC,EAAiCA,UAAWiI,EAA5C,EAA4CA,iBAAkBpF,EAA9D,EAA8DA,UAA9D,MAAiF,CAChGtB,cAAeA,EAAc1D,KAC7BgF,YACA7C,YACAkI,mBAAoBD,EAAmB,IAGnCE,GAAU,SAACC,EAAOC,GACtB,IAAMC,EAAYF,EAAMC,EAAOrM,KAC/B,OAAQqM,EAAOlB,MACb,IAAK,SACH,gBACKiB,GADL,UAEGC,EAAOrM,IAFV,SAGOsM,GAHP,IAIIC,QAASD,EAAUC,WAGzB,IAAK,SACH,gBACKH,GADL,UAEGC,EAAOrM,IAFV,SAGOsM,GAHP,IAIInC,SAAUmC,EAAUnC,SAAS9K,SAASgN,EAAOG,WACzCF,EAAUnC,SAASlL,QAAO,SAACoK,GAAD,OAAUA,IAASgD,EAAOG,aAD9C,cAEFF,EAAUnC,UAFR,CAEkBkC,EAAOG,gBAGzC,IAAK,YACH,gBACKJ,GADL,UAEGC,EAAOrM,IAFV,SAGOsM,GAHP,IAIInC,SAAUmC,EAAUvH,QAAQjF,KAAI,SAAC2M,GAAD,OAAYA,EAAOnF,aAGzD,IAAK,QACH,gBACK8E,GADL,UAEGC,EAAOrM,IAFV,SAGOsM,GAHP,IAIInC,SAAU,OAGhB,IAAK,aACH,gBACKiC,GADL,UAEGC,EAAOrM,IAFV,SAGOsM,GAHP,IAIIvH,QAASsH,EAAOtH,QAChB2H,gBAAiBL,EAAOtH,YAG9B,IAAK,YACH,gBACKqH,GADL,UAEGC,EAAOrM,IAFV,SAGOsM,GAHP,IAIII,gBAAiBJ,EAAUvH,QAAQ9F,QAAO,qBAAGqI,MAAkBjI,SAASgN,EAAOM,oBAGrF,QACE,OAAOP,I,qkBClDN,IAAM9J,IAAuBsK,mBAAc,CAChDC,SAAS,EACTtK,YAAY,EACZb,WAAON,IAGH0L,GAAe,SAAC/L,GAAD,OAAW,kBAAC,KAAD,OAAqBA,EAArB,CAA4BgM,kBAAkB,MAExEC,GAAc,SAAC,GAAD,IAAGC,EAAH,EAAGA,QAAYC,EAAf,0BAA0B,kBAACD,EAAYC,IAC3DF,GAAYhM,UAAY,CACtBiM,QAAShM,4BAGJ,IAAMkM,GAAkB,CAC7B,kBLhBoB,SAACpM,GACrB,IAAMmF,GAAWC,mBACXC,EAAY,SAACrB,GAAD,OAAamB,GAASkH,SAAoBrI,KAF7B,GAGOrG,cAAS,IAHhB,WAGxB2L,EAHwB,KAGXG,EAHW,QAID/D,iBAAY5C,GAAU6C,gBAA5CzC,EAJuB,EAIvBA,MAAOC,EAJgB,EAIhBA,WACPyC,GAAUC,QAAY7F,GAAtB4F,MACFnI,GAAcC,SAwCpB,OAtCAwD,gBAAU,WACRmE,EAAU,CACR9E,MAAO,GACPC,OAAQ,EACR8L,UAAW,EACXC,QAAS,mBAEV,IAgCD,6BACE,kBAACC,GAAA,EAAD,CACEzM,QAAQ,OACR0M,UAAQ,EACR3K,MAAK,4NAKP,kBAAC,KAAD,CACEa,QAASA,GACTuG,WAzCa,SAAChG,GAAD,OACjBA,EAAMnE,KAAI,SAAC2N,GAAD,MAAW,CACnBvD,MAAO,CACL,CACErH,MACE,kBAAC6K,GAAA,EAAD,CACErP,GAAE,UAAKoP,EAAKrO,KAAV,UACFoC,KAAI,UAAKiM,EAAKjM,KAAV,UACJmM,aAAA,UAAeF,EAAKjM,KAApB,UACAoM,OAAM,UAAKH,EAAKjM,KAAV,UACN8F,MAAOmG,EAAKrO,KACZyO,UAAWlH,EAAMW,MAAMlI,OAASqO,EAAKrO,KACrCmJ,SAAU,WACR/J,EAAYsP,OAAM,WAChBnH,EAAM4B,SAASkF,GACfjP,EAAY2D,OAAO,iBAAnB,kBAAgDsL,EAAKM,cAAgBN,EAAKjM,OAC1EhD,EAAY2D,OAAO,wBAAyBsL,EAAKO,aACjDxP,EAAY2D,OAAO,wBAAyB,IAC5C3D,EAAY2D,OAAO,2BAA2B,SAKtDpB,MAAO,CAAExB,UAAW,sBAEtBkO,EAAKM,cAAgBN,EAAKjM,KAC1BiM,EAAKO,kBAgBLnM,KAAMoC,EACNmC,UAAW,SAAC6H,GAAD,OAAY7H,GAAU8H,SAAYD,KAC7C5D,YAAaA,EACbG,eAAgB,gBAAGhJ,EAAH,EAAGA,KAAH,OAAcgJ,EAAehJ,IAC7CwC,WAAW,EACXE,WAAYA,EACZ0G,YAAY,QACZC,cAAc,OACdsD,kBAAkB,YAClBP,OAAO,cACP7D,WAAS,EACT0B,QAAQ,gBKrDd,wBAAyBxF,GACzB,iBDsCoB,SAAClF,GACrB,IAAMmF,GAAWC,mBADc,GAIqCM,iBAAY5C,GAAU6C,gBAAlFnB,EAJuB,EAIvBA,cAAevB,EAJQ,EAIRA,UAAWkI,EAJH,EAIGA,mBAAoBrF,EAJvB,EAIuBA,UAC9CF,GAAUC,QAAY7F,GAAtB4F,MACFnI,GAAcC,SACdgH,EAAcjH,EAAYG,WAAWC,OAAO,yBAAyBK,QAAO,qBAAGG,KAAgBsI,MAAM,KAAK,GAAGrI,SAAS,sBAP7F,GAQC+O,gBAC9BjC,GACA1G,EAAY9F,QACV,SAACC,EAAKkF,GAAN,UAAC,MACIlF,GADL,UAEGkF,EAAW1F,KAAO,CACjB+K,SAAU,GACVpF,QAAS,GACT2H,gBAAiB,GACjBH,QAAQ,OAGZ,KApB2B,WAQxBH,EARwB,KAQjBiC,EARiB,KAiG/B,OAnEApM,gBAAU,YACPzD,EAAYG,WAAWC,OAAO,yBAA2B,IAAIkB,KAAI,gBAAGgF,EAAH,EAAGA,WAAH,SAAe+B,UACrE/G,KAAI,SAACoF,GAAD,OAAcO,EAAYpG,SAASyF,IAAeuJ,EAAe,CAAElD,KAAM,SAAUqB,UAAWtH,EAAUlF,IAAK8E,UA9B/FoB,GAASmC,QAAtBhC,YAiCjB7H,EAAY2D,OAAO,sBAAsB,KACxC,KAEHF,gBAAU,WACH+B,GACmB,IACjB,IAAI0E,IAAIjD,EAAY3F,KAAI,SAACgF,GAAD,uBAAgBS,EAAcpG,MAAK,SAACsI,GAAD,aAAOA,EAAEH,SAAF,UAAYxC,EAAW1F,KAAKsI,MAAM,YAAlC,aAAY,EAA6B,cAAnF,aAAgB,EAAwE4G,UACnHrP,QAAO,SAACqP,GAAD,OAAUA,KACLxO,KAAI,SAACwO,GAAD,OAxCCjI,EAwCuBiI,EAxCVpI,GAASqI,QAAYlI,IAAnC,IAACA,OA0CpB,CAACd,KAEJtD,gBAAU,WACHiK,GACHzG,EAAY3F,KAAI,SAACM,GAAD,OAAOiO,EAAe,CAAElD,KAAM,aAAcnL,IAAKI,EAAEhB,KAAM2F,QAAS8B,GArBxD/B,EAqBuF1E,EAAEhB,KArB1F,UAAgBmG,EAAcpG,MAAK,SAACsI,GAAD,aAAOA,EAAEH,SAAF,UAAYxC,EAAW4C,MAAM,YAA7B,aAAY,EAAwB,cAA9E,iBAAgB,EAAmE4G,KAAK5G,MAAM,YAA9F,aAAgB,EAAqF,MAqBD,KArBpG,IAAC5C,EAAD,SAuB1B,CAACoH,KAEJjK,gBAAU,WACR,IAAMuM,EAAsB5E,OAAO6E,QAAQrC,GAAOtM,KAAI,iCAA8B,CAAEgF,WAAhC,KAA4C+B,UAA5C,KAAiEsD,aACvHxD,EAAM4B,SAASiG,GACfhQ,EAAY2D,OAAO,uBAAwBqM,KAC1C,CAACpC,IAyCF,kBAACR,GAAA,EAAD,CAAM8C,WAAS,GACb,kBAAC5C,GAAA,EAAD,CAAU6C,GAAI,EAAGpP,UAAU,oBACzB,kBAACkB,EAAA,EAAD,CAAM6C,UAAWsL,OAAiBrP,UAAU,yBAA5C,gCAIF,kBAACuM,GAAA,EAAD,CAAU6C,GAAI,EAAGpP,UAAU,oBACzB,kBAACkB,EAAA,EAAD,CAAM6C,UAAWsL,OAAiBrP,UAAU,yBAA5C,yBAIDkG,EAAY3F,KAjDD,SAAC,GAAyB,IAAjBgF,EAAiB,EAAvB1F,KACX2F,EAAUqH,EAAMtH,GAAY4H,gBAClC,OACE,kBAAC,aAAD,KACE,kBAACZ,GAAA,EAAD,CAAU6C,GAAI,EAAGE,GAAI,IACnB,kBAACC,GAAA,EAAD,CAAWxF,MAAOxE,EAAYiK,YAAU,KAE1C,kBAACjD,GAAA,EAAD,CAAU6C,GAAI,EAAGE,GAAI,IACnB,kBAACG,GAAA,EAAD,CACEzP,UAAU,kCACVuB,QAASmO,eACTC,mBAAmB,iBACnBC,SAAU,SAAC5C,GACT8B,EAAe,CAAElD,KAAM,YAAanL,IAAK8E,EAAY6H,YAAa,KAlD7D,SAAC3M,EAAKuM,GAAW8B,EAAe,CAAElD,KAAM,SAAUnL,MAAKuM,WAmD5D4C,CAASrK,EAAYyH,IAEvB6C,SAAU,SAACC,EAAO7C,IAnDX,SAAC6C,EAAO7C,EAAW8C,EAAWtP,GACjCqO,EAAZiB,EAA2B,CAAEnE,KAAM,YAAaqB,YAAWxM,OAAwB,CAAEmL,KAAM,SAAUqB,YAAWxM,QAmDtGoP,CAASC,EAAO7C,EAAWA,IAAc,eAAL,OAAoBzH,EAAQvF,OAA5B,KAAuCsF,IAE7EyK,QAAS,kBAvDalB,EAAe,CAAElD,KAAM,QAASnL,IAuDxB8E,KAC9B0K,WAAYpD,EAAMtH,GAAYqF,SAC9BoC,OAAQH,EAAMtH,GAAYyH,OAC1BxB,SAAU,SAACE,GAAD,OAAOA,GAAKoD,EAAe,CAAElD,KAAM,YAAanL,IAAK8E,EAAY6H,YAAa1B,EAAEwE,OAAOnI,SACjGoI,kBAAiB5K,EACjB6K,gBAAgB,mBAChBC,iBAAe,GAjBjB,CAoBI,kBAACC,GAAA,EAAD,CAAc7P,IAAK,EAAGsH,MAAK,sBAAiBvC,EAAQvF,OAAzB,QApB/B,WAqBOuF,EAAQjF,KAAI,SAAC2M,EAAQqD,GAAT,OAAmB,kBAACD,GAAA,EAAD,CAAc7P,IAAK8P,EAAQ,EAAGxI,MAAOmF,EAAOnF,qBC9H1FyI,OFViB,WACjB,IADuB,GACHtR,SAUJE,WAAWC,OARZ4C,EAHQ,EAGrB,aACoBwM,EAJC,EAIrB,oBACkBgC,EALG,EAKrB,kBACyBC,EANJ,EAMrB,yBACyBxK,EAPJ,EAOrB,yBACwB+I,EARH,EAQrB,wBACsB0B,EATD,EASrB,sBACa/E,EAVQ,EAUrB,aAGIQ,EAAOlG,EAAY3F,KAAI,SAACgF,GAAD,MAAiB,CAC5CoF,MAAOpF,EAAW1F,KAAKsI,MAAM,SAGzByI,GAA2B3B,GAAuB,IAAI1O,KAAI,kBAAgC,CAC9FoK,MAAO,CADuD,EAAGpF,WAAH,EAAe+B,UAC/CkB,KAAK,WAGrC,OACE,kBAAC,aAAD,KACE,kBAACqI,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAW9Q,UAAU,uBACnB,kBAACqM,GAAA,EAAD,KACE,kBAACE,GAAA,EAAD,CAAU+C,GAAI,GAAIF,GAAI,GACpB,kBAAClO,EAAA,EAAD,CAAM6C,UAAWsL,OAAiBrP,UAAU,yBAA5C,SAIF,kBAACuM,GAAA,EAAD,CAAU+C,GAAI,GAAIF,GAAI,IACpB,kBAAClO,EAAA,EAAD,CAAM6C,UAAWsL,OAA0B,WAATzD,EAAoB3J,EAAOwO,KAGjE,kBAACpE,GAAA,EAAD,KACE,kBAACE,GAAA,EAAD,CAAU+C,GAAI,GAAIF,GAAI,GACpB,kBAAClO,EAAA,EAAD,CAAM6C,UAAWsL,OAAiBrP,UAAU,yBAA5C,gBAIF,kBAACuM,GAAA,EAAD,CAAU+C,GAAI,GAAIF,GAAI,IACpB,kBAAClO,EAAA,EAAD,CAAM6C,UAAWsL,OAA0B,WAATzD,EAAoB6C,EAAciC,KAGxE,kBAACrE,GAAA,EAAD,KACE,kBAACE,GAAA,EAAD,CAAU+C,GAAI,GAAIF,GAAI,GACpB,kBAAClO,EAAA,EAAD,CAAM6C,UAAWsL,OAAiBrP,UAAU,yBAA5C,gBAIF,kBAACuM,GAAA,EAAD,CAAU+C,GAAI,GAAIF,GAAI,IACnBjD,GAxCG,CAAC,cAAe,gBAAiB,aAwCfC,KAGzBuE,GACC,kBAACtE,GAAA,EAAD,KACE,kBAACE,GAAA,EAAD,CAAU+C,GAAI,GAAIF,GAAI,GACpB,kBAAClO,EAAA,EAAD,CAAM6C,UAAWsL,OAAiBrP,UAAU,yBAA5C,yBAIF,kBAACuM,GAAA,EAAD,CAAU+C,GAAI,GAAIF,GAAI,IACnBjD,GAAY,CAAC,aAAc,wBAAyByE,SEpDnEnC,YAAahB,GACb,gBCjCmB,SAACjM,GAAU,IACtB4F,GAAUC,QAAY7F,GAAtB4F,MACFnI,GAAcC,SAFU,GAGAC,cAASF,EAAYG,WAAWC,OAAO,cAHvC,WAGvB0R,EAHuB,KAGdC,EAHc,KAIxBC,EAAe,SAACC,GACpBF,EAAWE,GACX9J,EAAM4B,SAASkI,GACfjS,EAAY2D,OAAO,wBAAyB,IAC5C3D,EAAY2D,OAAO,2BAA2B,IAGhD,OACE,6BACE,kBAACuL,GAAA,EAAD,CACEG,UAAuB,WAAZyC,EACX/Q,UAAU,aACViC,KAAK,mBACL+G,SAAU,kBAAMiI,EAAa,WAC7BlH,MAAM,6BACNjL,GAAG,mBACHiJ,MAAM,WAER,kBAACoG,GAAA,EAAD,CACEG,UAAuB,SAAZyC,EACX9O,KAAK,iBACL+G,SAAU,kBAAMiI,EAAa,SAC7BlH,MAAM,wBACNjL,GAAG,iBACHiJ,MAAM,YDQRoJ,GAAgB,SAAC,GAA0B,IAAbvS,EAAa,EAAxBwS,QAAWxS,KAC5B+H,GAAWC,mBAD8B,GAEKzH,cAAS,CAC3DmO,SAAS,EACTtK,YAAY,EACZb,WAAON,EACPwP,UAAU,IANmC,WAExCC,EAFwC,KAEpBC,EAFoB,QAQSpS,eAAS,GARlB,WAQxCqS,EARwC,KAQlBC,EARkB,KASzCC,GAAYC,YAAOC,SAASC,cAAc,QATD,GAUnB1S,cAAS,IAVU,WAUxC2S,EAVwC,KAUhCC,EAVgC,MAY/CrP,gBAAU,WACRqP,EE9CJ,SAAgBL,GAAD,MAAgB,CAC7BM,OAAQ,CACN,CACEjO,UAAW,SACX9B,KAAM,SACNgQ,WAAW,EACXC,SAAS,EACTC,YAAY,EACZC,WAAY,CAAC,aACb9O,MAAO,cACPoO,YACAM,OAAQ,CACN,CACE1O,MAAO,cACPrB,KAAM,SACNoQ,SAAU,CACRC,KAAM,YACNC,WAAY,CACVC,KAAM,uBACNC,OAAQ,oBAGZT,OAAQ,CACN,CACEjO,UAAW,gBACX9B,KAAM,YACNuN,YAAY,EACZkD,SAAU,CACR,CACE9G,KAAM+G,gBAIZ,CACE5O,UAAW,aACX9B,KAAM,YACN2J,KAAM,OACN7B,MAAO,YACPyF,YAAY,EACZoD,UAAW,CACTN,KAAM,YACNO,GAAI,UAENH,SAAU,CACRnQ,EACA,CACEqJ,KAAM+G,cAER,CACE/G,KAAM+G,eACNG,UAAW,OAIjB,CACE/O,UAAW,aACX9B,KAAM,mBACN2J,KAAM,OACN7B,MAAO,mBACP6I,UAAW,CACTN,KAAM,YACNO,GAAI,UAENH,SAAU,CACR,CACE9G,KAAM,aACNkH,UAAW,OAIjB,CACE/O,UAAW,kBACX9B,KAAM,iBACN8H,MAAO,YACPyF,YAAY,EACZoD,UAAW,CACTN,KAAM,YACNO,GAAI,QAENH,SAAU,CACR,CACE9G,KAAM+G,gBAIZ,CACEC,UAAW,CACTN,KAAM,YACNO,GAAI,UAEN9O,UAAW,cACX9B,KAAM,qBACNyL,QAASjL,GAEX,CACEmQ,UAAW,CACTN,KAAM,YACNO,GAAI,QAEN9O,UAAW,cACX9B,KAAM,sBACNyL,QAASjL,KAIf,CACEa,MAAO,uBACPrB,KAAM,uBACNoQ,SAAU,kBACVL,OAAQ,CACN,CACEjO,UAAW,aACX9B,KAAM,iBACN2J,KAAM,OACN7B,MAAO,YACPyF,YAAY,EACZkD,SAAU,CACRnQ,EACA,CACEqJ,KAAM+G,cAER,CACE/G,KAAM,aACNkH,UAAW,OAIjB,CACE/O,UAAW,aACX9B,KAAM,wBACN2J,KAAM,OACN7B,MAAO,mBACP2I,SAAU,CACR,CACE9G,KAAM,aACNkH,UAAW,SAMrB,CACE7Q,KAAM,kBACNqB,MAAO,kBACPyP,aAAchU,EACdsT,SAAU,gBAAGhT,EAAH,EAAGA,OAAH,OACRA,GACAA,EAAO,0BACPA,EAAO,yBAAyBkK,MAAK,qBAAG1J,KAAgBsI,MAAM,KAAK,GAAGrI,SAAS,sBAC3E,4BACA,UACNkS,OAAQ,CACN,CACEjO,UAAW,wBACX9B,KAAM,2BAIZ,CACEA,KAAM,4BACNqB,MAAO,mCACP+O,SAAU,SACVL,OAAQ,CACN,CACEjO,UAAW,aACX9B,KAAM,mBACN8H,MAAO,mJAET,CACEhG,UAAW,iBACX9B,KAAM,iBACNyQ,SAAU,CACR,yEAAS,IACDM,OAAM,SAACnS,GAAD,OAAOA,EAAEyG,UAAUrH,OAAS,UAAK4B,EAAY,oEAKnE,CACEI,KAAM,SACNqB,MAAO,iBAEP2P,QAAS,SAACzR,GAAD,OAAW,kBAAC,IAAD,OAAuBA,EAAvB,CAA8B6B,QAASN,OAC3DgQ,aAAclQ,EACdmP,OAAQ,CACN,CACEjO,UAAW,SACX9B,KAAM,gBF7INiR,CAAcxB,EAAUyB,YACjC,KAEHzQ,gBAAU,WACRgP,EAAUyB,QAAQC,OAAS5B,IAC1B,CAACA,IAEJ,IAAM6B,EAAW,WACV/B,EAAmBhE,SACtB3G,GACE2M,QAAgB,CACd/R,QAAS,UACT+B,MAAO,yCACPiQ,aAAc,IACdC,aAAa,KAKnB5U,EAAK,WA2CP,OACE,kBAACmE,GAAqB0Q,SAAtB,CAA+B1L,MAAK,SAAOuJ,GAAP,IAA2BrO,eAzC1C,SAACd,GAAD,OAAWoP,GAAsB,SAACmC,GAAD,UAAC,MAAeA,GAAhB,IAAsBvR,cAyCGwR,iBAxCxD,SAACrG,GAAD,OAAaiE,GAAsB,SAACmC,GAAD,UAAC,MAAeA,GAAhB,IAAsBpG,gBAwCiB9J,YAvC/E,SAAC6N,GAAD,OAAcE,GAAsB,SAACmC,GAAD,UAAC,MAAeA,GAAhB,IAAsBrC,oBAwC1E,kBAAC,KAAD,CAAczF,KAAK,OAAOoB,OAAQwE,EAAsBoC,cAAe,kBAAMnC,GAAwB,IAAQoC,gBAAiBR,IAC7H/B,EAAmBD,SAClB,kBAACyC,EAAA,EAAD,CACExQ,MAAM,cACN0J,QAAM,EACN+G,QAAS,kBAAMnV,EAAK,WACpBoV,MAAO,CACL,CACE/R,KAAM,UACN8B,UAAW,kBAAC,GAAD,MACXkQ,gBAAgB,MAKtB,kBAAC,IAAD,CACEnC,OAAQA,EACRJ,UAAWA,EACXwC,aAAc,CAAE7U,QAAQ,GACxBkO,aAAcA,GACd4G,cAAe,CACb,YAAa,UAEfC,gBAAe,SAAOA,MAAoBxG,IAC1CyG,SA9DS,SAACC,GAAa,IAEdrS,EAOXqS,EAPF,aACoB7F,EAMlB6F,EANF,oBACkB7D,EAKhB6D,EALF,kBACyB5D,EAIvB4D,EAJF,yBACyBpO,EAGvBoO,EAHF,yBACkBrF,EAEhBqF,EAFF,kBACa1I,EACX0I,EADF,aAEF/C,GAAsB,SAACmC,GAAD,UAAC,MAAeA,GAAhB,IAAsB1Q,YAAY,OACxD,IAAMuR,EAAW,CACf9U,aAAc,IAAI,IAAI0J,IAAIjD,EAAY3F,KAAI,qBAAGV,KAAkCsI,MAAM,KAAK,QAC1FsG,aAAuB,WAAT7C,EAAoB6C,EAAciC,IAAoB,KACpEzO,KAAe,WAAT2J,EAAoB3J,EAAOwO,EACjCvH,OAAQhD,EAAY3F,KAAI,gBAASgF,EAAT,EAAG1F,KAAH,MAA2B,CACjD0F,aACA0J,qBAAqBA,aAAA,EAAAA,EAAqBrP,MAAK,SAACsI,GAAD,OAAOA,EAAE3C,aAAeA,MACnE,CACE,CACEiP,gBAAiB,CACf/T,IAAK,mBAAF,OAAqB8E,EAAW4C,MAAM,KAAK,IAC9CzC,UAAW,KACXqC,MAAOkH,aAAF,EAAEA,EAAqBrP,MAAK,SAACsI,GAAD,OAAOA,EAAE3C,aAAeA,KAAY+B,aAI3E,QAGR,OAAOX,GAAS8N,SAAWF,IAAWrR,MAAK,WACzCqO,GAAsB,SAACmC,GAAD,UAAC,MAAeA,GAAhB,IAAsB1Q,YAAY,EAAOsK,SAAS,EAAM+D,UAAU,OACxF1K,GAAS+N,gBA+BLrB,SAAU,SAAChU,GACWwL,QAASxL,GAAUA,EAAO,cAAiBA,EAAO,qBAAuBA,EAAO,mBAElGoS,GAAwB,GAExB4B,SASdlC,GAAc1P,UAAY,CACxB2P,QAAS1P,UAAgB,CACvB9C,KAAM8C,sBACL8N,YAGL,a,gBGnKA,IAAImF,EAAM,EAAQ,OACF1P,EAAU,EAAQ,OAIC,iBAFvBA,EAAUA,EAAQ2P,WAAa3P,EAAQ4P,QAAU5P,KAG/CA,EAAU,CAAC,CAACpG,EAAOC,GAAImG,EAAS,MAG9C,IAKI6P,EAASH,EAAI1P,EALH,CAEd,OAAiB,OACjB,WAAoB,IAMlB,IAAKA,EAAQ8P,QAAUlW,EAAOmW,IAAIC,WAAY,CAC5C,IAqBIC,EAAYjQ,EAAQ8P,OAExBlW,EAAOmW,IAAIG,OACT,OACA,WAK+B,iBAFvBlQ,GAFNA,EAAU,EAAQ,QAEM2P,WAAa3P,EAAQ4P,QAAU5P,KAG/CA,EAAU,CAAC,CAACpG,EAAOC,GAAImG,EAAS,MA/BxB,SAAuBmQ,EAAGC,GAChD,IAAKD,GAAKC,GAAKD,IAAMC,EACnB,OAAO,EAGT,IAAIxU,EAEJ,IAAKA,KAAKuU,EACR,GAAIA,EAAEvU,KAAOwU,EAAExU,GACb,OAAO,EAIX,IAAKA,KAAKwU,EACR,IAAKD,EAAEvU,GACL,OAAO,EAIX,OAAO,EAeUyU,CAAcJ,EAAWjQ,EAAQ8P,SAMtCG,EAAYjQ,EAAQ8P,OAEpBD,EAAO7P,IAPLpG,EAAOmW,IAAIC,gBAYzBpW,EAAOmW,IAAIO,SAAQ,WACjBT,OAIJjW,EAAOH,QAAUuG,EAAQ8P,QAAU,I,gBCvEnC,IAAIJ,EAAM,EAAQ,OACF1P,EAAU,EAAQ,OAIC,iBAFvBA,EAAUA,EAAQ2P,WAAa3P,EAAQ4P,QAAU5P,KAG/CA,EAAU,CAAC,CAACpG,EAAOC,GAAImG,EAAS,MAG9C,IAKI6P,EAASH,EAAI1P,EALH,CAEd,OAAiB,OACjB,WAAoB,IAMlB,IAAKA,EAAQ8P,QAAUlW,EAAOmW,IAAIC,WAAY,CAC5C,IAqBIC,EAAYjQ,EAAQ8P,OAExBlW,EAAOmW,IAAIG,OACT,OACA,WAK+B,iBAFvBlQ,GAFNA,EAAU,EAAQ,QAEM2P,WAAa3P,EAAQ4P,QAAU5P,KAG/CA,EAAU,CAAC,CAACpG,EAAOC,GAAImG,EAAS,MA/BxB,SAAuBmQ,EAAGC,GAChD,IAAKD,GAAKC,GAAKD,IAAMC,EACnB,OAAO,EAGT,IAAIxU,EAEJ,IAAKA,KAAKuU,EACR,GAAIA,EAAEvU,KAAOwU,EAAExU,GACb,OAAO,EAIX,IAAKA,KAAKwU,EACR,IAAKD,EAAEvU,GACL,OAAO,EAIX,OAAO,EAeUyU,CAAcJ,EAAWjQ,EAAQ8P,SAMtCG,EAAYjQ,EAAQ8P,OAEpBD,EAAO7P,IAPLpG,EAAOmW,IAAIC,gBAYzBpW,EAAOmW,IAAIO,SAAQ,WACjBT,OAIJjW,EAAOH,QAAUuG,EAAQ8P,QAAU","file":"js/5205.e45da1da68f7ecd1955a.js","sourcesContent":["// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".rbac .pf-c-form .pf-c-form__group .pf-c-radio,.my-user-access .pf-c-form .pf-c-form__group .pf-c-radio{padding-bottom:8px}.rbac .pf-c-form .pf-c-form__group .pf-c-radio:last-child,.my-user-access .pf-c-form .pf-c-form__group .pf-c-radio:last-child{padding-bottom:0px}.rbac .pf-c-select__menu .ins-c-select__scrollable-section,.my-user-access .pf-c-select__menu .ins-c-select__scrollable-section{max-height:365px;overflow:auto}.rbac .ins-c-rbac-add-permission-title,.my-user-access .ins-c-rbac-add-permission-title{display:block}.rbac .pf-c-wizard__main-body .ins-c-rbac-seleted-chips,.my-user-access .pf-c-wizard__main-body .ins-c-rbac-seleted-chips{padding-bottom:var(--pf-global--spacer--md)}.rbac .pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group,.my-user-access .pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group{background-color:var(--pf-global--BackgroundColor--100)}.rbac .pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip,.my-user-access .pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip{background-color:var(--pf-global--palette--blue-50);border-radius:var(--pf-global--BorderRadius--lg)}.rbac .pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip .pf-c-chip__text,.my-user-access .pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip .pf-c-chip__text{font-size:var(--pf-global--FontSize--sm)}.rbac .pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip::before,.my-user-access .pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip::before{border-style:none}@media only screen and (max-width: 815px){.rbac .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content,.my-user-access .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content{padding:0px}.rbac .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group,.my-user-access .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:30em}}@media only screen and (max-width: 895px){.rbac .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group,.my-user-access .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:32em}}@media only screen and (min-width: 992px){.rbac .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content,.my-user-access .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content{padding:0px}.rbac .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group,.my-user-access .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:25em}}@media only screen and (min-width: 1055px){.rbac .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group,.my-user-access .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:32em}}@media only screen and (min-width: 1150px){.rbac .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group,.my-user-access .ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:35em}}.rbac .ins-c-rbac-cost-resource-select .pf-c-select__menu .pf-c-select__menu-item:nth-child(3) .pf-c-check__input,.my-user-access .ins-c-rbac-cost-resource-select .pf-c-select__menu .pf-c-select__menu-item:nth-child(3) .pf-c-check__input{display:none}.rbac .ins-c-rbac-cost-resource-select .pf-c-select__menu .pf-c-select__menu-item:nth-child(3) .pf-c-check__label,.my-user-access .ins-c-rbac-cost-resource-select .pf-c-select__menu .pf-c-select__menu-item:nth-child(3) .pf-c-check__label{color:var(--pf-global--link--Color)}.rbac .ins-c-rbac-disabled-row,.my-user-access .ins-c-rbac-disabled-row{background-color:var(--pf-global--disabled-color--300)}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".rbac .ins-c-rbac__sticky .ins-c-rbac__sticky--title,.my-user-access .ins-c-rbac__sticky .ins-c-rbac__sticky--title{margin-bottom:var(--pf-global--spacer--sm);border-bottom:1px solid var(--pf-global--palette--black-300)}.rbac .ins-c-rbac__sticky .ins-c-rbac__sticky--title .pf-l-grid__item,.my-user-access .ins-c-rbac__sticky .ins-c-rbac__sticky--title .pf-l-grid__item{font-weight:var(--pf-global--FontWeight--bold);margin-bottom:var(--pf-global--spacer--sm) !important}.rbac .ins-c-rbac__sticky .ins-c-rbac__sticky--data,.my-user-access .ins-c-rbac__sticky .ins-c-rbac__sticky--data{max-height:240px;overflow:auto;-ms-overflow-style:none;scrollbar-width:none}.rbac .ins-c-rbac__sticky .data::-webkit-scrollbar,.my-user-access .ins-c-rbac__sticky .data::-webkit-scrollbar{display:none}.rbac .ins-c-rbac__gutter-sm,.my-user-access .ins-c-rbac__gutter-sm{margin-bottom:var(--pf-global--spacer--sm)}.rbac .ins-c-rbac__gutter-md,.my-user-access .ins-c-rbac__gutter-md{margin-bottom:var(--pf-global--spacer--md)}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Chip, ChipGroup, Text, TextContent, Title, Button, Popover } from '@patternfly/react-core';\nimport useFormApi from '@data-driven-forms/react-form-renderer/dist/esm/use-form-api';\nimport QuestionCircleIcon from '@patternfly/react-icons/dist/js/icons/outlined-question-circle-icon';\nimport './add-role-wizard.scss';\n\nconst AddPermissionTemplate = ({ formFields }) => {\n  const formOptions = useFormApi();\n  const [selectedPermissions, setSelectedPermissions] = useState(formOptions.getState().values['add-permissions-table'] || []);\n\n  const unresolvedSplats =\n    formOptions.getState().values?.['copy-base-role']?.applications?.filter((app) => !selectedPermissions?.find(({ uuid }) => uuid.includes(app))) ||\n    [];\n  const addPermissions = formFields[0][0];\n  return (\n    <div className=\"rbac\">\n      {selectedPermissions.length > 0 ? (\n        <div className=\"ins-c-rbac-seleted-chips\">\n          <ChipGroup categoryName=\"Selected permissions\">\n            {/* immutable reverse */}\n            {selectedPermissions\n              .reduce((acc, i) => [i, ...acc], [])\n              .map(({ uuid }) => (\n                <Chip key={uuid} color=\"blue\" isTruncated onClick={() => setSelectedPermissions(selectedPermissions.filter((p) => p.uuid !== uuid))}>\n                  {uuid}\n                </Chip>\n              ))}\n          </ChipGroup>\n        </div>\n      ) : null}\n      <Title headingLevel=\"h1\" size=\"xl\" className=\"ins-c-rbac-add-permission-title\">\n        Add permissions\n      </Title>\n      <TextContent>\n        <Text>\n          Select permissions to add to your role\n          {unresolvedSplats.length !== 0 && (\n            <Popover\n              headerContent=\"Custom roles only support granular permissions\"\n              bodyContent=\"Wildcard permissions (for example, approval:*:*) aren’t included in this table and can’t be added to your custom role.\"\n            >\n              <Button variant=\"link\">\n                Why am I not seeing all of my permissions? <QuestionCircleIcon />\n              </Button>\n            </Popover>\n          )}\n        </Text>\n      </TextContent>\n      {[\n        [\n          {\n            ...addPermissions,\n            props: {\n              ...addPermissions.props,\n              selectedPermissions,\n              setSelectedPermissions,\n            },\n          },\n        ],\n      ]}\n    </div>\n  );\n};\n\nAddPermissionTemplate.propTypes = {\n  formFields: PropTypes.array,\n};\n\nexport default AddPermissionTemplate;\n","import { useEffect } from 'react';\nimport { fetchRoles } from '../../../helpers/role/role-helper';\nimport asyncDebounce from '../../../utilities/async-debounce';\nimport useFormApi from '@data-driven-forms/react-form-renderer/dist/esm/use-form-api';\n\nexport const asyncValidator = async (roleName) => {\n  if (!roleName) {\n    return undefined;\n  }\n\n  const response = await fetchRoles({ limit: 10, offset: 0, name: roleName, nameMatch: 'exact' }).catch((error) => {\n    console.error(error);\n    return undefined;\n  });\n\n  if (response?.data?.length > 0) {\n    throw 'Name has already been taken';\n  }\n\n  return undefined;\n};\n\nexport const debouncedAsyncValidator = asyncDebounce(asyncValidator);\n\nexport const ValidatorReset = ({ name }) => {\n  const formOptions = useFormApi();\n\n  useEffect(() => {\n    setTimeout(() => formOptions.change(name, '1'));\n\n    return () => formOptions.change(name, '');\n  }, []);\n\n  return null;\n};\n","import React, { useContext, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { Bullseye, Spinner, Text, TextContent, Title } from '@patternfly/react-core';\nimport { AddRoleWizardContext } from './add-role-wizard';\nimport { asyncValidator } from './validators';\nimport './review.scss';\nimport useFormApi from '@data-driven-forms/react-form-renderer/dist/esm/use-form-api';\nimport WizardError from '../../common/wizard-error';\n\nconst ReviewTemplate = ({ formFields }) => {\n  const { submitting, error, setWizardError } = useContext(AddRoleWizardContext);\n  const { getState } = useFormApi();\n  useEffect(() => {\n    setWizardError(undefined);\n    asyncValidator(getState().values['role-name'])\n      .then(() => setWizardError(false))\n      .catch(() => setWizardError(true));\n  }, []);\n\n  if (typeof error === 'undefined' || submitting) {\n    return (\n      <Bullseye>\n        <Spinner size=\"xl\" />\n      </Bullseye>\n    );\n  }\n\n  if (error === true) {\n    return (\n      <WizardError\n        context={AddRoleWizardContext}\n        title=\"Role name already taken\"\n        text=\"Please return to Step 1: Create role and choose a unique role name for your custom role.\"\n      />\n    );\n  }\n\n  return (\n    <div className=\"rbac\">\n      <Title headingLevel=\"h1\" size=\"xl\" className=\"ins-c-rbac__gutter-sm\">\n        Review details\n      </Title>\n      <TextContent className=\"ins-c-rbac__gutter-md\">\n        <Text>Review and confirm the details for your role, or click Back to revise.</Text>\n      </TextContent>\n      {[[{ ...formFields?.[0]?.[0] }]]}\n    </div>\n  );\n};\n\nReviewTemplate.propTypes = {\n  formFields: PropTypes.array,\n};\n\nexport default ReviewTemplate;\n","import React, { useContext } from 'react';\nimport { Title, Button, EmptyState, EmptyStateVariant, EmptyStateIcon, EmptyStateBody, EmptyStateSecondaryActions } from '@patternfly/react-core';\nimport { CheckCircleIcon } from '@patternfly/react-icons';\nimport { Link } from 'react-router-dom';\nimport { AddRoleWizardContext } from './add-role-wizard';\n\nconst AddRoleSuccess = () => {\n  const { setHideForm } = useContext(AddRoleWizardContext);\n  return (\n    <EmptyState variant={EmptyStateVariant.large}>\n      <EmptyStateIcon color=\"green\" icon={CheckCircleIcon} />\n      <Title headingLevel=\"h4\" size=\"lg\">\n        You have successfully created a new role\n      </Title>\n      <EmptyStateBody></EmptyStateBody>\n      <Button component={(props) => <Link to=\"/roles\" {...props} />} variant=\"primary\">\n        Exit\n      </Button>\n      <EmptyStateSecondaryActions>\n        <Button\n          onClick={() => {\n            setHideForm(false);\n          }}\n          variant=\"link\"\n        >\n          Create another role\n        </Button>\n        <Button component={(props) => <Link to=\"/groups\" {...props} />} variant=\"link\">\n          Add role to group\n        </Button>\n      </EmptyStateSecondaryActions>\n    </EmptyState>\n  );\n};\n\nexport default AddRoleSuccess;\n","import React, { useState, useEffect } from 'react';\nimport { shallowEqual, useSelector, useDispatch } from 'react-redux';\nimport { Radio, Alert } from '@patternfly/react-core';\nimport { TableToolbarView } from '../../../presentational-components/shared/table-toolbar-view';\nimport { fetchRolesForWizard } from '../../../redux/actions/role-actions';\nimport { mappedProps } from '../../../helpers/shared/helpers';\nimport useFieldApi from '@data-driven-forms/react-form-renderer/dist/esm/use-field-api';\nimport useFormApi from '@data-driven-forms/react-form-renderer/dist/esm/use-form-api';\nimport { sortable } from '@patternfly/react-table';\n\nconst columns = ['', { title: 'Name', key: 'display_name', transforms: [sortable] }, 'Description'];\nconst selector = ({ roleReducer: { rolesForWizard, isLoading } }) => ({\n  roles: rolesForWizard.data,\n  pagination: rolesForWizard.meta,\n  isLoading,\n});\n\nconst BaseRoleTable = (props) => {\n  const dispatch = useDispatch();\n  const fetchData = (options) => dispatch(fetchRolesForWizard(options));\n  const [filterValue, setFilterValue] = useState('');\n  const { roles, pagination } = useSelector(selector, shallowEqual);\n  const { input } = useFieldApi(props);\n  const formOptions = useFormApi();\n\n  useEffect(() => {\n    fetchData({\n      limit: 50,\n      offset: 0,\n      itemCount: 0,\n      orderBy: 'display_name',\n    });\n  }, []);\n\n  const createRows = (roles) =>\n    roles.map((role) => ({\n      cells: [\n        {\n          title: (\n            <Radio\n              id={`${role.uuid}-radio`}\n              name={`${role.name}-radio`}\n              aria-label={`${role.name}-radio`}\n              ouiaId={`${role.name}-radio`}\n              value={role.uuid}\n              isChecked={input.value.uuid === role.uuid}\n              onChange={() => {\n                formOptions.batch(() => {\n                  input.onChange(role);\n                  formOptions.change('role-copy-name', `Copy of ${role.display_name || role.name}`);\n                  formOptions.change('role-copy-description', role.description);\n                  formOptions.change('add-permissions-table', []);\n                  formOptions.change('base-permissions-loaded', false);\n                });\n              }}\n            />\n          ),\n          props: { className: 'pf-c-table__check' },\n        },\n        role.display_name || role.name,\n        role.description,\n      ],\n    }));\n  return (\n    <div>\n      <Alert\n        variant=\"info\"\n        isInline\n        title={`Only granular permissions will be copied into a custom role \\\n        (for example, approval:requests:read). Wildcard permissions will not \\\n        be copied into a custom role (for example, approval:*:read).\n        `}\n      />\n      <TableToolbarView\n        columns={columns}\n        createRows={createRows}\n        data={roles}\n        fetchData={(config) => fetchData(mappedProps(config))}\n        filterValue={filterValue}\n        setFilterValue={({ name }) => setFilterValue(name)}\n        isLoading={false}\n        pagination={pagination}\n        titlePlural=\"roles\"\n        titleSingular=\"role\"\n        filterPlaceholder=\"role name\"\n        ouiaId=\"roles-table\"\n        isCompact\n        tableId=\"base-role\"\n      />\n    </div>\n  );\n};\n\nexport default BaseRoleTable;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Tooltip } from '@patternfly/react-core';\nimport { RowWrapper } from '@patternfly/react-table';\n\nexport const DisabledRowWrapper = ({ row, ...props }) =>\n  row.disableSelection ? (\n    <Tooltip\n      content={\n        <div>\n          To add this permission to your role and define specific resources for it, at least one data source must be connected.{' '}\n          <a href=\"./settings/sources\">Configure sources for Cost Management</a>\n        </div>\n      }\n      exitDelay={1500}\n      entryDelay={1500}\n    >\n      <RowWrapper className=\"ins-c-rbac-disabled-row\" row={row} {...props} />\n    </Tooltip>\n  ) : (\n    <RowWrapper row={row} {...props} />\n  );\n\nDisabledRowWrapper.propTypes = {\n  props: PropTypes.object,\n  row: PropTypes.object,\n};\n","import React, { useCallback, useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { shallowEqual, useSelector, useDispatch } from 'react-redux';\nimport useFieldApi from '@data-driven-forms/react-form-renderer/dist/esm/use-field-api';\nimport useFormApi from '@data-driven-forms/react-form-renderer/dist/esm/use-form-api';\nimport debouncePromise from '@redhat-cloud-services/frontend-components-utilities/debounce';\nimport { TableToolbarView } from '../../../presentational-components/shared/table-toolbar-view';\nimport { listPermissions, listPermissionOptions, expandSplats, resetExpandSplats } from '../../../redux/actions/permission-action';\nimport { getResourceDefinitions } from '../../../redux/actions/cost-management-actions';\nimport { fetchRole } from '../../../redux/actions/role-actions';\nimport { DisabledRowWrapper } from './DisabledRowWrapper';\n\nconst columns = ['Application', 'Resource type', 'Operation'];\nconst selector = ({\n  permissionReducer: {\n    permission,\n    isLoading,\n    options: { application, operation, resource },\n    expandSplats,\n    isLoadingExpandSplats,\n  },\n  roleReducer: { isRecordLoading, selectedRole },\n  costReducer: { resourceTypes },\n}) => ({\n  permissions: permission.data.map(({ application, resource_type: resource, verb, permission } = {}) => ({\n    application,\n    resource,\n    operation: verb,\n    uuid: permission,\n  })),\n  pagination: permission.meta,\n  isLoading: isLoading || isRecordLoading,\n  baseRole: selectedRole,\n  applicationOptions: application.data.filter((app) => app !== '*'),\n  resourceOptions: resource.data.filter((app) => app !== '*'),\n  operationOptions: operation.data.filter((app) => app !== '*'),\n  expandedPermissions: expandSplats.data.map(({ permission }) => permission),\n  isLoadingExpandSplats,\n  resourceTypes: resourceTypes.data,\n});\n\nconst AddPermissionsTable = ({ selectedPermissions, setSelectedPermissions, ...props }) => {\n  const dispatch = useDispatch();\n  const fetchData = (apiProps) => dispatch(listPermissions(apiProps));\n  const fetchOptions = (apiProps) => dispatch(listPermissionOptions(apiProps));\n  const {\n    permissions,\n    isLoading,\n    pagination,\n    baseRole,\n    applicationOptions,\n    resourceOptions,\n    operationOptions,\n    expandedPermissions,\n    isLoadingExpandSplats,\n    resourceTypes,\n  } = useSelector(selector, shallowEqual);\n  const { input } = useFieldApi(props);\n  const formOptions = useFormApi();\n  // TODO: use reducer when cleaning this code\n  const [filters, setFilters] = useState({ applications: [], resources: [], operations: [] });\n  const roleType = formOptions.getState().values['role-type']; // create/copy\n  const [isToggled, setIsToggled] = useState(false);\n  const [filterBy, setFilterBy] = useState('');\n  const [value, setValue] = useState();\n  const maxFilterItems = 10;\n\n  const getResourceType = (permission) => resourceTypes.find((r) => r.value === permission.split(':')?.[1]);\n  const createRows = (permissions) =>\n    permissions.map(({ application, resource, operation, uuid }) => ({\n      uuid: `${application}:${resource}:${operation}`,\n      cells: [\n        {\n          title: application,\n        },\n        resource,\n        operation,\n      ],\n      selected: Boolean(selectedPermissions && selectedPermissions.find((row) => row.uuid === uuid)),\n      disableSelection: application === 'cost-management' && (getResourceType(uuid) || { count: 0 }).count === 0,\n    }));\n\n  const debounbcedGetApplicationOptions = useCallback(\n    debouncePromise(\n      ({ applications, resources, operations }) =>\n        fetchOptions({\n          field: 'application',\n          limit: 50,\n          application: applications.join(),\n          resourceType: resources.join(),\n          verb: operations.join(),\n        }),\n      3000\n    ),\n    []\n  );\n  const debounbcedGetResourceOptions = useCallback(\n    debouncePromise(\n      ({ applications, resources, operations }) =>\n        fetchOptions({\n          field: 'resource_type',\n          limit: 50,\n          application: applications.join(),\n          resourceType: resources.join(),\n          verb: operations.join(),\n        }),\n      3000\n    ),\n    []\n  );\n  const debounbcedGetOperationOptions = useCallback(\n    debouncePromise(\n      ({ applications, resources, operations }) =>\n        fetchOptions({ field: 'verb', limit: 50, application: applications.join(), resourceType: resources.join(), verb: operations.join() }),\n      3000\n    ),\n    []\n  );\n\n  useEffect(() => {\n    const baseRoleUuid = formOptions.getState().values['copy-base-role']?.uuid;\n    if (roleType === 'copy' && baseRoleUuid) {\n      dispatch(fetchRole(baseRoleUuid));\n    }\n\n    dispatch(getResourceDefinitions());\n    formOptions.change('has-cost-resources', false);\n    fetchData(pagination);\n    fetchOptions({ field: 'application', limit: 50 });\n    fetchOptions({ field: 'resource_type', limit: 50 });\n    fetchOptions({ field: 'verb', limit: 50 });\n\n    return () => dispatch(resetExpandSplats());\n  }, []);\n\n  useEffect(() => {\n    debounbcedGetResourceOptions(filters);\n    debounbcedGetOperationOptions(filters);\n  }, [filters.applications]);\n\n  useEffect(() => {\n    debounbcedGetApplicationOptions(filters);\n    debounbcedGetOperationOptions(filters);\n  }, [filters.resources]);\n\n  useEffect(() => {\n    debounbcedGetApplicationOptions(filters);\n    debounbcedGetResourceOptions(filters);\n  }, [filters.operations]);\n\n  useEffect(() => {\n    input.onChange(selectedPermissions);\n  }, [selectedPermissions]);\n\n  useEffect(() => {\n    if (\n      !baseRole ||\n      roleType !== 'copy' ||\n      formOptions.getState().values['base-permissions-loaded'] ||\n      selectedPermissions.length > 0 ||\n      formOptions.getState().values['copy-base-role']?.uuid !== baseRole?.uuid ||\n      isLoadingExpandSplats ||\n      isLoading\n    ) {\n      return;\n    }\n\n    const basePermissions = baseRole?.access || [];\n    if (expandedPermissions.length === 0 && typeof isLoadingExpandSplats === 'undefined') {\n      const applications = [...new Set(basePermissions.map(({ permission }) => permission.split(':')[0]))];\n      dispatch(expandSplats({ application: applications.join() }));\n    } else {\n      const patterns = basePermissions.map(({ permission }) => permission.replace('*', '.*'));\n      setSelectedPermissions(() =>\n        expandedPermissions\n          .filter((p) => p.split(':')[0] !== 'cost-management' || (getResourceType(p) || { count: 0 }).count !== 0) // filter disabled rows\n          .filter((p) => patterns.some((f) => p.match(f))) // filter permissions with unresolved splats\n          .map((permission) => ({ uuid: permission }))\n      );\n      formOptions.change('base-permissions-loaded', true);\n    }\n  }, [permissions, baseRole]);\n\n  const setCheckedItems = (newSelection) => {\n    setSelectedPermissions(newSelection(selectedPermissions).map(({ uuid }) => ({ uuid })));\n  };\n\n  const calculateSelected = (filter) =>\n    filter.reduce(\n      (acc, curr) => ({\n        0: {\n          ...acc?.['0'],\n          [curr]: true,\n        },\n      }),\n      { 0: {} }\n    );\n\n  const preparedFilterItems = {\n    applications: [...applicationOptions].filter((item) => item.includes(filterBy)).map((app) => ({ label: app, value: app })),\n    resources: [...resourceOptions].filter((item) => item.includes(filterBy)).map((res) => ({ label: res, value: res })),\n    operations: [...operationOptions].filter((item) => item.includes(filterBy)).map((op) => ({ label: op, value: op })),\n  };\n\n  const emptyItem = {\n    label: <div> No results found</div>,\n    isDisabled: true,\n  };\n\n  const filterItemOverflow = preparedFilterItems[Object.keys(preparedFilterItems)[value ? value : 0]].length > maxFilterItems;\n  return (\n    <div className=\"ins-c-rbac-permissions-table\">\n      <TableToolbarView\n        columns={columns}\n        isSelectable={true}\n        isCompact={true}\n        borders={false}\n        createRows={createRows}\n        data={permissions}\n        filterValue={''}\n        noData={permissions?.length === 0}\n        noDataDescription={[\n          'Adjust your filters and try again. Note: Applications that only have wildcard \\\n          permissions (for example, patch:*:*) aren’t included in this table and can’t be \\\n          added to your custom role.',\n        ]}\n        fetchData={({ limit, offset, applications, resources, operations }) => {\n          fetchData({\n            limit,\n            offset,\n            application: (applications || filters.applications).join(),\n            resourceType: (resources || filters.resources).join(),\n            verb: (operations || filters.operations).join(),\n          });\n        }}\n        setFilterValue={({ applications, resources, operations }) => {\n          setFilters({\n            ...filters,\n            ...(applications ? { applications } : filters.applications),\n            ...(resources ? { resources } : filters.resources),\n            ...(operations ? { operations } : filters.operations),\n          });\n        }}\n        isLoading={isLoading || isLoadingExpandSplats}\n        pagination={{ ...pagination, count: pagination.count }}\n        checkedRows={selectedPermissions}\n        setCheckedItems={setCheckedItems}\n        titlePlural=\"permissions\"\n        titleSingular=\"permission\"\n        showMoreTitle={isToggled ? 'See less' : 'See more'}\n        onFilter={(filterBy) => setFilterBy(filterBy)}\n        onShowMore={\n          filterItemOverflow\n            ? () => {\n                setIsToggled(() => !isToggled);\n              }\n            : undefined\n        }\n        onChange={(e, value) => {\n          setFilterBy('');\n          setValue(value);\n        }}\n        value={value}\n        filters={[\n          {\n            key: 'applications',\n            value: filters.applications,\n            placeholder: 'Filter by application',\n            type: 'group',\n            selected: calculateSelected(filters.applications),\n            groups: [\n              {\n                type: preparedFilterItems.applications.length > 0 ? 'checkbox' : 'plain',\n                items:\n                  preparedFilterItems.applications.length > 0\n                    ? [...preparedFilterItems.applications].slice(0, isToggled ? undefined : maxFilterItems)\n                    : [emptyItem],\n              },\n            ],\n          },\n          {\n            key: 'resources',\n            value: filters.resources,\n            placeholder: 'Filter by resource type',\n            type: 'group',\n            selected: calculateSelected(filters.resources),\n            groups: [\n              {\n                type: preparedFilterItems.resources.length > 0 ? 'checkbox' : 'plain',\n                items:\n                  preparedFilterItems.resources.length > 0\n                    ? [...preparedFilterItems.resources].slice(0, isToggled ? undefined : maxFilterItems)\n                    : [emptyItem],\n              },\n            ],\n          },\n          {\n            key: 'operations',\n            value: filters.operations,\n            placeholder: 'Filter by operation',\n            type: 'group',\n            selected: calculateSelected(filters.operations),\n            groups: [\n              {\n                type: preparedFilterItems.operations.length > 0 ? 'checkbox' : 'plain',\n                items:\n                  preparedFilterItems.operations.length > 0\n                    ? [...preparedFilterItems.operations].slice(0, isToggled ? undefined : maxFilterItems)\n                    : [emptyItem],\n              },\n            ],\n          },\n        ]}\n        isFilterable={true}\n        rowWrapper={DisabledRowWrapper}\n        tableId=\"add-role-permissions\"\n        {...props}\n      />\n    </div>\n  );\n};\n\nAddPermissionsTable.propTypes = {\n  selectedPermissions: PropTypes.array,\n  setSelectedPermissions: PropTypes.func,\n};\n\nexport default AddPermissionsTable;\n","import React from 'react';\nimport useFormApi from '@data-driven-forms/react-form-renderer/dist/esm/use-form-api';\nimport { Stack, StackItem, Grid, GridItem, Text, TextVariants } from '@patternfly/react-core';\nimport './review.scss';\n\nconst stickyTable = (columns, rows) => (\n  <div className=\"ins-c-rbac__sticky\">\n    <Grid className=\"ins-c-rbac__sticky--title\">\n      {columns.map((col) => (\n        <GridItem span={12 / columns.length} key={col}>\n          {col}\n        </GridItem>\n      ))}\n    </Grid>\n    <Grid className=\"ins-c-rbac__sticky--data\">\n      {rows.map((row) =>\n        row.cells.map((cell) => (\n          <GridItem span={12 / columns.length} key={cell}>\n            {cell}\n          </GridItem>\n        ))\n      )}\n    </Grid>\n  </div>\n);\n\nconst ReviewStep = () => {\n  const formOptions = useFormApi();\n  const {\n    'role-name': name,\n    'role-description': description,\n    'role-copy-name': copyName,\n    'role-copy-description': copyDescription,\n    'add-permissions-table': permissions,\n    'resource-definitions': resourceDefinitions,\n    'has-cost-resources': hasCostResources,\n    'role-type': type,\n  } = formOptions.getState().values;\n  const columns = ['Application', 'Resource type', 'Operation'];\n  const rows = permissions.map((permission) => ({\n    cells: permission.uuid.split(':'),\n  }));\n\n  const resourceDefinitionsRows = (resourceDefinitions || []).map(({ permission, resources }) => ({\n    cells: [permission, resources.join(', ')],\n  }));\n\n  return (\n    <React.Fragment>\n      <Stack>\n        <StackItem className=\"ins-c-rbac__summary\">\n          <Grid>\n            <GridItem sm={12} md={2}>\n              <Text component={TextVariants.h4} className=\"ins-c-rbac__bold-text\">\n                Name\n              </Text>\n            </GridItem>\n            <GridItem sm={12} md={10}>\n              <Text component={TextVariants.p}>{type === 'create' ? name : copyName}</Text>\n            </GridItem>\n          </Grid>\n          <Grid>\n            <GridItem sm={12} md={2}>\n              <Text component={TextVariants.h4} className=\"ins-c-rbac__bold-text\">\n                Description\n              </Text>\n            </GridItem>\n            <GridItem sm={12} md={10}>\n              <Text component={TextVariants.p}>{type === 'create' ? description : copyDescription}</Text>\n            </GridItem>\n          </Grid>\n          <Grid>\n            <GridItem sm={12} md={2}>\n              <Text component={TextVariants.h4} className=\"ins-c-rbac__bold-text\">\n                Permissions\n              </Text>\n            </GridItem>\n            <GridItem sm={12} md={10}>\n              {stickyTable(columns, rows)}\n            </GridItem>\n          </Grid>\n          {hasCostResources && (\n            <Grid>\n              <GridItem sm={12} md={2}>\n                <Text component={TextVariants.h4} className=\"ins-c-rbac__bold-text\">\n                  Resource definitions\n                </Text>\n              </GridItem>\n              <GridItem sm={12} md={10}>\n                {stickyTable(['Permission', 'Resource definitions'], resourceDefinitionsRows)}\n              </GridItem>\n            </Grid>\n          )}\n        </StackItem>\n      </Stack>\n    </React.Fragment>\n  );\n};\n\nexport default ReviewStep;\n","import React, { useEffect, useReducer } from 'react';\nimport { shallowEqual, useSelector, useDispatch } from 'react-redux';\nimport { Select, SelectOption, SelectVariant, Grid, GridItem, Text, TextVariants, FormGroup } from '@patternfly/react-core';\nimport useFieldApi from '@data-driven-forms/react-form-renderer/dist/esm/use-field-api';\nimport useFormApi from '@data-driven-forms/react-form-renderer/dist/esm/use-form-api';\nimport { getResourceDefinitions, getResource } from '../../../redux/actions/cost-management-actions';\n\nconst selector = ({ costReducer: { resourceTypes, isLoading, loadingResources, resources } }) => ({\n  resourceTypes: resourceTypes.data,\n  resources,\n  isLoading,\n  isLoadingResources: loadingResources > 0,\n});\n\nconst reducer = (state, action) => {\n  const prevState = state[action.key];\n  switch (action.type) {\n    case 'toggle':\n      return {\n        ...state,\n        [action.key]: {\n          ...prevState,\n          isOpen: !prevState.isOpen,\n        },\n      };\n    case 'select':\n      return {\n        ...state,\n        [action.key]: {\n          ...prevState,\n          selected: prevState.selected.includes(action.selection)\n            ? prevState.selected.filter((item) => item !== action.selection)\n            : [...prevState.selected, action.selection],\n        },\n      };\n    case 'selectAll':\n      return {\n        ...state,\n        [action.key]: {\n          ...prevState,\n          selected: prevState.options.map((option) => option.value),\n        },\n      };\n    case 'clear':\n      return {\n        ...state,\n        [action.key]: {\n          ...prevState,\n          selected: [],\n        },\n      };\n    case 'setOptions':\n      return {\n        ...state,\n        [action.key]: {\n          ...prevState,\n          options: action.options,\n          filteredOptions: action.options,\n        },\n      };\n    case 'setFilter':\n      return {\n        ...state,\n        [action.key]: {\n          ...prevState,\n          filteredOptions: prevState.options.filter(({ value }) => value.includes(action.filtervalue)),\n        },\n      };\n    default:\n      return state;\n  }\n};\n\nconst CostResources = (props) => {\n  const dispatch = useDispatch();\n  const fetchData = (apiProps) => dispatch(getResourceDefinitions(apiProps));\n  const fetchResource = (apiProps) => dispatch(getResource(apiProps));\n  const { resourceTypes, isLoading, isLoadingResources, resources } = useSelector(selector, shallowEqual);\n  const { input } = useFieldApi(props);\n  const formOptions = useFormApi();\n  const permissions = formOptions.getState().values['add-permissions-table'].filter(({ uuid }) => uuid.split(':')[0].includes('cost-management'));\n  const [state, dispatchLocaly] = useReducer(\n    reducer,\n    permissions.reduce(\n      (acc, permission) => ({\n        ...acc,\n        [permission.uuid]: {\n          selected: [],\n          options: [],\n          filteredOptions: [],\n          isOpen: false,\n        },\n      }),\n      {}\n    )\n  );\n  const onToggle = (key, isOpen) => dispatchLocaly({ type: 'toggle', key, isOpen });\n  const clearSelection = (key) => dispatchLocaly({ type: 'clear', key });\n  const onSelect = (event, selection, selectAll, key) =>\n    selectAll ? dispatchLocaly({ type: 'selectAll', selection, key }) : dispatchLocaly({ type: 'select', selection, key });\n\n  const permissionToResource = (permission) => resourceTypes.find((r) => r.value === permission.split(':')?.[1])?.path.split('/')?.[5];\n\n  useEffect(() => {\n    (formOptions.getState().values['resource-definitions'] || []).map(({ permission, resources }) =>\n      resources.map((resource) => permissions.includes(permission) && dispatchLocaly({ type: 'select', selection: resource, key: permission }))\n    );\n    fetchData();\n    formOptions.change('has-cost-resources', true);\n  }, []);\n\n  useEffect(() => {\n    if (!isLoading) {\n      const resourcePaths = [\n        ...new Set(permissions.map((permission) => resourceTypes.find((r) => r.value === permission.uuid.split(':')?.[1])?.path)),\n      ].filter((path) => path); // remove undefined\n      resourcePaths.map((path) => fetchResource(path));\n    }\n  }, [resourceTypes]);\n\n  useEffect(() => {\n    if (!isLoadingResources) {\n      permissions.map((p) => dispatchLocaly({ type: 'setOptions', key: p.uuid, options: resources[permissionToResource(p.uuid)] || [] }));\n    }\n  }, [isLoadingResources]);\n\n  useEffect(() => {\n    const resourceDefinitions = Object.entries(state).map(([permission, resources]) => ({ permission, resources: resources.selected }));\n    input.onChange(resourceDefinitions);\n    formOptions.change('resource-definitions', resourceDefinitions);\n  }, [state]);\n\n  // eslint-disable-next-line react/prop-types\n  const makeRow = ({ uuid: permission }) => {\n    const options = state[permission].filteredOptions;\n    return (\n      <React.Fragment>\n        <GridItem md={4} sm={12}>\n          <FormGroup label={permission} isRequired></FormGroup>\n        </GridItem>\n        <GridItem md={8} sm={12}>\n          <Select\n            className=\"ins-c-rbac-cost-resource-select\"\n            variant={SelectVariant.checkbox}\n            typeAheadAriaLabel=\"Select a state\"\n            onToggle={(isOpen) => {\n              dispatchLocaly({ type: 'setFilter', key: permission, filtervalue: '' });\n              onToggle(permission, isOpen);\n            }}\n            onSelect={(event, selection) => {\n              onSelect(event, selection, selection === `Select All (${options.length})`, permission);\n            }}\n            onClear={() => clearSelection(permission)}\n            selections={state[permission].selected}\n            isOpen={state[permission].isOpen}\n            onFilter={(e) => e && dispatchLocaly({ type: 'setFilter', key: permission, filtervalue: e.target.value })}\n            aria-labelledby={permission}\n            placeholderText=\"Select resources\"\n            hasInlineFilter\n          >\n            {[\n              <SelectOption key={0} value={`Select All (${options.length})`} />,\n              ...options.map((option, index) => <SelectOption key={index + 1} value={option.value} />),\n            ]}\n          </Select>\n        </GridItem>\n      </React.Fragment>\n    );\n  };\n\n  return (\n    <Grid hasGutter>\n      <GridItem md={4} className=\"ins-m-hide-on-sm\">\n        <Text component={TextVariants.h4} className=\"ins-c-rbac__bold-text\">\n          Cost management permissions\n        </Text>\n      </GridItem>\n      <GridItem md={8} className=\"ins-m-hide-on-sm\">\n        <Text component={TextVariants.h4} className=\"ins-c-rbac__bold-text\">\n          Resource definitions\n        </Text>\n      </GridItem>\n      {permissions.map(makeRow)}\n    </Grid>\n  );\n};\n\nexport default CostResources;\n","import React, { useState, useEffect, useRef, createContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch } from 'react-redux';\nimport { addNotification } from '@redhat-cloud-services/frontend-components-notifications/';\nimport FormRenderer from '@data-driven-forms/react-form-renderer/dist/esm/form-renderer';\nimport Pf4FormTemplate from '@data-driven-forms/pf4-component-mapper/dist/esm/form-template';\nimport componentMapper from '@data-driven-forms/pf4-component-mapper/dist/esm/component-mapper';\nimport { Wizard } from '@patternfly/react-core';\nimport schemaBuilder from './schema';\nimport { createRole, fetchRolesWithPolicies } from '../../../redux/actions/role-actions';\nimport { WarningModal } from '../../../smart-components/common/warningModal';\nimport AddRoleSuccess from './add-role-success';\nimport BaseRoleTable from './base-role-table';\nimport AddPermissionsTable from './add-permissions';\nimport ReviewStep from './review';\nimport CostResources from './cost-resources';\nimport TypeSelector from './type-selector';\nimport './add-role-wizard.scss';\n\nexport const AddRoleWizardContext = createContext({\n  success: false,\n  submitting: false,\n  error: undefined,\n});\n\nconst FormTemplate = (props) => <Pf4FormTemplate {...props} showFormControls={false} />;\n\nconst Description = ({ Content, ...rest }) => <Content {...rest} />;\nDescription.propTypes = {\n  Content: PropTypes.elementType.isRequired,\n};\n\nexport const mapperExtension = {\n  'base-role-table': BaseRoleTable,\n  'add-permissions-table': AddPermissionsTable,\n  'cost-resources': CostResources,\n  review: ReviewStep,\n  description: Description,\n  'type-selector': TypeSelector,\n};\n\nconst AddRoleWizard = ({ history: { push } }) => {\n  const dispatch = useDispatch();\n  const [wizardContextValue, setWizardContextValue] = useState({\n    success: false,\n    submitting: false,\n    error: undefined,\n    hideForm: false,\n  });\n  const [cancelWarningVisible, setCancelWarningVisible] = useState(false);\n  const container = useRef(document.createElement('div'));\n  const [schema, setSchema] = useState({});\n\n  useEffect(() => {\n    setSchema(schemaBuilder(container.current));\n  }, []);\n\n  useEffect(() => {\n    container.current.hidden = cancelWarningVisible;\n  }, [cancelWarningVisible]);\n\n  const onCancel = () => {\n    if (!wizardContextValue.success) {\n      dispatch(\n        addNotification({\n          variant: 'warning',\n          title: 'Creating role was canceled by the user',\n          dismissDelay: 8000,\n          dismissable: false,\n        })\n      );\n    }\n\n    push('/roles');\n  };\n\n  const setWizardError = (error) => setWizardContextValue((prev) => ({ ...prev, error }));\n  const setWizardSuccess = (success) => setWizardContextValue((prev) => ({ ...prev, success }));\n  const setHideForm = (hideForm) => setWizardContextValue((prev) => ({ ...prev, hideForm }));\n\n  const onSubmit = (formData) => {\n    const {\n      'role-name': name,\n      'role-description': description,\n      'role-copy-name': copyName,\n      'role-copy-description': copyDescription,\n      'add-permissions-table': permissions,\n      'cost-resources': resourceDefinitions,\n      'role-type': type,\n    } = formData;\n    setWizardContextValue((prev) => ({ ...prev, submitting: true }));\n    const roleData = {\n      applications: [...new Set(permissions.map(({ uuid: permission }) => permission.split(':')[0]))],\n      description: (type === 'create' ? description : copyDescription) || null,\n      name: type === 'create' ? name : copyName,\n      access: permissions.map(({ uuid: permission }) => ({\n        permission,\n        resourceDefinitions: resourceDefinitions?.find((r) => r.permission === permission)\n          ? [\n              {\n                attributeFilter: {\n                  key: `cost-management.${permission.split(':')[1]}`,\n                  operation: 'in',\n                  value: resourceDefinitions?.find((r) => r.permission === permission).resources,\n                },\n              },\n            ]\n          : [],\n      })),\n    };\n    return dispatch(createRole(roleData)).then(() => {\n      setWizardContextValue((prev) => ({ ...prev, submitting: false, success: true, hideForm: true }));\n      dispatch(fetchRolesWithPolicies());\n    });\n  };\n\n  return (\n    <AddRoleWizardContext.Provider value={{ ...wizardContextValue, setWizardError, setWizardSuccess, setHideForm }}>\n      <WarningModal type=\"role\" isOpen={cancelWarningVisible} onModalCancel={() => setCancelWarningVisible(false)} onConfirmCancel={onCancel} />\n      {wizardContextValue.hideForm ? (\n        <Wizard\n          title=\"Create role\"\n          isOpen\n          onClose={() => push('/roles')}\n          steps={[\n            {\n              name: 'success',\n              component: <AddRoleSuccess />,\n              isFinishedStep: true,\n            },\n          ]}\n        />\n      ) : (\n        <FormRenderer\n          schema={schema}\n          container={container}\n          subscription={{ values: true }}\n          FormTemplate={FormTemplate}\n          initialValues={{\n            'role-type': 'create',\n          }}\n          componentMapper={{ ...componentMapper, ...mapperExtension }}\n          onSubmit={onSubmit}\n          onCancel={(values) => {\n            const showWarning = Boolean((values && values['role-name']) || values['role-description'] || values['copy-base-role']);\n            if (showWarning) {\n              setCancelWarningVisible(true);\n            } else {\n              onCancel();\n            }\n          }}\n        />\n      )}\n    </AddRoleWizardContext.Provider>\n  );\n};\n\nAddRoleWizard.propTypes = {\n  history: PropTypes.shape({\n    push: PropTypes.func.isRequired,\n  }).isRequired,\n};\n\nexport default AddRoleWizard;\n","import React, { useState } from 'react';\nimport { Radio } from '@patternfly/react-core';\nimport useFieldApi from '@data-driven-forms/react-form-renderer/dist/esm/use-field-api';\nimport useFormApi from '@data-driven-forms/react-form-renderer/dist/esm/use-form-api';\n\nconst TypeSelector = (props) => {\n  const { input } = useFieldApi(props);\n  const formOptions = useFormApi();\n  const [checked, setChecked] = useState(formOptions.getState().values['role-type']);\n  const handleChange = (val) => {\n    setChecked(val);\n    input.onChange(val);\n    formOptions.change('add-permissions-table', []);\n    formOptions.change('base-permissions-loaded', false);\n  };\n\n  return (\n    <div>\n      <Radio\n        isChecked={checked === 'create'}\n        className=\"pf-u-mb-sm\"\n        name=\"role-type-create\"\n        onChange={() => handleChange('create')}\n        label=\"Create a role from scratch\"\n        id=\"role-type-create\"\n        value=\"create\"\n      />\n      <Radio\n        isChecked={checked === 'copy'}\n        name=\"role-type-copy\"\n        onChange={() => handleChange('copy')}\n        label=\"Copy an existing role\"\n        id=\"role-type-copy\"\n        value=\"copy\"\n      />\n    </div>\n  );\n};\n\nexport default TypeSelector;\n","import React from 'react';\nimport validatorTypes from '@data-driven-forms/react-form-renderer/dist/esm/validator-types';\nimport AddPermissionTemplate from './add-permissions-template';\nimport ReviewTemplate from './review-template';\nimport { debouncedAsyncValidator, ValidatorReset } from './validators';\nimport ReviewStepButtons from '../../common/review-step-buttons';\nimport { AddRoleWizardContext } from './add-role-wizard';\n\nexport default (container) => ({\n  fields: [\n    {\n      component: 'wizard',\n      name: 'wizard',\n      isDynamic: true,\n      inModal: true,\n      showTitles: true,\n      crossroads: ['role-type'],\n      title: 'Create role',\n      container,\n      fields: [\n        {\n          title: 'Create role',\n          name: 'step-1',\n          nextStep: {\n            when: 'role-type',\n            stepMapper: {\n              copy: 'name-and-description',\n              create: 'add-permissions',\n            },\n          },\n          fields: [\n            {\n              component: 'type-selector',\n              name: 'role-type',\n              isRequired: true,\n              validate: [\n                {\n                  type: validatorTypes.REQUIRED,\n                },\n              ],\n            },\n            {\n              component: 'text-field',\n              name: 'role-name',\n              type: 'text',\n              label: 'Role name',\n              isRequired: true,\n              condition: {\n                when: 'role-type',\n                is: 'create',\n              },\n              validate: [\n                debouncedAsyncValidator,\n                {\n                  type: validatorTypes.REQUIRED,\n                },\n                {\n                  type: validatorTypes.MAX_LENGTH,\n                  threshold: 150,\n                },\n              ],\n            },\n            {\n              component: 'text-field',\n              name: 'role-description',\n              type: 'text',\n              label: 'Role description',\n              condition: {\n                when: 'role-type',\n                is: 'create',\n              },\n              validate: [\n                {\n                  type: 'max-length',\n                  threshold: 150,\n                },\n              ],\n            },\n            {\n              component: 'base-role-table',\n              name: 'copy-base-role',\n              label: 'Base role',\n              isRequired: true,\n              condition: {\n                when: 'role-type',\n                is: 'copy',\n              },\n              validate: [\n                {\n                  type: validatorTypes.REQUIRED,\n                },\n              ],\n            },\n            {\n              condition: {\n                when: 'role-type',\n                is: 'create',\n              },\n              component: 'description',\n              name: 'fixasyncvalidation',\n              Content: ValidatorReset,\n            },\n            {\n              condition: {\n                when: 'role-type',\n                is: 'copy',\n              },\n              component: 'description',\n              name: 'fixasyncvalidation2',\n              Content: ValidatorReset,\n            },\n          ],\n        },\n        {\n          title: 'Name and description',\n          name: 'name-and-description',\n          nextStep: 'add-permissions',\n          fields: [\n            {\n              component: 'text-field',\n              name: 'role-copy-name',\n              type: 'text',\n              label: 'Role name',\n              isRequired: true,\n              validate: [\n                debouncedAsyncValidator,\n                {\n                  type: validatorTypes.REQUIRED,\n                },\n                {\n                  type: 'max-length',\n                  threshold: 150,\n                },\n              ],\n            },\n            {\n              component: 'text-field',\n              name: 'role-copy-description',\n              type: 'text',\n              label: 'Role description',\n              validate: [\n                {\n                  type: 'max-length',\n                  threshold: 150,\n                },\n              ],\n            },\n          ],\n        },\n        {\n          name: 'add-permissions',\n          title: 'Add permissions',\n          StepTemplate: AddPermissionTemplate,\n          nextStep: ({ values }) =>\n            values &&\n            values['add-permissions-table'] &&\n            values['add-permissions-table'].some(({ uuid }) => uuid.split(':')[0].includes('cost-management'))\n              ? 'cost-resources-definition'\n              : 'review',\n          fields: [\n            {\n              component: 'add-permissions-table',\n              name: 'add-permissions-table',\n            },\n          ],\n        },\n        {\n          name: 'cost-resources-definition',\n          title: 'Define Cost Management resources',\n          nextStep: 'review',\n          fields: [\n            {\n              component: 'plain-text',\n              name: 'text-description',\n              label: <p>Specify where you would like to apply each cost permission selected in the previous step, using the dropdown below.</p>,\n            },\n            {\n              component: 'cost-resources',\n              name: 'cost-resources',\n              validate: [\n                (value = []) =>\n                  value.every((p) => p.resources.length > 0) ? undefined : 'You need to assign at least one resource to each permission.',\n              ],\n            },\n          ],\n        },\n        {\n          name: 'review',\n          title: 'Review details',\n          // eslint-disable-next-line react/display-name\n          buttons: (props) => <ReviewStepButtons {...props} context={AddRoleWizardContext} />,\n          StepTemplate: ReviewTemplate,\n          fields: [\n            {\n              component: 'review',\n              name: 'review',\n            },\n          ],\n        },\n      ],\n    },\n  ],\n});\n","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../../node_modules/sass-loader/dist/cjs.js!./add-role-wizard.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\nif (module.hot) {\n  if (!content.locals || module.hot.invalidate) {\n    var isEqualLocals = function isEqualLocals(a, b) {\n  if (!a && b || a && !b) {\n    return false;\n  }\n\n  var p;\n\n  for (p in a) {\n    if (a[p] !== b[p]) {\n      return false;\n    }\n  }\n\n  for (p in b) {\n    if (!a[p]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n    var oldLocals = content.locals;\n\n    module.hot.accept(\n      \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../../node_modules/sass-loader/dist/cjs.js!./add-role-wizard.scss\",\n      function () {\n        content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../../node_modules/sass-loader/dist/cjs.js!./add-role-wizard.scss\");\n\n              content = content.__esModule ? content.default : content;\n\n              if (typeof content === 'string') {\n                content = [[module.id, content, '']];\n              }\n\n              if (!isEqualLocals(oldLocals, content.locals)) {\n                module.hot.invalidate();\n\n                return;\n              }\n\n              oldLocals = content.locals;\n\n              update(content);\n      }\n    )\n  }\n\n  module.hot.dispose(function() {\n    update();\n  });\n}\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../../node_modules/sass-loader/dist/cjs.js!./review.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\nif (module.hot) {\n  if (!content.locals || module.hot.invalidate) {\n    var isEqualLocals = function isEqualLocals(a, b) {\n  if (!a && b || a && !b) {\n    return false;\n  }\n\n  var p;\n\n  for (p in a) {\n    if (a[p] !== b[p]) {\n      return false;\n    }\n  }\n\n  for (p in b) {\n    if (!a[p]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n    var oldLocals = content.locals;\n\n    module.hot.accept(\n      \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../../node_modules/sass-loader/dist/cjs.js!./review.scss\",\n      function () {\n        content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../../node_modules/sass-loader/dist/cjs.js!./review.scss\");\n\n              content = content.__esModule ? content.default : content;\n\n              if (typeof content === 'string') {\n                content = [[module.id, content, '']];\n              }\n\n              if (!isEqualLocals(oldLocals, content.locals)) {\n                module.hot.invalidate();\n\n                return;\n              }\n\n              oldLocals = content.locals;\n\n              update(content);\n      }\n    )\n  }\n\n  module.hot.dispose(function() {\n    update();\n  });\n}\n\nmodule.exports = content.locals || {};"],"sourceRoot":""}