(self.webpackChunkrbac=self.webpackChunkrbac||[]).push([[9475],{66180:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var s=i(66029),r=i.n(s),a=i(9947),o=i(67880),n=i(43049),l=i(75106),c=i(80315),p=i(80810);const u=({title:e,icon:t,description:i,actions:s,...u})=>r().createElement(a.u,{variant:a.I.sm,...u},r().createElement(o.t,{titleText:r().createElement(r().Fragment,null,e),icon:r().createElement(n.k,{icon:t||p.SearchIcon}),headingLevel:"h4"}),r().createElement(l.B,{className:"pf-v5-u-mb-md"},i.map(((e,t)=>r().createElement(r().Fragment,{key:t},e," ",r().createElement("br",null))))),r().createElement(c.O,null,s))},97246:(e,t,i)=>{"use strict";i.d(t,{M:()=>F});var s=i(66029),r=i.n(s),a=i(25387),o=i(45697),n=i.n(o),l=i(2550),c=i(79083),p=i(75863),u=i(21081),m=i(49004),f=i(34844),d=i(15433),g=i(12913),h=i(7065),y=i(47173),b=i(18517),v=i(7081),k=i(29301),C=i(68572),E=i(66180);const F=({className:e,isCompact:t,borders:i,columns:o,rows:n,toolbarButtons:F,data:R,actionResolver:w,areActionsDisabled:D,routes:M,titlePlural:Z,titleSingular:S,pagination:B,paginationProps:P,filterValue:O,isLoading:x,emptyFilters:I,setFilterValue:A,checkedRows:q,isSelectable:T,isRowSelectable:L,fetchData:V,setCheckedItems:$,emptyProps:j,filterPlaceholder:N,rowWrapper:W,filters:Y,isFilterable:z,onShowMore:H,showMoreTitle:K,onFilter:_,onChange:Q,value:U,sortBy:G,onSort:J,isExpandable:X,onExpand:ee,hideFilterChips:te,hideHeader:ie,noData:se,noDataDescription:re,ouiaId:ae,tableId:oe,containerRef:ne,textFilterRef:le,toolbarChildren:ce})=>{const pe=(0,a.YB)(),ue=(0,c.useFlag)("platform.rbac.itless");return r().createElement("div",{className:e},M(),!x&&0===n?.length&&0===O?.length&&Y.every((({value:e})=>!e))?r().createElement(E.Z,{title:pe.formatMessage(l.Z.configureItems,{items:Z}),icon:v.wl,description:[pe.formatMessage(l.Z.toConfigureUserAccess),pe.formatMessage(l.Z.createAtLeastOneItem,{item:S})],actions:F()[0],...j}):(()=>{const e=`${"desc"===G?.direction?"-":""}${o[G?.index]?.key}`;return r().createElement(s.Fragment,null,r().createElement(C.ZP,{isSelectable:T,isRowSelectable:L,checkedRows:q,setCheckedItems:$,isLoading:x||se,data:R,titleSingular:S,filterValue:O,setFilterValue:A,sortBy:e,pagination:B,paginationProps:P,fetchData:V,toolbarButtons:F,filterPlaceholder:N,filters:Y,isFilterable:z,onShowMore:H,showMoreTitle:K,onFilter:_,onChange:Q,value:U,hideFilterChips:te,tableId:oe,containerRef:ne,textFilterRef:le,toolbarChildren:ce}),x?r().createElement(g.Z,{variant:t?p.B.compact:void 0,rows:B?.limit,columns:o.map((e=>e.title))}):r().createElement(u.i,{canSelectAll:!1,"aria-label":`${Z.toLowerCase()} table`,variant:t?p.B.compact:null,borders:i,...T&&n?.length>0&&{onSelect:(e,t,i,{uuid:s,cells:[r],requires:a})=>$((0,k.ZQ)([{uuid:s,name:r,requires:a,...ue&&{username:R[i]?.username}}],t))},...X&&{onExpand:ee},rows:n?.length>0?n:[{fullWidth:!0,cells:[{title:r().createElement(E.Z,{title:pe.formatMessage(l.Z.noMatchingItemsFound,{items:Z}),description:se&&re?re:[pe.formatMessage(l.Z.filterMatchesNoItems,{items:Z}),pe.formatMessage(l.Z.tryChangingFilters)],actions:se&&re?void 0:[r().createElement(h.U,{key:"clear-filters"},r().createElement(y.zx,{variant:"link",ouiaId:"clear-filters-button",onClick:()=>{A(I),V({...B,offset:0,...I||{name:""}})}},pe.formatMessage(l.Z.clearAllFilters)))]}),props:{colSpan:o.length}}]}],cells:o,...n?.length>0&&{actionResolver:w},className:0==n?.length?"ins-c-table-empty-state":"",areActionsDisabled:D,rowWrapper:W,sortBy:G,ouiaId:ae,onSort:(e,t,i,s)=>J(e,t,i,s)},!ie&&r().createElement(m.x,null),r().createElement(f.R,null)),!B.noBottom&&r().createElement(d.Z,null,!x&&r().createElement(b.t,{...(0,C.Wz)(B,V,O,G,P),variant:"bottom",dropDirection:"up"})))})())};F.propTypes={...C.ZP.propTypes,sortBy:n().shape({directions:n().string,index:n().number}),className:n().string,rowWrapper:n().any,isCompact:n().bool,isRowSelectable:n().func,borders:n().bool,emptyFilters:n().object,checkedRows:n().array,columns:n().array.isRequired,rows:n().array.isRequired,titlePlural:n().string,routes:n().func,actionResolver:n().func,areActionsDisabled:n().func,pagination:n().shape({noBottom:n().bool,limit:n().number,offset:n().number,count:n().number}),paginationProps:n().shape({toggleTemplate:n().func,isCompact:n().bool}),isExpandable:n().bool,onExpand:n().func,onSort:n().func,containerRef:n().node,noData:n().bool,hideFilterChips:n().bool,hideHeader:n().bool,noDataDescription:n().arrayOf(n().node),filters:n().array,tableId:n().string.isRequired,toolbarChildren:n().func},F.defaultProps={...C.ZP.defaultProps,emptyFilters:{},isCompact:!1,borders:!0,routes:()=>null,hideFilterChips:!1,checkedRows:[],hideHeader:!1,toolbarChildren:()=>null}},68572:(e,t,i)=>{"use strict";i.d(t,{Wz:()=>f,ZP:()=>b});var s=i(66029),r=i.n(s),a=i(31611),o=i(25387),n=i(45697),l=i.n(n),c=i(2550),p=i(96486),u=i(29301),m=i(74982);const f=(e={},t,i="",s="",r)=>({...r,itemCount:e.count,perPage:e.limit,page:(0,m.wy)(e.limit,e.offset),onSetPage:(r,a)=>{t({...e,offset:(0,m.vE)(a,e.limit),name:i,orderBy:s})},perPageOptions:[{title:"5",value:5},{title:"10",value:10},{title:"20",value:20},{title:"50",value:50},{title:"100",value:100}],onPerPageSelect:(e,r)=>{t({offset:0,limit:r,name:i,orderBy:s})}}),d=(e,t=[],i=(()=>{}),s=[],r,a=(()=>!0))=>{const n=(0,o.YB)();return{count:t.length,items:[{title:n.formatMessage(c.Z.selectNone),onClick:()=>{i((()=>[]))}},{...!e&&s&&s.length>0?{title:n.formatMessage(c.Z.selectPage,{length:s.filter(a).length}),onClick:()=>{i((0,u.ZQ)(s,!0))}}:{}}],checked:(0,u.um)(s,t,a),onSelect:t=>{!e&&i((0,u.ZQ)(s,t))},id:r}},g=(e,t=(()=>{}),i=(()=>{}),s="",r={},a="",n,l,m,f,d,g,h,y,b,v,k)=>{const C=(0,o.YB)();return{onChange:y,value:b,items:[...m&&m.length>0?m.map((({key:a,label:o,value:n,selected:l,placeholder:y,type:b="text",groups:k,items:E,innerRef:F})=>({label:o||(0,u.RI)(a),type:b??"text",filterValues:{innerRef:F,id:`filter-by-${a}`,key:`filter-by-${a}`,placeholder:y||C.formatMessage(c.Z.filterByKey,{key:a}),value:n,selected:l,..."text"!==b?{isFilterable:f,onShowMore:d,showMoreTitle:g,onFilter:h}:{},groups:k,items:E,onChange:(e,o)=>{const n="string"==typeof o||Array.isArray(o)?o:Object.keys((0,p.pickBy)(o[""],(e=>e)));t({...s,...r,offset:0,[a]:n}),(0,u.Aq)((()=>i({...r,offset:0,orderBy:v,...m.reduce(((e,t)=>({...e,[t.key]:t.value})),{}),[a]:n}))).then((e=>(F?.current?.focus(),e)))},isDisabled:e}}))):[{label:(0,u.RI)(n||a),type:"text",filterValues:{innerRef:k,id:"filter-by-string",key:"filter-by-string",placeholder:C.formatMessage(c.Z.filterByKey,{key:n||a}),value:s,onChange:(e,s)=>{t({...r,offset:0,name:s}),(0,u.Aq)((()=>i({...r,offset:0,name:s,orderBy:v}))).then((e=>(k?.current?.focus(),e)))},isDisabled:e}}],...l||[]]}},h=(e="",t,i={},s=(()=>{}),r=(()=>{}),a)=>({filters:t&&t.length>0?t.map((({key:e,value:t})=>t&&0!==t.length&&{category:(0,u.RI)(e),type:e,chips:Array.isArray(t)?t.map((e=>({name:e}))):[{name:t}]})).filter(Boolean):[{name:e}],onDelete:(e,[o],n)=>{const l=(e,t,i)=>n?"group"===t||"checkbox"===t?[]:"":i!==o.type?e:"checkbox"===t||"group"===t?e.filter((e=>e!==o.chips[0]?.name)):Array.isArray(e)?[]:"",c=t.reduce(((e,{key:t,value:i,type:s})=>({...e,[t]:l(i,s,t)})),{});s({...i,offset:0,name:"",...c}),r({...i,offset:0,orderBy:a,name:"",...c})}}),y=({isSelectable:e,isRowSelectable:t,checkedRows:i,setCheckedItems:s,isLoading:o,data:n,titleSingular:l,filterValue:c,setFilterValue:p,pagination:u,paginationProps:m,fetchData:y,sortBy:b,toolbarButtons:v,filterPlaceholder:k,filterItems:C,filters:E,isFilterable:F,onShowMore:R,showMoreTitle:w,onFilter:D,onChange:M,value:Z,hideFilterChips:S,tableId:B,textFilterRef:P,toolbarChildren:O})=>r().createElement(a.Z,{...e&&{bulkSelect:d(o,i,s,n,B,t)},filterConfig:g(o,p,y,c,u,l,k,C,E,F,R,w,D,M,Z,b,P),actionsConfig:{actions:v()},...!o&&{pagination:f(u,y,c,b,m)},...(c.length>0||E&&E.length>0)&&!S&&{activeFiltersConfig:h(c,E,u,p,y,b)}},O());y.propTypes={isSelectable:l().bool,isRowSelectable:l().func,checkedRows:l().array,setCheckedItems:l().func,isLoading:l().bool,data:l().array,titleSingular:l().string,filterValue:l().oneOfType([l().array,l().string]),setFilterValue:l().func,filters:l().arrayOf(l().shape({value:l().oneOfType([l().string,l().number,l().array]),key:l().string,placeholder:l().string})),isFilterable:l().bool,onShowMore:l().func,showMoreTitle:l().string,onFilter:l().func,onChange:l().func,value:l().any,pagination:l().shape({limit:l().number,offset:l().number,count:l().number}),paginationProps:l().shape({toggleTemplate:l().func,isCompact:l().bool}),sortBy:l().string,filterItems:l().arrayOf(l().object),filterPlaceholder:l().string,isCollapsible:l().bool,fetchData:l().func.isRequired,toolbarButtons:l().func,hideFilterChips:l().bool,tableId:l().string,textFilterRef:l().object,toolbarChildren:l().func},y.defaultProps={isCollapsible:!1,isSelectable:!1,isLoading:!1,data:[],titleSingular:"",filterValue:[],pagination:m.he,setCheckedItems:()=>{},setFilterValue:()=>{},sortBy:void 0,toolbarButtons:()=>[],filterItems:[],filters:[],isFilterable:!1,hideFilterChips:!1,toolbarChildren:()=>null};const b=y},23817:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>d});var s=i(80236),r=i(47173),a=i(66029),o=i.n(a),n=i(45697),l=i.n(n),c=i(97246),p=i(74982),u=i(25387),m=i(2550);const f=({isOpen:e,handleClose:t,permission:i,resourceDefinitions:n})=>{const l=(0,u.YB)(),[{rows:f,pagination:d,filterValue:g},h]=(0,a.useState)((()=>({filterValue:"",rows:n.map((({attributeFilter:{value:e}})=>e)).slice(0,p.he.limit),pagination:{...p.he,count:n.length}}))),y=({name:e="",limit:t,offset:i},s=!1)=>h((({pagination:r,filterValue:a})=>{const o=n.map((({attributeFilter:{value:e}})=>e)).filter((t=>t.includes(e))).slice(i,t);return{rows:o,filterValue:s?e:a,pagination:{...r,offset:s?0:i,limit:t,count:o.length}}}));return o().createElement(s.u,{actions:[o().createElement(r.zx,{key:"close-action",variant:"primary",onClick:t},l.formatMessage(m.Z.close))],variant:"large",isOpen:e,onClose:t,title:l.formatMessage(m.Z.resourceDefinitions),description:o().createElement(u._H,{...m.Z.viewResourceDefinitions,values:{strong:e=>o().createElement("strong",null,e),permission:i}})},o().createElement(c.M,{columns:[""],data:f,filterValue:g,setFilterValue:e=>y(e,!0),pagination:d,ouiaId:"resource-definition-table",noData:0===n.length,rows:f.map((e=>({cells:[e]}))),titlePlural:l.formatMessage(m.Z.resourceDefinitions),titleSingular:l.formatMessage(m.Z.resourceDefinition),noDataDescription:[l.formatMessage(m.Z.resourceDefinition,{permission:i})],fetchData:y,tableId:"resource-definitions-modal"}))};f.propTypes={isOpen:l().bool,handleClose:l().func.isRequired,permission:l().string.isRequired,resourceDefinitions:l().arrayOf(l().shape({attributeFilter:l().shape({value:l().string.isRequired}).isRequired})).isRequired};const d=f},93312:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>V});var s=i(66029),r=i.n(s),a=i(45697),o=i.n(a),n=i(65655),l=i(86706),c=i(71079);const p=(0,i(75465).TR)();async function u({limit:e,offset:t,username:i,application:s="",status:r,orderBy:a}){return await p.getPrincipalAccess(s,i,a,r,e,t)}var m=i(74982),f=i(97246),d=i(25387),g=i(2550);const h=({onClick:e,access:t})=>{const i=(0,d.YB)();return 0===t.resourceDefinitions.length?r().createElement("span",null,i.formatMessage(g.Z.notApplicable)):r().createElement("a",{onClick:()=>(e(),!1)},t.resourceDefinitions.length)};h.propTypes={onClick:o().func.isRequired,access:o().shape({resourceDefinitions:o().array.isRequired}).isRequired};const y=h,b=(e,t,i)=>e.reduce(((e,{permission:a,...o},n)=>{const[l,c,p]=a.split(":");return[...e,{cells:[l,c,p,...t?[r().createElement(s.Fragment,{key:"rd"},r().createElement(y,{onClick:()=>i(n),access:o}))]:[]]}]}),[]);var v=i(23817),k=i(7732);const C=({filters:e,setFilters:t,apps:i,hasActiveFilters:a,showResourceDefinitions:o})=>{const n=(0,d.YB)(),[{rdOpen:p,rdPermission:h,resourceDefinitions:y},C]=(0,s.useState)({rdOpen:!1}),{current:E}=(0,s.useRef)([{title:n.formatMessage(g.Z.application),key:"application",transforms:[k.p]},{title:n.formatMessage(g.Z.resourceType),key:"resource_type",transforms:[k.p]},{title:n.formatMessage(g.Z.operation),key:"verb",transforms:[k.p]},...o?[{title:n.formatMessage(g.Z.resourceDefinitions)}]:[]]),F=(0,l.useDispatch)(),{permissions:R,isLoading:w}=(0,l.useSelector)((e=>({permissions:e.accessReducer.access,isLoading:e.accessReducer.isLoading})),l.shallowEqual),D=({application:e,...t})=>{F((e=>({type:c.ft,payload:u(e)}))({application:(e?.length>0?e:i).join(","),...t}))};(0,s.useEffect)((()=>{D({...m.he,orderBy:S})}),[]);const[M,Z]=(0,s.useState)({index:0,direction:"asc"}),S=`${"desc"===M?.direction?"-":""}${E[M?.index].key}`,B=R?.data||[];return r().createElement(s.Fragment,null,r().createElement(f.M,{columns:E,rows:b(B,o,(e=>C({rdOpen:!0,rdPermission:R.data[e].permission,resourceDefinitions:R.data[e].resourceDefinitions}))),data:B,fetchData:D,sortBy:M,onSort:(t,i,s)=>{const r=`${"desc"===s?"-":""}${E[i].key}`;Z({index:i,direction:s}),D({...R?.meta,offset:0,orderBy:r,...e?.length>0?{...e.reduce(((e,t)=>({...e,[t.key]:t.value})),{})}:{name:"",application:[]}})},filters:e,setFilterValue:t,isLoading:w,pagination:R?.meta,ouiaId:"permissions-table",titlePlural:n.formatMessage(g.Z.permissions).toLowerCase(),titleSingular:n.formatMessage(g.Z.permission).toLowerCase(),noData:!w&&!a&&0===B.length,noDataDescription:[n.formatMessage(g.Z.noPermissionsForInsights),n.formatMessage(g.Z.contactOrgAdministrator)],tableId:"mua-access"}),r().createElement(s.Suspense,{fallback:r().createElement(s.Fragment,null)},p&&r().createElement(v.default,{resourceDefinitions:y,isOpen:p,handleClose:()=>C({rdOpen:!1}),permission:h})))};C.propTypes={filters:o().arrayOf(o().object).isRequired,setFilters:o().func.isRequired,apps:o().arrayOf(o().string).isRequired,hasActiveFilters:o().bool,showResourceDefinitions:o().bool};const E=C;var F=i(23279),R=i.n(F),w=i(12913),D=i(13563),M=i(56869),Z=i(1082),S=i(75863),B=i(21081),P=i(49004),O=i(34844);const x=(0,s.lazy)((()=>Promise.resolve().then(i.bind(i,23817)))),I=({filters:e,setFilters:t,apps:i,showResourceDefinitions:a})=>{const o=(0,d.YB)(),[n,c]=(0,s.useState)({}),[{rdOpen:p,rdPermission:u,resourceDefinitions:m},h]=(0,s.useState)({rdOpen:!1}),b=[{title:o.formatMessage(g.Z.roles),key:"display_name",transforms:[k.p]},{title:o.formatMessage(g.Z.description)},{title:o.formatMessage(g.Z.permissions),cellTransforms:[M.z,(0,Z.d)(20)]}],v=[o.formatMessage(g.Z.application),o.formatMessage(g.Z.resourceType),o.formatMessage(g.Z.operation),...a?[o.formatMessage(g.Z.resourceDefinitions)]:[]],{roles:C,isLoading:E,rolesWithAccess:F}=(0,l.useSelector)((({roleReducer:{roles:e,isLoading:t,rolesWithAccess:i}})=>({roles:e,isLoading:t,rolesWithAccess:i})),l.shallowEqual),[I,A]=(0,s.useState)({index:0,direction:"asc"}),q=`${"desc"===I?.direction?"-":""}${b[I?.index].key}`,T=(0,l.useDispatch)();(0,s.useEffect)((()=>{T((0,D.vd)({limit:20,offset:0,orderBy:q,scope:"principal",application:i.join(",")}))}),[]);let L=(0,s.useCallback)(R()(((e,t,s,r,a,o)=>{const n=r?.length>0?r:i;return T((0,D.vd)({limit:e,offset:t,scope:"principal",orderBy:o,name:s,application:n.join(","),permission:a}))}),800),[]);return r().createElement(s.Fragment,null,r().createElement(f.M,{filters:e,columns:b,rows:(V=C.data,V?.reduce(((e,{uuid:t,display_name:i,name:o,description:l,accessCount:c},p)=>[...e,{uuid:t,cells:[{title:i||o,props:{component:"th",isOpen:!1}},{title:l,props:{isOpen:!1}},{title:c,props:{isOpen:2===n[t]}}]},{uuid:`${t}-groups`,parent:2*p,compoundParent:2,cells:[{props:{colSpan:4,className:"pf-m-no-padding"},title:F?.[t]?r().createElement(B.i,{ouiaId:"permissions-in-role-nested-table","aria-label":"Simple Table",borders:!1,variant:S.B.compact,cells:v,rows:F[t].access.map((e=>({cells:[...e.permission.split(":"),...a?[r().createElement(s.Fragment,{key:"rd"},r().createElement(y,{onClick:()=>h({rdOpen:!0,rdPermission:e.permission,resourceDefinitions:e.resourceDefinitions}),access:e}))]:[]]})))},r().createElement(P.x,null),r().createElement(O.R,null)):r().createElement(w.Z,{columns:v,rows:c,variant:S.B.compact})}]}]),[])),data:C.data,isCompact:!1,isExpandable:!0,onExpand:(e,t,i,s,r)=>{s?c((e=>({...e,[r.uuid]:-1}))):(c((e=>({...e,[r.uuid]:i}))),2===i&&T((0,D.DV)(r.uuid)))},ouiaId:"roles-table",fetchData:({limit:e,offset:t,name:i,application:s,permission:r})=>{L(e,t,i,s,r,q)},sortBy:I,onSort:(t,i,s)=>{const r=`${"desc"===s?"-":""}${b[i].key}`;A({index:i,direction:s}),T((0,D.vd)({offset:0,orderBy:r,...e?.length>0?{...e.reduce(((e,t)=>({...e,[t.key]:t.value})),{})}:{name:"",application:[]}}))},emptyFilters:{name:"",application:[]},setFilterValue:t,isLoading:E,pagination:C.meta,filterPlaceholder:"role name",titlePlural:"roles",titleSingular:"role",tableId:"mua-roles"}),r().createElement(s.Suspense,{fallback:r().createElement(s.Fragment,null)},p&&r().createElement(x,{resourceDefinitions:m,isOpen:p,handleClose:()=>h({rdOpen:!1}),permission:u})));var V};I.propTypes={fetchRoles:o().func,fetchRoleForPrincipal:o().func,fetchUsers:o().func,roles:o().object,isLoading:o().bool,rolesWithAccess:o().object,filters:o().arrayOf(o().object).isRequired,setFilters:o().func.isRequired,apps:o().arrayOf(o().string).isRequired,showResourceDefinitions:o().bool};const A=I,q=({apps:e})=>{const t=(0,s.useContext)(n.Z),[i,a]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,p]=(0,s.useState)([]),u=({name:e,application:t,permission:i})=>{"string"==typeof e&&a(e),"string"==typeof i&&l(i),t&&p("string"==typeof t?[]:t)},m=(({apps:e,isOrgAdmin:t,name:i="",application:s=[]})=>{const r=(0,d.YB)();return[{key:"application",value:s,placeholder:r.formatMessage(g.Z.filterByKey,{key:r.formatMessage(g.Z.application).toLowerCase()}),type:"checkbox",items:e.map((e=>({label:e,value:e})))},...t?[{key:"name",type:"text",value:i,label:r.formatMessage(g.Z.roleName),placeholder:r.formatMessage(g.Z.filterByKey,{key:r.formatMessage(g.Z.roleName).toLowerCase()})}]:[]]})({apps:e,isOrgAdmin:t,name:i,application:c,permission:o});return t?r().createElement(A,{setFilters:u,filters:m,apps:e}):r().createElement(E,{setFilters:u,filters:m,apps:e,hasActiveFilters:i.length>0||c.length>0})};q.propTypes={apps:o().arrayOf(o().string).isRequired};const T=q,L=({apps:e})=>r().createElement(T,{apps:e});L.propTypes={apps:o().arrayOf(o().string).isRequired};const V=L},70347:()=>{},90479:()=>{},25238:()=>{},46928:()=>{},87234:()=>{}}]);
//# sourceMappingURL=../sourcemaps/9475.d712792f44859c14d8c90a76bbb51c81.js.map