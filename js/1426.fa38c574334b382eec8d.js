"use strict";(self.webpackChunkrbac=self.webpackChunkrbac||[]).push([[1426,1789],{53926:(e,t,a)=>{a.d(t,{Lr:()=>n,cH:()=>s,nU:()=>r,rO:()=>l});var r,n,o=a(93345);!function(e){e.right="right",e.left="left"}(r||(r={})),function(e){e.up="up",e.down="down"}(n||(n={}));const l=o.createContext({onSelect:e=>{},id:"",toggleIndicatorClass:"",toggleIconClass:"",toggleTextClass:"",menuClass:"",itemClass:"",toggleClass:"",baseClass:"",baseComponent:"div",sectionClass:"",sectionTitleClass:"",sectionComponent:"section",disabledClass:"",plainTextClass:"",menuComponent:"ul"}),s=o.createContext({keyHandler:null,sendRef:null})},66181:(e,t,a)=>{a.d(t,{Ot:()=>n});var r=a(20612);const n=()=>({className:r.A.modifiers.nowrap})},16401:(e,t,a)=>{a.d(t,{A:()=>m});var r=a(74848),n=a(32485),o=a.n(n),l=a(63068),s=a(69),i=a(86228),c=function(){return c=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},c.apply(this,arguments)};const m=function(e){var t=e.className,a=e.title,n=e.actionsContent,m=e.ouiaId,u=e.ouiaSafe,d=void 0===u||u,p=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}(e,["className","title","actionsContent","ouiaId","ouiaSafe"]),f=o()(t),g="RHI/Header",y=(0,s.useOUIAId)(g,m,d);return(0,r.jsxs)(i.Flex,{justifyContent:{default:"justifyContentSpaceBetween"},children:[(0,r.jsx)(i.FlexItem,{children:(0,r.jsx)(l.Title,c({headingLevel:"h1",size:"2xl",className:f,"widget-type":"InsightsPageHeaderTitle","data-ouia-component-type":g,"data-ouia-component-id":y,"data-ouia-safe":d},p,{children:a}))}),n?(0,r.jsx)(i.FlexItem,{children:n}):null]})}},85655:(e,t,a)=>{a.d(t,{A:()=>s});var r=a(74848),n=a(32485),o=a.n(n),l=function(){return l=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},l.apply(this,arguments)};const s=function(e){var t,a=e.type,n=e.children,s=e.className,i=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}(e,["type","children","className"]),c=o()(s,((t={})["ins-l-".concat(a)]=void 0!==a,t));return(0,r.jsxs)("section",l({},i,{className:c,children:[" ",n," "]}))}},49420:(e,t,a)=>{a.d(t,{D_:()=>r,G:()=>o,JI:()=>n});const r=(e,t,a,r={})=>{const n=new URLSearchParams(e.search);let o=a.reduce(((e,t)=>{const a=n.getAll(t);return{...e,[t]:a.length>1?a:a[0]}}),{});return Object.keys(r).forEach((e=>{const t=r[e];o={...o,[e]:Array.isArray(o[e])?[...new Set([...o[e],...Array.isArray(t)?t:[t]])]:t?.length>0&&t||o[e]},Array.isArray(t)?t.forEach((t=>n.getAll(e).includes(t)||n.append(e,t))):n.get(e)||t&&n.set(e,t)})),t({pathname:e.pathname,search:n.toString()},{replace:!0}),o},n=(e,t)=>{const a=new URLSearchParams(e.search);return t.some((e=>a.get(e)))},o=(e,t,a)=>{const r=new URLSearchParams(e.search);Object.keys(a).forEach((e=>r.delete(e))),Object.keys(a).forEach((e=>{const t=a[e];Array.isArray(t)?t.forEach((t=>t&&r.append(e,t))):t&&r.set(e,t)})),t({pathname:e.pathname,search:r.toString()},{replace:!0})}},5314:(e,t,a)=>{a.d(t,{A:()=>u});var r=a(93345),n=a.n(r),o=a(5556),l=a.n(o),s=a(49634),i=a(92284),c=a(21996);const m=e=>e?n().createElement(i.Breadcrumb,null,Object.values(e).map(((e,t)=>e.title?n().createElement(i.BreadcrumbItem,{key:e.title,isActive:e.isActive},e.to&&n().createElement(s.NavLink,{end:!0,to:e.to},e.title)||e.title):n().createElement(c.nv,{key:t})))):null;m.propTypes={breadcrumbs:l().object};const u=m},58508:(e,t,a)=>{a.d(t,{N:()=>A,p:()=>v});var r=a(93345),n=a.n(r),o=a(5556),l=a.n(o),s=a(40748),i=a(32392),c=a(21996),m=a(5314),u=a(74848),d=a(32485),p=a.n(d);const f=n().createContext("light");var g=a(69),y=function(){return y=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},y.apply(this,arguments)};const b=function(e){var t=e.className,a=e.children,r=e.ouiaId,n=e.ouiaSafe,o=void 0===n||n,l=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}(e,["className","children","ouiaId","ouiaSafe"]),s=p()(t,"pf-v5-l-page-header","pf-v5-c-page-header","pf-v5-l-page__main-section","pf-v5-c-page__main-section"),i="RHI/Header",c=(0,g.useOUIAId)(i,r,o);return(0,u.jsx)(f.Consumer,{children:function(e){var t,r;void 0===e&&(e="light");var n=p()(((t={})["pf-m-".concat(e,"-200")]="dark"===e,t),((r={})["pf-m-light"]="light"===e,r));return(0,u.jsx)("section",y({"data-ouia-component-type":i,"data-ouia-component-id":c,"data-ouia-safe":o},l,{className:"".concat(s," ").concat(n),"widget-type":"InsightsPageHeader",children:a}))}})};var h=a(16401);const A=({children:e,breadcrumbs:t})=>n().createElement(r.Fragment,null,t&&n().createElement("section",{className:"pf-v5-c-page__main-breadcrumb"},n().createElement(m.A,{...t})),n().createElement(b,{className:"rbac-page-header"},e));A.propTypes={children:l().oneOfType([l().arrayOf(l().node),l().node]).isRequired,breadcrumbs:l().array,paddingBottom:l().bool},A.defaultProps={paddingBottom:!1};const v=({title:e,renderTitleTag:t,description:a,children:o})=>n().createElement(r.Fragment,null,n().createElement(i.Flex,null,n().createElement(i.FlexItem,{className:"pf-v5-u-mb-sm"},n().createElement(h.A,{title:e||n().createElement(c.BX,null),className:"rbac-page-header__title"})),n().createElement(i.FlexItem,{alignSelf:{modifier:"alignSelfCenter"}},t&&t())),a&&n().createElement(s.TextContent,{className:"rbac-page-header__description"},"string"==typeof a?n().createElement(s.Text,{component:s.TextVariants.p},a):a),o);v.propTypes={title:l().node,renderTitleTag:l().func,description:l().node,children:l().oneOfType([l().node,l().arrayOf(l().node)])}},67692:(e,t,a)=>{a.d(t,{A:()=>u});var r=a(93345),n=a.n(r),o=a(30133),l=a(5556),s=a.n(l),i=a(32485),c=a.n(i);const m=({className:e,row:t,...a})=>n().createElement(o.S,{className:c()(e,{"rbac-c-group-default":t.isPlatformDefault||t.isAdminDefault}),row:t,...a});m.propTypes={row:s().shape({isAdminDefault:s().bool,isPlatformDefault:s().bool}),className:s().string};const u=m},83753:(e,t,a)=>{a.r(t),a.d(t,{default:()=>X});var r=a(93345),n=a.n(r),o=a(49634),l=a(73317),s=a(99608),i=a(66181),c=a(79994),m=a(79300),u=a(8604),d=a(20881),p=a(85655),f=a(69733),g=a(38694),y=a(73963),b=a.n(y),h=a(17115),A=a.n(h),v=a(58731),E=a.n(v),C=a(46428),O=a(40748),k=a(42932),x=a(73683),N=a(68877),w=a(1104),I=a(97681),S=a(32485),M=a.n(S),_=a(5556),j=a.n(_),P=a(63767),R=a(47143),T=a(58471),D=a(42134),L=a(49573),B=a(47181),F=a(40335);const $=({id:e,uuid:t,bodyContent:a})=>{const[o,l]=(0,r.useState)(!1),s=(0,r.useRef)(null);return n().createElement("span",{ref:s,key:`${t}-popover`,id:e},n().createElement(C.Popover,{zIndex:"110",position:"right",isVisible:o,shouldClose:()=>l(!1),hideOnOutsideClick:!0,bodyContent:a,appendTo:s.current},n().createElement(b(),{onClick:()=>l(!o),className:M()("pf-v5-c-question-circle-icon",{"icon-active":o})})))};$.propTypes={id:j().string.isRequired,uuid:j().string.isRequired,bodyContent:j().string.isRequired};var G=a(99843),H=a(58508),q=a(67692),U=a(61361),V=a(49420),W=a(40262);const X=()=>{const e=(0,u.tz)(),t=(0,f.useDispatch)(),a=(0,o.useNavigate)(),y=(0,o.useLocation)(),b=(0,d.A)(),h=e=>t((0,G.pl)({...e,usesMetaInURL:!0,chrome:b,platformDefault:!1,adminDefault:!1})),{orgAdmin:v,userAccessAdministrator:C}=(0,r.useContext)(W.A),S=v||C,M=(0,r.useRef)(null),_=[{title:e.formatMessage(F.A.name),key:"name",transforms:[l.X]},{title:e.formatMessage(F.A.roles),cellTransforms:[s.w],transforms:[i.Ot]},{title:e.formatMessage(F.A.members),cellTransforms:[s.w],transforms:[i.Ot]},{title:e.formatMessage(F.A.lastModified),key:"modified",transforms:[l.X]}],[j,X]=(0,r.useState)({index:Number(S),direction:"asc"}),[J,z]=(0,r.useState)([]),[Z,K]=(0,r.useState)([]),[Q,Y]=(0,r.useState)({}),ee=`${"desc"===j?.direction?"-":""}${_[j?.index-Number(S)].key}`,{groups:te,pagination:ae,filters:re,isLoading:ne}=(0,f.useSelector)((({groupReducer:{groups:{data:e,filters:t,pagination:a},isLoading:r,adminGroup:n,systemGroup:o}})=>({groups:[...n?.name?.match(new RegExp(t.name,"i"))?[n]:[],...o?.name?.match(new RegExp(t.name,"i"))?[o]:[],...e?.filter((({platform_default:e,admin_default:t}={})=>!(e||t)))||[]],pagination:{limit:a?.limit??(v?U.Ar:U.L6).limit,offset:a?.offset??(v?U.Ar:U.L6).offset,count:a?.count,redirected:a?.redirected},filters:t,isLoading:r,systemGroup:o})),f.shallowEqual),[oe,le]=(0,r.useState)(re?.name||"");(0,r.useEffect)((()=>{(0,U.NJ)(y,a,ae.limit,ae.offset)}),[ae.offset,ae.limit,ae.count,ae.redirected]),(0,r.useEffect)((()=>{(0,V.G)(y,a,{name:oe})}),[oe]),(0,r.useEffect)((()=>{const{limit:e,offset:r}=(0,U.sJ)(y,a,ae),{name:n}=(0,V.D_)(y,a,["name"],{name:oe});le(n),b.appNavClick({id:"groups",secondaryNav:!0}),h({limit:e,offset:r,orderBy:ee,filters:{name:n}}),t((0,G.Tt)({filterValue:n,chrome:b})),t((0,G.jL)({filterValue:n,chrome:b}))}),[]),(0,r.useEffect)((()=>{y.pathname.includes("detail")?(0,D.b7)(y,a):((0,U.Wq)(y)||(0,U.NJ)(y,a,ae.limit,ae.offset),oe?.length>0&&!(0,V.JI)(y,["name"])&&(0,V.D_)(y,a,["name"],{name:oe}))}),[y.pathname]);const se=te.map((e=>e.platform_default||e.admin_default?{...e,principalCount:"All"+(e.admin_default?" org admins":"")}:e)),ie=(0,r.useCallback)(((e,a)=>t((0,G.xi)(e,{limit:100},a))),[t]),ce=(0,r.useCallback)((e=>t((0,G.X0)(e,void 0,{limit:100}))),[t]),me=((e,t,a,o=[])=>{const l=(0,u.tz)(),s=[{title:l.formatMessage(F.A.roleName)},{title:l.formatMessage(F.A.description)},{title:l.formatMessage(F.A.lastModified)}],i=[{title:l.formatMessage(F.A.orgAdministrator)},{title:l.formatMessage(F.A.firstName)},{title:l.formatMessage(F.A.lastName)},{title:l.formatMessage(F.A.username)},{title:l.formatMessage(F.A.email)},{title:l.formatMessage(F.A.status)}];return t.reduce(((t,{uuid:c,name:m,roleCount:u,principalCount:d,modified:p,roles:f,members:g,platform_default:y,admin_default:b,isLoadingRoles:h,isLoadingMembers:v},C)=>{const S=`compound-roles-${c}`,M=`compound-members-${c}`;return[...t,{uuid:c,isAdminDefault:b,isPlatformDefault:y,selected:Boolean(a&&a.find((e=>e.uuid===c))),cells:[{title:e?n().createElement(n().Fragment,null,n().createElement(T.A,{key:`${c}-link`,state:{uuid:c},to:L.A["group-detail-roles"].link.replace(":groupId",y?B.p3:c)},m),n().createElement(r.Fragment,null,(y||b)&&n().createElement($,{id:`default${b?"-admin":""}-group-popover`,uuid:c,key:`${c}-popover`,bodyContent:l.formatMessage(b?F.A.orgAdminInheritedRoles:F.A.usersInheritedRoles)}))):m},{title:u,props:{isOpen:2===o[c],ariaControls:S}},{title:d,props:y||b?{className:"rbac-c-not-expandable-cell"}:{isOpen:3===o[c],ariaControls:M}},{title:n().createElement(P.A,{date:p,type:(0,D.eW)(p)})}]},{uuid:`${c}-roles`,parent:3*C,compoundParent:1,fullWidth:!0,noPadding:!0,cells:[{props:{colSpan:7,className:"pf-m-no-padding"},title:h?n().createElement(R.A,{rows:u,variant:x.a.compact,columns:s.map((e=>e.title))}):u>0?n().createElement(N.X,{id:S,ouiaId:S,"aria-label":"Compound roles table",variant:x.a.compact,cells:s,rows:f?.map((e=>({cells:[{title:n().createElement(T.A,{to:L.A["role-detail"].link.replace(":roleId",e.uuid)},e.name)},e.description,n().createElement(r.Fragment,{key:`${c}-modified`},n().createElement(P.A,{date:p,type:(0,D.eW)(p)}))]})))},n().createElement(w.A,null),n().createElement(I.B,null)):n().createElement(O.Text,{id:S,className:"pf-v5-u-mx-lg pf-v5-u-my-sm"},l.formatMessage(F.A.noGroupRoles))}]},{uuid:`${c}-members`,parent:3*C,compoundParent:2,fullWidth:!0,noPadding:!0,cells:[{props:{colSpan:7,className:"pf-m-no-padding"},title:v?n().createElement(R.A,{rows:d,variant:x.a.compact,columns:i.map((e=>e.title))}):d>0?n().createElement(N.X,{id:M,ouiaId:M,"aria-label":"Compound members table",variant:x.a.compact,cells:i,rows:g?.map((e=>[n().createElement(O.TextContent,{key:e.is_org_admin},e?.is_org_admin?n().createElement(A(),{key:"yes-icon",className:"pf-v5-u-mx-sm"}):n().createElement(E(),{key:"no-icon",className:"pf-v5-u-mx-sm"}),l.formatMessage(e?.is_org_admin?F.A.yes:F.A.no)),e.first_name,e.last_name,e.username,e.email,n().createElement(k.Label,{key:e.is_active,color:e.is_active?"green":"grey"},l.formatMessage(e?.is_active?F.A.active:F.A.inactive))]))},n().createElement(w.A,null),n().createElement(I.B,null)):b||y?"":n().createElement(O.Text,{id:M,className:"pf-v5-u-mx-lg pf-v5-u-my-sm"},l.formatMessage(F.A.noGroupMembers))}]}]}),[])})(S,se,J,Q),ue=ae.count===Z.length;return n().createElement(m.Stack,{className:"rbac-c-groups"},n().createElement(m.StackItem,null,n().createElement(H.N,{paddingBottom:!0},n().createElement(H.p,{title:e.formatMessage(F.A.groups)}))),n().createElement(m.StackItem,null,n().createElement(p.A,{type:"content",id:"tab-groups"},n().createElement(g.Z,{data:te,rows:me,sortBy:j,onSort:(e,t,r)=>{const n=`${"desc"===r?"-":""}${_[t-Number(S)].key}`;X({index:t,direction:r}),(0,V.G)(y,a,{name:oe}),h({...ae,orderBy:n,filters:{name:oe}})},columns:_,isExpandable:!0,onExpand:(e,t,a,r,n)=>{r?Y({...Q,[n.uuid]:-1}):(Y({...Q,[n.uuid]:a+Number(!S)}),a+Number(!S)===2&&ie(n.uuid,{isPlatformDefault:n.isPlatformDefault,isAdminDefault:n.isAdminDefault}),a+Number(!S)===3&&ce(n.uuid))},isSelectable:S,isRowSelectable:e=>!(e.platform_default||e.admin_default||e.system),checkedRows:J,setCheckedItems:e=>{z((t=>e(t).filter((({platform_default:e,admin_default:t})=>!(e||t))).map((({uuid:e,name:t})=>({uuid:e,name:t})))))},actionResolver:({isPlatformDefault:t,isAdminDefault:r})=>t||r||!S?null:[{title:e.formatMessage(F.A.edit),onClick:(e,t,r)=>a((0,T.o)(L.A["edit-group"].link).replace(":groupId",r.uuid))},{title:e.formatMessage(F.A.delete),onClick:(e,t,r)=>{K([r]),a((0,T.o)(L.A["remove-group"].link.replace(":groupId",r.uuid)))}}],titlePlural:e.formatMessage(F.A.groups).toLowerCase(),titleSingular:e.formatMessage(F.A.group).toLowerCase(),ouiaId:"groups-table",pagination:ae,filterValue:oe,fetchData:({name:e,count:t,limit:r,offset:n})=>((0,V.G)(y,a,{name:e}),h({count:t,limit:r,offset:n,orderBy:ee,filters:{name:e}})),setFilterValue:({name:e=""})=>le(e),toolbarButtons:()=>[...S?[n().createElement(T.A,{to:L.A["add-group"].link,key:"add-group",className:"rbac-m-hide-on-sm"},n().createElement(c.Button,{ouiaId:"create-group-button",variant:"primary","aria-label":"Create group"},e.formatMessage(F.A.createGroup))),{label:e.formatMessage(F.A.createGroup),props:{className:"rbac-m-hide-on-md"},onClick:()=>a((0,T.o)(L.A["add-group"].link))},{label:e.formatMessage(F.A.edit),props:{isDisabled:!(1===J.length)},onClick:()=>a((0,T.o)(L.A["edit-group"].link.replace(":groupId",J[0].uuid)))},{label:e.formatMessage(F.A.delete),props:{isDisabled:!J.length>0},onClick:()=>{K(J),a((0,T.o)(L.A["remove-group"].link.replace(":groupId",J.map((({uuid:e})=>e)))))}}]:[]],isLoading:ne,filterPlaceholder:e.formatMessage(F.A.name).toLowerCase(),rowWrapper:q.A,tableId:"groups",textFilterRef:M}),n().createElement(r.Suspense,null,n().createElement(o.Outlet,{context:{pagination:ae,filters:re,[L.A["add-group"].path]:{orderBy:ee,postMethod:e=>{le(""),h(e)}},[L.A["edit-group"].path]:{postMethod:e=>{le(""),h({...e,orderBy:ee})},cancelRoute:(0,D.Fm)(L.A.groups.link,ae,re),submitRoute:(0,D.Fm)(L.A.groups.link,{...ae,offset:0},re)},[L.A["remove-group"].path]:{postMethod:(e,t)=>{h({...t,filters:{name:ue?"":oe},orderBy:ee}),ue&&le(""),z(J.filter((t=>!e.includes(t.uuid))))},cancelRoute:(0,D.Fm)(L.A.groups.link,ae,re),submitRoute:(0,D.Fm)(L.A.groups.link,{...ae,offset:0},ue?{}:re)}}})))))}}}]);