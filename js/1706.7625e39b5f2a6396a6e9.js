(self.webpackChunkrbac=self.webpackChunkrbac||[]).push([[1706],{66180:(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var s=i(28416),a=i.n(s),r=i(95376),n=i(58826),o=i.n(n);const l=({title:e,icon:t,description:i,actions:s,...n})=>a().createElement(r.EmptyState,{variant:r.EmptyStateVariant.sm,...n},a().createElement(r.EmptyStateHeader,{titleText:a().createElement(a().Fragment,null,e),icon:a().createElement(r.EmptyStateIcon,{icon:t||o()}),headingLevel:"h4"}),a().createElement(r.EmptyStateBody,{className:"pf-v5-u-mb-md"},i.map(((e,t)=>a().createElement(a().Fragment,{key:t},e," ",a().createElement("br",null))))),a().createElement(r.EmptyStateFooter,null,s))},97246:(e,t,i)=>{"use strict";i.d(t,{M:()=>R});var s=i(28416),a=i.n(s),r=i(25387),n=i(45697),o=i.n(n),l=i(2550),c=i(75863),p=i(21081),u=i(49004),m=i(34844),f=i(15433),d=i(31055),g=i(93297),h=i(95376),y=i(12849),b=i(47826),E=i.n(b),k=i(29301),F=i(68572),v=i(66180);const R=({isCompact:e,borders:t,columns:i,rows:n,toolbarButtons:o,data:b,actionResolver:R,areActionsDisabled:C,routes:S,titlePlural:M,titleSingular:D,pagination:Z,paginationProps:w,filterValue:B,isLoading:P,emptyFilters:O,setFilterValue:I,checkedRows:x,isSelectable:A,isRowSelectable:q,fetchData:T,setCheckedItems:V,emptyProps:L,filterPlaceholder:$,rowWrapper:W,filters:j,isFilterable:Y,onShowMore:N,showMoreTitle:H,onFilter:z,onChange:K,value:_,sortBy:Q,onSort:U,isExpandable:G,onExpand:J,hideFilterChips:X,hideHeader:ee,noData:te,noDataDescription:ie,ouiaId:se,tableId:ae,containerRef:re,textFilterRef:ne})=>{const oe=(0,r.YB)();return a().createElement(s.Fragment,null,S(),!P&&0===n?.length&&0===B?.length&&j.every((({value:e})=>!e))?a().createElement(v.Z,{title:oe.formatMessage(l.Z.configureItems,{items:M}),icon:E(),description:[oe.formatMessage(l.Z.toConfigureUserAccess),oe.formatMessage(l.Z.createAtLeastOneItem,{item:D})],actions:o()[0],...L}):(()=>{const r=`${"desc"===Q?.direction?"-":""}${i[Q?.index]?.key}`;return a().createElement(s.Fragment,null,a().createElement(F.ZP,{isSelectable:A,isRowSelectable:q,checkedRows:x,setCheckedItems:V,isLoading:P||te,data:b,titleSingular:D,filterValue:B,setFilterValue:I,sortBy:r,pagination:Z,paginationProps:w,fetchData:T,toolbarButtons:o,filterPlaceholder:$,filters:j,isFilterable:Y,onShowMore:N,showMoreTitle:H,onFilter:z,onChange:K,value:_,hideFilterChips:X,tableId:ae,containerRef:re,textFilterRef:ne}),P?a().createElement(y.Wi,{isCompact:e,items:Z?.limit}):a().createElement(p.i,{canSelectAll:!1,"aria-label":`${M.toLowerCase()} table`,variant:e?c.B.compact:null,borders:t,...A&&n?.length>0&&{onSelect:(e,t,i,{uuid:s,cells:[a],requires:r})=>V((0,k.ZQ)([{uuid:s,name:a,requires:r}],t))},...G&&{onExpand:J},rows:n?.length>0?n:[{fullWidth:!0,cells:[{title:a().createElement(v.Z,{title:oe.formatMessage(l.Z.noMatchingItemsFound,{items:M}),description:te&&ie?ie:[oe.formatMessage(l.Z.filterMatchesNoItems,{items:M}),oe.formatMessage(l.Z.tryChangingFilters)],actions:te&&ie?void 0:[a().createElement(h.EmptyStateActions,{key:"clear-filters"},a().createElement(d.Button,{variant:"link",ouiaId:"clear-filters-button",onClick:()=>{I(O),T({...Z,offset:0,...O||{name:""}})}},oe.formatMessage(l.Z.clearAllFilters)))]}),props:{colSpan:i.length}}]}],cells:i,...n?.length>0&&{actionResolver:R},className:0==n?.length?"ins-c-table-empty-state":"",areActionsDisabled:C,rowWrapper:W,sortBy:Q,ouiaId:se,onSort:(e,t,i,s)=>U(e,t,i,s)},!ee&&a().createElement(u.x,null),a().createElement(m.R,null)),!Z.noBottom&&a().createElement(f.Z,null,!P&&a().createElement(g.Pagination,{...(0,F.Wz)(Z,T,B,Q,w),variant:"bottom",dropDirection:"up"})))})())};R.propTypes={...F.ZP.propTypes,sortBy:o().shape({directions:o().string,index:o().number}),rowWrapper:o().any,isCompact:o().bool,isRowSelectable:o().func,borders:o().bool,emptyFilters:o().object,checkedRows:o().array,columns:o().array.isRequired,rows:o().array.isRequired,titlePlural:o().string,routes:o().func,actionResolver:o().func,areActionsDisabled:o().func,pagination:o().shape({noBottom:o().bool,limit:o().number,offset:o().number,count:o().number}),paginationProps:o().shape({toggleTemplate:o().func,isCompact:o().bool}),isExpandable:o().bool,onExpand:o().func,onSort:o().func,containerRef:o().node,noData:o().bool,hideFilterChips:o().bool,hideHeader:o().bool,noDataDescription:o().arrayOf(o().node),filters:o().array,tableId:o().string.isRequired},R.defaultProps={...F.ZP.defaultProps,emptyFilters:{},isCompact:!1,borders:!0,routes:()=>null,hideFilterChips:!1,checkedRows:[],hideHeader:!1}},68572:(e,t,i)=>{"use strict";i.d(t,{Wz:()=>f,ZP:()=>b});var s=i(28416),a=i.n(s),r=i(31611),n=i(25387),o=i(45697),l=i.n(o),c=i(2550),p=i(96486),u=i(29301),m=i(74982);const f=(e={},t,i="",s="",a)=>({...a,itemCount:e.count,perPage:e.limit,page:(0,m.wy)(e.limit,e.offset),onSetPage:(a,r)=>{t({...e,offset:(0,m.vE)(r,e.limit),name:i,orderBy:s})},perPageOptions:[{title:"5",value:5},{title:"10",value:10},{title:"20",value:20},{title:"50",value:50},{title:"100",value:100}],onPerPageSelect:(e,a)=>{t({offset:0,limit:a,name:i,orderBy:s})}}),d=(e,t=[],i=(()=>{}),s=[],a,r=(()=>!0))=>{const o=(0,n.YB)();return{count:t.length,items:[{title:o.formatMessage(c.Z.selectNone),onClick:()=>{i((()=>[]))}},{...!e&&s&&s.length>0?{title:o.formatMessage(c.Z.selectPage,{length:s.filter(r).length}),onClick:()=>{i((0,u.ZQ)(s,!0))}}:{}}],checked:(0,u.um)(s,t,r),onSelect:t=>{!e&&i((0,u.ZQ)(s,t))},id:a}},g=(e,t=(()=>{}),i=(()=>{}),s="",a={},r="",o,l,m,f,d,g,h,y,b,E,k)=>{const F=(0,n.YB)();return{onChange:y,value:b,items:[...m&&m.length>0?m.map((({key:r,label:n,value:o,selected:l,placeholder:y,type:b="text",groups:k,items:v,innerRef:R})=>({label:n||(0,u.RI)(r),type:b??"text",filterValues:{innerRef:R,id:`filter-by-${r}`,key:`filter-by-${r}`,placeholder:y||F.formatMessage(c.Z.filterByKey,{key:r}),value:o,selected:l,..."text"!==b?{isFilterable:f,onShowMore:d,showMoreTitle:g,onFilter:h}:{},groups:k,items:v,onChange:(e,n)=>{const o="string"==typeof n||Array.isArray(n)?n:Object.keys((0,p.pickBy)(n[""],(e=>e)));t({...s,...a,offset:0,[r]:o}),(0,u.Aq)((()=>i({...a,offset:0,orderBy:E,...m.reduce(((e,t)=>({...e,[t.key]:t.value})),{}),[r]:o}))).then((e=>(R?.current?.focus(),e)))},isDisabled:e}}))):[{label:(0,u.RI)(o||r),type:"text",filterValues:{innerRef:k,id:"filter-by-string",key:"filter-by-string",placeholder:F.formatMessage(c.Z.filterByKey,{key:o||r}),value:s,onChange:(e,s)=>{t({...a,offset:0,name:s}),(0,u.Aq)((()=>i({...a,offset:0,name:s,orderBy:E}))).then((e=>(k?.current?.focus(),e)))},isDisabled:e}}],...l||[]]}},h=(e="",t,i={},s=(()=>{}),a=(()=>{}),r)=>({filters:t&&t.length>0?t.map((({key:e,value:t})=>t&&0!==t.length&&{category:(0,u.RI)(e),type:e,chips:Array.isArray(t)?t.map((e=>({name:e}))):[{name:t}]})).filter(Boolean):[{name:e}],onDelete:(e,[n],o)=>{const l=(e,t,i)=>o?"group"===t||"checkbox"===t?[]:"":i!==n.type?e:"checkbox"===t||"group"===t?e.filter((e=>e!==n.chips[0]?.name)):Array.isArray(e)?[]:"",c=t.reduce(((e,{key:t,value:i,type:s})=>({...e,[t]:l(i,s,t)})),{});s({...i,offset:0,name:"",...c}),a({...i,offset:0,orderBy:r,name:"",...c})}}),y=({isSelectable:e,isRowSelectable:t,checkedRows:i,setCheckedItems:s,isLoading:n,data:o,titleSingular:l,filterValue:c,setFilterValue:p,pagination:u,paginationProps:m,fetchData:y,sortBy:b,toolbarButtons:E,filterPlaceholder:k,filterItems:F,filters:v,isFilterable:R,onShowMore:C,showMoreTitle:S,onFilter:M,onChange:D,value:Z,hideFilterChips:w,tableId:B,textFilterRef:P})=>a().createElement(r.Z,{...e&&{bulkSelect:d(n,i,s,o,B,t)},filterConfig:g(n,p,y,c,u,l,k,F,v,R,C,S,M,D,Z,b,P),actionsConfig:{actions:E()},...!n&&{pagination:f(u,y,c,b,m)},...(c.length>0||v&&v.length>0)&&!w&&{activeFiltersConfig:h(c,v,u,p,y,b)}});y.propTypes={isSelectable:l().bool,isRowSelectable:l().func,checkedRows:l().array,setCheckedItems:l().func,isLoading:l().bool,data:l().array,titleSingular:l().string,filterValue:l().oneOfType([l().array,l().string]),setFilterValue:l().func,filters:l().arrayOf(l().shape({value:l().oneOfType([l().string,l().number,l().array]),key:l().string,placeholder:l().string})),isFilterable:l().bool,onShowMore:l().func,showMoreTitle:l().string,onFilter:l().func,onChange:l().func,value:l().any,pagination:l().shape({limit:l().number,offset:l().number,count:l().number}),paginationProps:l().shape({toggleTemplate:l().func,isCompact:l().bool}),sortBy:l().string,filterItems:l().arrayOf(l().object),filterPlaceholder:l().string,isCollapsible:l().bool,fetchData:l().func.isRequired,toolbarButtons:l().func,hideFilterChips:l().bool,tableId:l().string,textFilterRef:l().object},y.defaultProps={isCollapsible:!1,isSelectable:!1,isLoading:!1,data:[],titleSingular:"",filterValue:[],pagination:m.he,setCheckedItems:()=>{},setFilterValue:()=>{},sortBy:void 0,toolbarButtons:()=>[],filterItems:[],filters:[],isFilterable:!1,hideFilterChips:!1};const b=y},23817:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>d});var s=i(31055),a=i(94229),r=i(28416),n=i.n(r),o=i(45697),l=i.n(o),c=i(97246),p=i(74982),u=i(25387),m=i(2550);const f=({isOpen:e,handleClose:t,permission:i,resourceDefinitions:o})=>{const l=(0,u.YB)(),[{rows:f,pagination:d,filterValue:g},h]=(0,r.useState)((()=>({filterValue:"",rows:o.map((({attributeFilter:{value:e}})=>e)).slice(0,p.he.limit),pagination:{...p.he,count:o.length}}))),y=({name:e="",limit:t,offset:i},s=!1)=>h((({pagination:a,filterValue:r})=>{const n=o.map((({attributeFilter:{value:e}})=>e)).filter((t=>t.includes(e))).slice(i,t);return{rows:n,filterValue:s?e:r,pagination:{...a,offset:s?0:i,limit:t,count:n.length}}}));return n().createElement(a.Modal,{actions:[n().createElement(s.Button,{key:"close-action",variant:"primary",onClick:t},l.formatMessage(m.Z.close))],variant:"large",isOpen:e,onClose:t,title:l.formatMessage(m.Z.resourceDefinitions),description:n().createElement(u._H,{...m.Z.viewResourceDefinitions,values:{strong:e=>n().createElement("strong",null,e),permission:i}})},n().createElement(c.M,{columns:[""],data:f,filterValue:g,setFilterValue:e=>y(e,!0),pagination:d,ouiaId:"resource-definition-table",noData:0===o.length,rows:f.map((e=>({cells:[e]}))),titlePlural:l.formatMessage(m.Z.resourceDefinitions),titleSingular:l.formatMessage(m.Z.resourceDefinition),noDataDescription:[l.formatMessage(m.Z.resourceDefinition,{permission:i})],fetchData:y,tableId:"resource-definitions-modal"}))};f.propTypes={isOpen:l().bool,handleClose:l().func.isRequired,permission:l().string.isRequired,resourceDefinitions:l().arrayOf(l().shape({attributeFilter:l().shape({value:l().string.isRequired}).isRequired})).isRequired};const d=f},93312:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>L});var s=i(28416),a=i.n(s),r=i(45697),n=i.n(r),o=i(65655),l=i(86706),c=i(71079);const p=(0,i(75465).TR)();async function u({limit:e,offset:t,username:i,application:s="",status:a,orderBy:r}){return await p.getPrincipalAccess(s,i,r,a,e,t)}var m=i(74982),f=i(97246),d=i(25387),g=i(2550);const h=({onClick:e,access:t})=>{const i=(0,d.YB)();return 0===t.resourceDefinitions.length?a().createElement("span",null,i.formatMessage(g.Z.notApplicable)):a().createElement("a",{onClick:()=>(e(),!1)},t.resourceDefinitions.length)};h.propTypes={onClick:n().func.isRequired,access:n().shape({resourceDefinitions:n().array.isRequired}).isRequired};const y=h,b=(e,t,i)=>e.reduce(((e,{permission:r,...n},o)=>{const[l,c,p]=r.split(":");return[...e,{cells:[l,c,p,...t?[a().createElement(s.Fragment,{key:"rd"},a().createElement(y,{onClick:()=>i(o),access:n}))]:[]]}]}),[]);var E=i(23817),k=i(7732);const F=({filters:e,setFilters:t,apps:i,hasActiveFilters:r,showResourceDefinitions:n})=>{const o=(0,d.YB)(),[{rdOpen:p,rdPermission:h,resourceDefinitions:y},F]=(0,s.useState)({rdOpen:!1}),{current:v}=(0,s.useRef)([{title:o.formatMessage(g.Z.application),key:"application",transforms:[k.p]},{title:o.formatMessage(g.Z.resourceType),key:"resource_type",transforms:[k.p]},{title:o.formatMessage(g.Z.operation),key:"verb",transforms:[k.p]},...n?[{title:o.formatMessage(g.Z.resourceDefinitions)}]:[]]),R=(0,l.useDispatch)(),{permissions:C,isLoading:S}=(0,l.useSelector)((e=>({permissions:e.accessReducer.access,isLoading:e.accessReducer.isLoading})),l.shallowEqual),M=({application:e,...t})=>{R((e=>({type:c.ft,payload:u(e)}))({application:(e?.length>0?e:i).join(","),...t}))};(0,s.useEffect)((()=>{M({...m.he,orderBy:w})}),[]);const[D,Z]=(0,s.useState)({index:0,direction:"asc"}),w=`${"desc"===D?.direction?"-":""}${v[D?.index].key}`,B=C?.data||[];return a().createElement(s.Fragment,null,a().createElement(f.M,{columns:v,rows:b(B,n,(e=>F({rdOpen:!0,rdPermission:C.data[e].permission,resourceDefinitions:C.data[e].resourceDefinitions}))),data:B,fetchData:M,sortBy:D,onSort:(t,i,s)=>{const a=`${"desc"===s?"-":""}${v[i].key}`;Z({index:i,direction:s}),M({...C?.meta,offset:0,orderBy:a,...e?.length>0?{...e.reduce(((e,t)=>({...e,[t.key]:t.value})),{})}:{name:"",application:[]}})},filters:e,setFilterValue:t,isLoading:S,pagination:C?.meta,ouiaId:"permissions-table",titlePlural:o.formatMessage(g.Z.permissions).toLowerCase(),titleSingular:o.formatMessage(g.Z.permission).toLowerCase(),noData:!S&&!r&&0===B.length,noDataDescription:[o.formatMessage(g.Z.noPermissionsForInsights),o.formatMessage(g.Z.contactOrgAdministrator)],tableId:"mua-access"}),a().createElement(s.Suspense,{fallback:a().createElement(s.Fragment,null)},p&&a().createElement(E.default,{resourceDefinitions:y,isOpen:p,handleClose:()=>F({rdOpen:!1}),permission:h})))};F.propTypes={filters:n().arrayOf(n().object).isRequired,setFilters:n().func.isRequired,apps:n().arrayOf(n().string).isRequired,hasActiveFilters:n().bool,showResourceDefinitions:n().bool};const v=F;var R=i(23279),C=i.n(R),S=i(13563),M=i(12849),D=i(56869),Z=i(1082),w=i(75863),B=i(21081),P=i(49004),O=i(34844);const I=(0,s.lazy)((()=>Promise.resolve().then(i.bind(i,23817)))),x=({filters:e,setFilters:t,apps:i,showResourceDefinitions:r})=>{const n=(0,d.YB)(),[o,c]=(0,s.useState)({}),[{rdOpen:p,rdPermission:u,resourceDefinitions:m},h]=(0,s.useState)({rdOpen:!1}),b=[{title:n.formatMessage(g.Z.roles),key:"display_name",transforms:[k.p]},n.formatMessage(g.Z.description),{title:n.formatMessage(g.Z.permissions),cellTransforms:[D.z,(0,Z.d)(20)]}],{roles:E,isLoading:F,rolesWithAccess:v}=(0,l.useSelector)((({roleReducer:{roles:e,isLoading:t,rolesWithAccess:i}})=>({roles:e,isLoading:t,rolesWithAccess:i})),l.shallowEqual),[R,x]=(0,s.useState)({index:0,direction:"asc"}),A=`${"desc"===R?.direction?"-":""}${b[R?.index].key}`,q=(0,l.useDispatch)();(0,s.useEffect)((()=>{q((0,S.vd)({limit:20,offset:0,orderBy:A,scope:"principal",application:i.join(",")}))}),[]);let T=(0,s.useCallback)(C()(((e,t,s,a,r,n)=>{const o=a?.length>0?a:i;return q((0,S.vd)({limit:e,offset:t,scope:"principal",orderBy:n,name:s,application:o.join(","),permission:r}))}),800),[]);return a().createElement(s.Fragment,null,a().createElement(f.M,{filters:e,columns:b,rows:(V=E.data,V?.reduce(((e,{uuid:t,display_name:i,name:l,description:c,accessCount:p},u)=>[...e,{uuid:t,cells:[{title:i||l,props:{component:"th",isOpen:!1}},{title:c,props:{isOpen:!1}},{title:p,props:{isOpen:2===o[t]}}]},{uuid:`${t}-groups`,parent:2*u,compoundParent:2,cells:[{props:{colSpan:4,className:"pf-m-no-padding"},title:v?.[t]?a().createElement(B.i,{ouiaId:"permissions-in-role-nested-table","aria-label":"Simple Table",borders:!1,variant:w.B.compact,cells:[n.formatMessage(g.Z.application),n.formatMessage(g.Z.resourceType),n.formatMessage(g.Z.operation),...r?[n.formatMessage(g.Z.resourceDefinitions)]:[]],rows:v[t].access.map((e=>({cells:[...e.permission.split(":"),...r?[a().createElement(s.Fragment,{key:"rd"},a().createElement(y,{onClick:()=>h({rdOpen:!0,rdPermission:e.permission,resourceDefinitions:e.resourceDefinitions}),access:e}))]:[]]})))},a().createElement(P.x,null),a().createElement(O.R,null)):a().createElement(M.Wi,null)}]}]),[])),data:E.data,isCompact:!1,isExpandable:!0,onExpand:(e,t,i,s,a)=>{s?c((e=>({...e,[a.uuid]:-1}))):(c((e=>({...e,[a.uuid]:i}))),2===i&&q((0,S.DV)(a.uuid)))},ouiaId:"roles-table",fetchData:({limit:e,offset:t,name:i,application:s,permission:a})=>{T(e,t,i,s,a,A)},sortBy:R,onSort:(t,i,s)=>{const a=`${"desc"===s?"-":""}${b[i].key}`;x({index:i,direction:s}),q((0,S.vd)({offset:0,orderBy:a,...e?.length>0?{...e.reduce(((e,t)=>({...e,[t.key]:t.value})),{})}:{name:"",application:[]}}))},emptyFilters:{name:"",application:[]},setFilterValue:t,isLoading:F,pagination:E.meta,filterPlaceholder:"role name",titlePlural:"roles",titleSingular:"role",tableId:"mua-roles"}),a().createElement(s.Suspense,{fallback:a().createElement(s.Fragment,null)},p&&a().createElement(I,{resourceDefinitions:m,isOpen:p,handleClose:()=>h({rdOpen:!1}),permission:u})));var V};x.propTypes={fetchRoles:n().func,fetchRoleForPrincipal:n().func,fetchUsers:n().func,roles:n().object,isLoading:n().bool,rolesWithAccess:n().object,filters:n().arrayOf(n().object).isRequired,setFilters:n().func.isRequired,apps:n().arrayOf(n().string).isRequired,showResourceDefinitions:n().bool};const A=x,q=({apps:e})=>{const t=(0,s.useContext)(o.Z),[i,r]=(0,s.useState)(""),[n,l]=(0,s.useState)(""),[c,p]=(0,s.useState)([]),u=({name:e,application:t,permission:i})=>{"string"==typeof e&&r(e),"string"==typeof i&&l(i),t&&p("string"==typeof t?[]:t)},m=(({apps:e,isOrgAdmin:t,name:i="",application:s=[]})=>{const a=(0,d.YB)();return[{key:"application",value:s,placeholder:a.formatMessage(g.Z.filterByKey,{key:a.formatMessage(g.Z.application).toLowerCase()}),type:"checkbox",items:e.map((e=>({label:e,value:e})))},...t?[{key:"name",type:"text",value:i,label:a.formatMessage(g.Z.roleName),placeholder:a.formatMessage(g.Z.filterByKey,{key:a.formatMessage(g.Z.roleName).toLowerCase()})}]:[]]})({apps:e,isOrgAdmin:t,name:i,application:c,permission:n});return t?a().createElement(A,{setFilters:u,filters:m,apps:e}):a().createElement(v,{setFilters:u,filters:m,apps:e,hasActiveFilters:i.length>0||c.length>0})};q.propTypes={apps:n().arrayOf(n().string).isRequired};const T=q,V=({apps:e})=>a().createElement(T,{apps:e});V.propTypes={apps:n().arrayOf(n().string).isRequired};const L=V},32857:()=>{},28992:()=>{},21626:()=>{},8572:()=>{},98379:()=>{},91993:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},87234:()=>{}}]);
//# sourceMappingURL=../sourcemaps/1706.80cffdfe59d8a945fcec4b18b2e7b1ee.js.map