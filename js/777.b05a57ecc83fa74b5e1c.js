(self.webpackChunkinsights_rbac_frontend=self.webpackChunkinsights_rbac_frontend||[]).push([[777],{58434:(e,t,n)=>{(t=n(23645)(!1)).push([e.id,".pf-c-form .pf-c-form__group .pf-c-radio{padding-bottom:8px}.pf-c-form .pf-c-form__group .pf-c-radio:last-child{padding-bottom:0px}.pf-c-select__menu .ins-c-select__scrollable-section{max-height:365px;overflow:auto}.ins-c-rbac-add-permission-title{display:block}.pf-c-wizard__main-body .ins-c-rbac-seleted-chips{padding-bottom:var(--pf-global--spacer--md)}.pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group{background-color:var(--pf-global--BackgroundColor--100)}.pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip{background-color:var(--pf-global--palette--blue-50);border-radius:var(--pf-global--BorderRadius--lg)}.pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip .pf-c-chip__text{font-size:var(--pf-global--FontSize--sm)}.pf-c-wizard__main-body .ins-c-rbac-seleted-chips .pf-c-chip-group .pf-c-chip-group__list .pf-c-chip-group__list-item .pf-c-chip::before{border-style:none}@media only screen and (max-width: 815px){.ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content{padding:0px}.ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:30em}}@media only screen and (max-width: 895px){.ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:32em}}@media only screen and (min-width: 992px){.ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content{padding:0px}.ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:25em}}@media only screen and (min-width: 1055px){.ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:32em}}@media only screen and (min-width: 1150px){.ins-c-rbac-permissions-table .ins-c-primary-toolbar .pf-c-toolbar__content .pf-c-toolbar__content-section .pf-m-filter-group{max-width:35em}}.ins-c-rbac-cost-resource-select .pf-c-select__menu .pf-c-select__menu-item:nth-child(3) .pf-c-check__input{display:none}.ins-c-rbac-cost-resource-select .pf-c-select__menu .pf-c-select__menu-item:nth-child(3) .pf-c-check__label{color:var(--pf-global--link--Color)}.ins-c-rbac-disabled-row{background-color:var(--pf-global--disabled-color--300)}\n",""]),e.exports=t},85901:(e,t,n)=>{(t=n(23645)(!1)).push([e.id,".ins-c-rbac__sticky .ins-c-rbac__sticky--title{margin-bottom:var(--pf-global--spacer--sm);border-bottom:1px solid var(--pf-global--palette--black-300)}.ins-c-rbac__sticky .ins-c-rbac__sticky--title .pf-l-grid__item{font-weight:var(--pf-global--FontWeight--bold);margin-bottom:var(--pf-global--spacer--sm) !important}.ins-c-rbac__sticky .ins-c-rbac__sticky--data{max-height:240px;overflow:auto;-ms-overflow-style:none;scrollbar-width:none}.ins-c-rbac__sticky .data::-webkit-scrollbar{display:none}.ins-c-rbac__gutter-sm{margin-bottom:var(--pf-global--spacer--sm)}.ins-c-rbac__gutter-md{margin-bottom:var(--pf-global--spacer--md)}\n",""]),e.exports=t},97310:(e,t,n)=>{(t=n(23645)(!1)).push([e.id,"@media only screen and (min-width: 769px){.ins-c-primary-toolbar__actions{display:none}}\n",""]),e.exports=t},80777:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ut});var r=n(59713),o=n.n(r),i=n(63038),a=n.n(i),c=n(80150),s=n.n(c),l=n(70983),u=n(47194),p=n(12460),d=n(47173),m=n(49739),f=n(83826),b=n(319),v=n.n(b),y=n(89478),g=function(e){return e.reduce((function(e,t){var n=t.uuid,r=t.display_name,o=t.name,i=t.description,a=t.system,l=t.accessCount,p=t.groups_in_count,d=t.modified;return[].concat(v()(e),[{uuid:n,system:a,cells:[s().createElement(c.Fragment,{key:"".concat(n,"-name")},s().createElement(u.Link,{to:"/roles/detail/".concat(n)},r||o)),i,s().createElement(c.Fragment,{key:"".concat(n,"-accessCount")},s().createElement(u.Link,{to:"/roles/detail/".concat(n)},l)),p,s().createElement(c.Fragment,{key:"".concat(n,"-modified")},s().createElement(y.t,{date:d,type:"relative"}))]}])}),[])},h=n(12830),E=n(89531),O=n(37671),_=n(17721),w=n(6479),j=n.n(w),P=n(67154),x=n.n(P),k=n(45697),R=n.n(k),S=n(71355),C=n(98917),D=n(81554),L=n(74837),F=n(77583),T=n(21899),q=n(26391),N=n(68340),M=n(68774),Z=n(60485),z=n(37377),A=n(58860),I=n(55795);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(66765);var B=function(e){var t,n,r,o=e.formFields,i=(0,A.Z)(),l=(0,c.useState)(i.getState().values["add-permissions-table"]||[]),u=a()(l,2),p=u[0],m=u[1],f=(null===(t=i.getState().values)||void 0===t||null===(n=t["copy-base-role"])||void 0===n||null===(r=n.applications)||void 0===r?void 0:r.filter((function(e){return!(null==p?void 0:p.find((function(t){return t.uuid.includes(e)})))})))||[],b=o[0][0];return s().createElement(s().Fragment,null,p.length>0?s().createElement("div",{className:"ins-c-rbac-seleted-chips"},s().createElement(q.Z,{categoryName:"Selected permissions"},p.reduce((function(e,t){return[t].concat(v()(e))}),[]).map((function(e){var t=e.uuid;return s().createElement(T.A,{key:t,color:"blue",isTruncated:!0,onClick:function(){return m(p.filter((function(e){return e.uuid!==t})))}},t)})))):null,s().createElement(Z.D,{headingLevel:"h1",size:"xl",className:"ins-c-rbac-add-permission-title"},"Add permissions"),s().createElement(M.D,null,s().createElement(N.x,null,"Select permissions to add to your role",0!==f.length&&s().createElement(z.J,{headerContent:"Custom roles only support granular permissions",bodyContent:"Wildcard permissions (for example, approval:*:*) aren’t included in this table and can’t be added to your custom role."},s().createElement(d.zx,{variant:"link"},"Why am I not seeing all of my permissions? ",s().createElement(I.ZP,null))))),[[W(W({},b),{},{props:W(W({},b.props),{},{selectedPermissions:p,setSelectedPermissions:m})})]])};B.propTypes={formFields:R().array};const H=B;var $=n(50008),Y=n.n($),J=n(27361),K=n.n(J),G=function(e){var t=e.nextStep,n=e.valid,r=e.handleNext,o=e.nextLabel,i=e.getState,a=e.handleSubmit,c=e.submitLabel;return s().createElement(d.zx,{variant:"primary",type:"button",isDisabled:!n||i().validating,onClick:function(){return t?r(function(e,t){var n,r;return(null===(n={string:e,function:e({values:t().values})})||void 0===n?void 0:n[Y()(e)])||(null===(r=e.stepMapper)||void 0===r?void 0:r[K()(t().values,e.when)])}(t,i)):a()}},t?o:c)};G.propTypes={nextStep:R().oneOfType([R().string,R().func,R().object]),handleSubmit:R().func.isRequired,submitLabel:R().node.isRequired,valid:R().bool,handleNext:R().func.isRequired,nextLabel:R().node.isRequired,getState:R().func.isRequired};var Q=function(e){var t=e.disableBack,n=e.handlePrev,r=e.nextStep,o=e.handleNext,i=e.buttonLabels,a=i.cancel,l=i.submit,u=i.back,p=i.next,m=(0,A.Z)(),f=(0,c.useContext)(ct),b=f.success,v=f.error,y=f.submitting;return b||void 0===v||v||y?null:s().createElement(c.Fragment,null,s().createElement(G,x()({},m,{handleNext:o,nextStep:r,nextLabel:p,submitLabel:l})),s().createElement(d.zx,{type:"button",variant:"secondary",isDisabled:t,onClick:n},u),s().createElement(d.zx,{type:"button",variant:"link",onClick:m.onCancel},a))};Q.propTypes={disableBack:R().bool,handlePrev:R().func.isRequired,handleNext:R().func.isRequired,nextStep:R().oneOfType([R().string,R().shape({when:R().string.isRequired,stepMapper:R().object.isRequired}),R().func]),buttonLabels:R().shape({submit:R().node.isRequired,cancel:R().node.isRequired,back:R().node.isRequired,next:R().node.isRequired}).isRequired};const U=Q;var X=n(52643),ee=n(2372),te=n(87757),ne=n.n(te),re=n(48926),oe=n.n(re),ie=n(45139),ae=n(39379),ce=function(){var e=oe()(ne().mark((function e(t){var n,r;return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.next=4,(0,ie.vd)({limit:10,offset:0,name:t,nameMatch:"exact"}).catch((function(e){console.error(e)}));case 4:if(!((null==(r=e.sent)||null===(n=r.data)||void 0===n?void 0:n.length)>0)){e.next=7;break}throw"Name has already been taken";case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=(0,ae.Z)(ce),le=function(e){var t=e.name,n=(0,A.Z)();return(0,c.useEffect)((function(){return setTimeout((function(){return n.change(t,"1")})),function(){return n.change(t,"")}}),[]),null},ue=(n(66963),n(9947)),pe=n(38424),de=n(75106),me=n(18004),fe=n(43047);const be=function(){var e=(0,c.useContext)(me.Z).jumpToStep,t=(0,c.useContext)(ct).setWizardError;return s().createElement(ue.u,{variant:ue.I.large},s().createElement(pe.k,{color:"red",icon:fe.ZP}),s().createElement(Z.D,{headingLevel:"h4",size:"lg"},"Role name already taken"),s().createElement(de.B,null,"Please return to Step 1: Create role and choose a unique role name for your custom role."),s().createElement(d.zx,{onClick:function(){t(void 0),e(0)},variant:"primary"},"Return to Step 1"))};function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge=function(e){var t,n=e.formFields,r=(0,c.useContext)(ct),o=r.submitting,i=r.error,a=r.setWizardError,l=(0,A.Z)().getState;return(0,c.useEffect)((function(){a(void 0),ce(l().values["role-name"]).then((function(){return a(!1)})).catch((function(){return a(!0)}))}),[]),void 0===i||o?s().createElement(X.b,null,s().createElement(ee.$,{size:"xl"})):!0===i?s().createElement(be,null):s().createElement(s().Fragment,null,s().createElement(Z.D,{headingLevel:"h1",size:"xl",className:"ins-c-rbac__gutter-sm"},"Review details"),s().createElement(M.D,{className:"ins-c-rbac__gutter-md"},s().createElement(N.x,null,"Review and confirm the details for your role, or click Back to revise.")),[[ye({},null==n||null===(t=n[0])||void 0===t?void 0:t[0])]])};ge.propTypes={formFields:R().array};const he=ge;var Ee=n(2485),Oe=n(35293),_e=n(68778);const we=function(){var e=(0,c.useContext)(ct).setHideForm;return s().createElement(ue.u,{variant:ue.I.large},s().createElement(pe.k,{color:"green",icon:_e.ZP}),s().createElement(Z.D,{headingLevel:"h4",size:"lg"},"You have successfully created a new role"),s().createElement(de.B,null),s().createElement(d.zx,{component:function(e){return s().createElement(u.Link,x()({to:"/roles"},e))},variant:"primary"},"Exit"),s().createElement(Oe.i,null,s().createElement(d.zx,{onClick:function(){e(!1)},variant:"link"},"Create another role"),s().createElement(d.zx,{component:function(e){return s().createElement(u.Link,x()({to:"/groups"},e))},variant:"link"},"Add role to group")))};var je=n(92504),Pe=n(43547),xe=n(8785),ke=["",{title:"Name",key:"display_name",transforms:[p.sortable]},"Description"],Re=function(e){var t=e.roleReducer,n=t.rolesForWizard,r=t.isLoading;return{roles:n.data,pagination:n.meta,isLoading:r}};var Se=n(18573),Ce=n.n(Se),De=n(55004),Le=n(84887),Fe=(0,n(63717).i$)();function Te(e){return qe.apply(this,arguments)}function qe(){return(qe=oe()(ne().mark((function e(t){return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe.getResourceTypes(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(e){return Me.apply(this,arguments)}function Me(){return(Me=oe()(ne().mark((function e(t){return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe.getResource(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ze=function(e){return{type:Le.s6,payload:Te(e)}},ze=function(e){return{type:Le.ZX,payload:Ne(e)}},Ae=n(35224),Ie=function(e){var t=e.row,n=j()(e,["row"]);return t.disableSelection?s().createElement(Ae.u,{content:s().createElement("div",null,"To add this permission to your role and define specific resources for it, at least one data source must be connected."," ",s().createElement("a",{href:"./settings/sources"},"Configure sources for Cost Management")),exitDelay:1500,entryDelay:1500},s().createElement(p.RowWrapper,x()({className:"ins-c-rbac-disabled-row",row:t},n))):s().createElement(p.RowWrapper,x()({row:t},n))};function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Ie.propTypes={props:R().object,row:R().object};var Be=["Application","Resource type","Operation"],He=function(e){var t=e.permissionReducer,n=t.permission,r=t.isLoading,o=t.options,i=o.application,a=o.operation,c=o.resource,s=t.expandSplats,l=t.isLoadingExpandSplats,u=e.roleReducer,p=u.isRecordLoading,d=u.selectedRole,m=e.costReducer.resourceTypes;return{permissions:n.data.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.application,n=e.resource_type,r=e.verb,o=e.permission;return{application:t,resource:n,operation:r,uuid:o}})),pagination:n.meta,isLoading:r||p,baseRole:d,applicationOptions:i.data.filter((function(e){return"*"!==e})),resourceOptions:c.data.filter((function(e){return"*"!==e})),operationOptions:a.data.filter((function(e){return"*"!==e})),expandedPermissions:s.data.map((function(e){return e.permission})),isLoadingExpandSplats:l,resourceTypes:m.data}},$e=function(e){var t=e.selectedPermissions,n=e.setSelectedPermissions,r=j()(e,["selectedPermissions","setSelectedPermissions"]),i=(0,l.useDispatch)(),u=function(e){return i((0,De.Hk)(e))},p=function(e){return i((0,De.Qi)(e))},d=(0,l.useSelector)(He,l.shallowEqual),m=d.permissions,f=d.isLoading,b=d.pagination,y=d.baseRole,g=d.applicationOptions,h=d.resourceOptions,O=d.operationOptions,w=d.expandedPermissions,P=d.isLoadingExpandSplats,k=d.resourceTypes,R=(0,xe.Z)(r).input,S=(0,A.Z)(),C=(0,c.useState)({applications:[],resources:[],operations:[]}),D=a()(C,2),L=D[0],F=D[1],T=S.getState().values["role-type"],q=(0,c.useState)(!1),N=a()(q,2),M=N[0],Z=N[1],z=(0,c.useState)(""),I=a()(z,2),V=I[0],W=I[1],B=(0,c.useState)(),H=a()(B,2),$=H[0],Y=H[1],J=function(e){return k.find((function(t){var n;return t.value===(null===(n=e.split(":"))||void 0===n?void 0:n[1])}))},K=(0,c.useCallback)(Ce()((function(e){var t=e.applications,n=e.resources,r=e.operations;return p({field:"application",limit:50,application:t.join(),resourceType:n.join(),verb:r.join()})}),3e3),[]),G=(0,c.useCallback)(Ce()((function(e){var t=e.applications,n=e.resources,r=e.operations;return p({field:"resource_type",limit:50,application:t.join(),resourceType:n.join(),verb:r.join()})}),3e3),[]),Q=(0,c.useCallback)(Ce()((function(e){var t=e.applications,n=e.resources,r=e.operations;return p({field:"verb",limit:50,application:t.join(),resourceType:n.join(),verb:r.join()})}),3e3),[]);(0,c.useEffect)((function(){var e,t=null===(e=S.getState().values["copy-base-role"])||void 0===e?void 0:e.uuid;return"copy"===T&&t&&i((0,E.fp)(t)),i(Ze()),S.change("has-cost-resources",!1),u(b),p({field:"application",limit:50}),p({field:"resource_type",limit:50}),p({field:"verb",limit:50}),function(){return i((0,De.AL)())}}),[]),(0,c.useEffect)((function(){G(L),Q(L)}),[L.applications]),(0,c.useEffect)((function(){K(L),Q(L)}),[L.resources]),(0,c.useEffect)((function(){K(L),G(L)}),[L.operations]),(0,c.useEffect)((function(){R.onChange(t)}),[t]),(0,c.useEffect)((function(){var e;if(!(!y||"copy"!==T||S.getState().values["base-permissions-loaded"]||t.length>0||(null===(e=S.getState().values["copy-base-role"])||void 0===e?void 0:e.uuid)!==(null==y?void 0:y.uuid)||P||f)){var r=(null==y?void 0:y.access)||[];if(0===w.length&&void 0===P){var o=v()(new Set(r.map((function(e){return e.permission.split(":")[0]}))));i((0,De.tL)({application:o.join()}))}else{var a=r.map((function(e){return e.permission.replace("*",".*")}));n((function(){return w.filter((function(e){return"cost-management"!==e.split(":")[0]||0!==(J(e)||{count:0}).count})).filter((function(e){return a.some((function(t){return e.match(t)}))})).map((function(e){return{uuid:e}}))})),S.change("base-permissions-loaded",!0)}}}),[m,y]);var U=function(e){return e.reduce((function(e,t){return{0:We(We({},null==e?void 0:e[0]),{},o()({},t,!0))}}),{0:{}})},X={applications:v()(g).filter((function(e){return e.includes(V)})).map((function(e){return{label:e,value:e}})),resources:v()(h).filter((function(e){return e.includes(V)})).map((function(e){return{label:e,value:e}})),operations:v()(O).filter((function(e){return e.includes(V)})).map((function(e){return{label:e,value:e}}))},ee={label:s().createElement("div",null," No results found"),isDisabled:!0},te=X[Object.keys(X)[$||0]].length>10;return s().createElement("div",{className:"ins-c-rbac-permissions-table"},s().createElement(_.M,x()({columns:Be,isSelectable:!0,isCompact:!0,borders:!1,createRows:function(e){return e.map((function(e){var n=e.application,r=e.resource,o=e.operation,i=e.uuid;return{uuid:"".concat(n,":").concat(r,":").concat(o),cells:[{title:n},r,o],selected:Boolean(t&&t.find((function(e){return e.uuid===i}))),disableSelection:"cost-management"===n&&0===(J(i)||{count:0}).count}}))},data:m,filterValue:"",noData:0===(null==m?void 0:m.length),noDataDescription:["Adjust your filters and try again. Note: Applications that only have wildcard           permissions (for example, patch:*:*) aren’t included in this table and can’t be           added to your custom role."],fetchData:function(e){var t=e.limit,n=e.offset,r=e.applications,o=e.resources,i=e.operations;u({limit:t,offset:n,application:(r||L.applications).join(),resourceType:(o||L.resources).join(),verb:(i||L.operations).join()})},setFilterValue:function(e){var t=e.applications,n=e.resources,r=e.operations;F(We(We(We(We({},L),t?{applications:t}:L.applications),n?{resources:n}:L.resources),r?{operations:r}:L.operations))},isLoading:f||P,pagination:We(We({},b),{},{count:b.count}),checkedRows:t,setCheckedItems:function(e){n(e(t).map((function(e){return{uuid:e.uuid}})))},titlePlural:"permissions",titleSingular:"permission",showMoreTitle:M?"See less":"See more",onFilter:function(e){return W(e)},onShowMore:te?function(){Z((function(){return!M}))}:void 0,onChange:function(e,t){W(""),Y(t)},value:$,filters:[{key:"applications",value:L.applications,placeholder:"Filter by application",type:"group",selected:U(L.applications),groups:[{type:X.applications.length>0?"checkbox":"plain",items:X.applications.length>0?v()(X.applications).slice(0,M?void 0:10):[ee]}]},{key:"resources",value:L.resources,placeholder:"Filter by resource type",type:"group",selected:U(L.resources),groups:[{type:X.resources.length>0?"checkbox":"plain",items:X.resources.length>0?v()(X.resources).slice(0,M?void 0:10):[ee]}]},{key:"operations",value:L.operations,placeholder:"Filter by operation",type:"group",selected:U(L.operations),groups:[{type:X.operations.length>0?"checkbox":"plain",items:X.operations.length>0?v()(X.operations).slice(0,M?void 0:10):[ee]}]}],isFilterable:!0,rowWrapper:Ie},r)))};$e.propTypes={selectedPermissions:R().array,setSelectedPermissions:R().func};const Ye=$e;var Je=n(50693),Ke=n(16475),Ge=function(e,t){return s().createElement("div",{className:"ins-c-rbac__sticky"},s().createElement(Je.r,{className:"ins-c-rbac__sticky--title"},e.map((function(t){return s().createElement(Ke.P,{span:12/e.length,key:t},t)}))),s().createElement(Je.r,{className:"ins-c-rbac__sticky--data"},t.map((function(t){return t.cells.map((function(t){return s().createElement(Ke.P,{span:12/e.length,key:t},t)}))}))))};var Qe=n(2644),Ue=n(92694),Xe=n(64403),et=n(59775);function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rt=function(e){var t=e.costReducer,n=t.resourceTypes,r=t.isLoading,o=t.loadingResources,i=t.resources;return{resourceTypes:n.data,resources:i,isLoading:r,isLoadingResources:o>0}},ot=function(e,t){var n=e[t.key];switch(t.type){case"toggle":return nt(nt({},e),{},o()({},t.key,nt(nt({},n),{},{isOpen:!n.isOpen})));case"select":return nt(nt({},e),{},o()({},t.key,nt(nt({},n),{},{selected:n.selected.includes(t.selection)?n.selected.filter((function(e){return e!==t.selection})):[].concat(v()(n.selected),[t.selection])})));case"selectAll":return nt(nt({},e),{},o()({},t.key,nt(nt({},n),{},{selected:n.options.map((function(e){return e.value}))})));case"clear":return nt(nt({},e),{},o()({},t.key,nt(nt({},n),{},{selected:[]})));case"setOptions":return nt(nt({},e),{},o()({},t.key,nt(nt({},n),{},{options:t.options,filteredOptions:t.options})));case"setFilter":return nt(nt({},e),{},o()({},t.key,nt(nt({},n),{},{filteredOptions:n.options.filter((function(e){return e.value.includes(t.filtervalue)}))})));default:return e}};function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function at(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ct=(0,c.createContext)({success:!1,submitting:!1,error:void 0}),st=function(e){return s().createElement(D.ZP,x()({},e,{showFormControls:!1}))},lt=function(e){var t=e.Content,n=j()(e,["Content"]);return s().createElement(t,n)};lt.propTypes={Content:R().elementType.isRequired};var ut={"base-role-table":function(e){var t=(0,l.useDispatch)(),n=function(e){return t((0,E.hs)(e))},r=(0,c.useState)(""),o=a()(r,2),i=o[0],u=o[1],p=(0,l.useSelector)(Re,l.shallowEqual),d=p.roles,m=p.pagination,f=(0,xe.Z)(e).input,b=(0,A.Z)();return(0,c.useEffect)((function(){n({limit:50,offset:0,itemCount:0,orderBy:"display_name"})}),[]),s().createElement("div",null,s().createElement(Pe.b,{variant:"info",isInline:!0,title:"Only granular permissions will be copied into a custom role         (for example, approval:requests:read). Wildcard permissions will not         be copied into a custom role (for example, approval:*:read).\n        "}),s().createElement(_.M,{columns:ke,createRows:function(e){return e.map((function(e){return{cells:[{title:s().createElement(je.Y,{id:"".concat(e.uuid,"-radio"),name:"".concat(e.name,"-radio"),"aria-label":"".concat(e.name,"-radio"),ouiaId:"".concat(e.name,"-radio"),value:e.uuid,isChecked:f.value.uuid===e.uuid,onChange:function(){b.batch((function(){f.onChange(e),b.change("role-copy-name","Copy of ".concat(e.display_name||e.name)),b.change("role-copy-description",e.description),b.change("add-permissions-table",[]),b.change("base-permissions-loaded",!1)}))}}),props:{className:"pf-c-table__check"}},e.display_name||e.name,e.description]}}))},data:d,fetchData:function(e){return n((0,h.jl)(e))},filterValue:i,setFilterValue:function(e){var t=e.name;return u(t)},isLoading:!1,pagination:m,titlePlural:"roles",titleSingular:"role",filterPlaceholder:"role name",ouiaId:"roles-table",isCompact:!0}))},"add-permissions-table":Ye,"cost-resources":function(e){var t=(0,l.useDispatch)(),n=(0,l.useSelector)(rt,l.shallowEqual),r=n.resourceTypes,i=n.isLoading,u=n.isLoadingResources,p=n.resources,d=(0,xe.Z)(e).input,m=(0,A.Z)(),f=m.getState().values["add-permissions-table"].filter((function(e){return e.uuid.split(":")[0].includes("cost-management")})),b=(0,c.useReducer)(ot,f.reduce((function(e,t){return nt(nt({},e),{},o()({},t.uuid,{selected:[],options:[],filteredOptions:[],isOpen:!1}))}),{})),y=a()(b,2),g=y[0],h=y[1];return(0,c.useEffect)((function(){(m.getState().values["resource-definitions"]||[]).map((function(e){var t=e.permission;return e.resources.map((function(e){return f.includes(t)&&h({type:"select",selection:e,key:t})}))})),t(Ze(undefined)),m.change("has-cost-resources",!0)}),[]),(0,c.useEffect)((function(){i||v()(new Set(f.map((function(e){var t;return null===(t=r.find((function(t){var n;return t.value===(null===(n=e.uuid.split(":"))||void 0===n?void 0:n[1])})))||void 0===t?void 0:t.path})))).filter((function(e){return e})).map((function(e){return t(ze(e))}))}),[r]),(0,c.useEffect)((function(){u||f.map((function(e){return h({type:"setOptions",key:e.uuid,options:p[(t=e.uuid,null===(n=r.find((function(e){var n;return e.value===(null===(n=t.split(":"))||void 0===n?void 0:n[1])})))||void 0===n||null===(o=n.path.split("/"))||void 0===o?void 0:o[5])]||[]});var t,n,o}))}),[u]),(0,c.useEffect)((function(){var e=Object.entries(g).map((function(e){var t=a()(e,2);return{permission:t[0],resources:t[1].selected}}));d.onChange(e),m.change("resource-definitions",e)}),[g]),s().createElement(Je.r,{hasGutter:!0},s().createElement(Ke.P,{md:4,className:"ins-m-hide-on-sm"},s().createElement(N.x,{component:N.q.h4,className:"ins-c-rbac__bold-text"},"Cost management permissions")),s().createElement(Ke.P,{md:8,className:"ins-m-hide-on-sm"},s().createElement(N.x,{component:N.q.h4,className:"ins-c-rbac__bold-text"},"Resource definitions")),f.map((function(e){var t=e.uuid,n=g[t].filteredOptions;return s().createElement(s().Fragment,null,s().createElement(Ke.P,{md:4,sm:12},s().createElement(et.c,{label:t,isRequired:!0})),s().createElement(Ke.P,{md:8,sm:12},s().createElement(Qe.P,{className:"ins-c-rbac-cost-resource-select",variant:Xe.TM.checkbox,typeAheadAriaLabel:"Select a state",onToggle:function(e){h({type:"setFilter",key:t,filtervalue:""}),function(e,t){h({type:"toggle",key:e,isOpen:t})}(t,e)},onSelect:function(e,r){!function(e,t,n,r){h(n?{type:"selectAll",selection:t,key:r}:{type:"select",selection:t,key:r})}(0,r,r==="Select All (".concat(n.length,")"),t)},onClear:function(){return h({type:"clear",key:t})},selections:g[t].selected,isOpen:g[t].isOpen,onFilter:function(e){return h({type:"setFilter",key:t,filtervalue:e.target.value})},"aria-labelledby":t,placeholderText:"Select resources",hasInlineFilter:!0},[s().createElement(Ue.$,{key:0,value:"Select All (".concat(n.length,")")})].concat(v()(n.map((function(e,t){return s().createElement(Ue.$,{key:t+1,value:e.value})})))))))})))},review:function(){var e=(0,A.Z)().getState().values,t=e["role-name"],n=e["role-description"],r=e["role-copy-name"],o=e["role-copy-description"],i=e["add-permissions-table"],a=e["resource-definitions"],c=e["has-cost-resources"],l=e["role-type"],u=i.map((function(e){return{cells:e.uuid.split(":")}})),p=(a||[]).map((function(e){return{cells:[e.permission,e.resources.join(", ")]}}));return s().createElement(s().Fragment,null,s().createElement(m.K,null,s().createElement(f.v,{className:"ins-c-rbac__summary"},s().createElement(Je.r,null,s().createElement(Ke.P,{sm:12,md:2},s().createElement(N.x,{component:N.q.h4,className:"ins-c-rbac__bold-text"},"Name")),s().createElement(Ke.P,{sm:12,md:10},s().createElement(N.x,{component:N.q.p},"create"===l?t:r))),s().createElement(Je.r,null,s().createElement(Ke.P,{sm:12,md:2},s().createElement(N.x,{component:N.q.h4,className:"ins-c-rbac__bold-text"},"Description")),s().createElement(Ke.P,{sm:12,md:10},s().createElement(N.x,{component:N.q.p},"create"===l?n:o))),s().createElement(Je.r,null,s().createElement(Ke.P,{sm:12,md:2},s().createElement(N.x,{component:N.q.h4,className:"ins-c-rbac__bold-text"},"Permissions")),s().createElement(Ke.P,{sm:12,md:10},Ge(["Application","Resource type","Operation"],u))),c&&s().createElement(Je.r,null,s().createElement(Ke.P,{sm:12,md:2},s().createElement(N.x,{component:N.q.h4,className:"ins-c-rbac__bold-text"},"Resource definitions")),s().createElement(Ke.P,{sm:12,md:10},Ge(["Permission","Resource definitions"],p))))))},description:lt,"type-selector":function(e){var t=(0,xe.Z)(e).input,n=(0,A.Z)(),r=(0,c.useState)(n.getState().values["role-type"]),o=a()(r,2),i=o[0],l=o[1],u=function(e){l(e),t.onChange(e),n.change("add-permissions-table",[]),n.change("base-permissions-loaded",!1)};return s().createElement("div",null,s().createElement(je.Y,{isChecked:"create"===i,name:"role-type-create",onChange:function(){return u("create")},label:"Create a role from scratch",id:"role-type-create",value:"create"}),s().createElement(je.Y,{isChecked:"copy"===i,name:"role-type-copy",onChange:function(){return u("copy")},label:"Copy an existing role",id:"role-type-copy",value:"copy"}))}},pt=function(e){var t=e.history.push,n=(0,l.useDispatch)(),r=(0,c.useState)({success:!1,submitting:!1,error:void 0,hideForm:!1}),o=a()(r,2),i=o[0],u=o[1],p=(0,c.useState)(!1),d=a()(p,2),m=d[0],f=d[1],b=(0,c.useRef)(document.createElement("div")),y=(0,c.useState)({}),g=a()(y,2),h=g[0],O=g[1];(0,c.useEffect)((function(){O(function(e){return{fields:[{component:"wizard",name:"wizzard",isDynamic:!0,inModal:!0,showTitles:!0,title:"Create role",container:e,fields:[{title:"Create role",name:"step-1",nextStep:{when:"role-type",stepMapper:{copy:"name-and-description",create:"add-permissions"}},fields:[{component:"type-selector",name:"role-type",isRequired:!0,validate:[{type:"required"}]},{component:"text-field",name:"role-name",type:"text",label:"Role name",isRequired:!0,condition:{when:"role-type",is:"create"},validate:[se,{type:"required"}]},{component:"text-field",name:"role-description",type:"text",label:"Role description",condition:{when:"role-type",is:"create"}},{component:"base-role-table",name:"copy-base-role",label:"Base role",isRequired:!0,condition:{when:"role-type",is:"copy"},validate:[{type:"required"}]},{condition:{when:"role-type",is:"create"},component:"description",name:"fixasyncvalidation",Content:le},{condition:{when:"role-type",is:"copy"},component:"description",name:"fixasyncvalidation2",Content:le}]},{title:"Name and description",name:"name-and-description",nextStep:"add-permissions",fields:[{component:"text-field",name:"role-copy-name",type:"text",label:"Role name",isRequired:!0,validate:[se,{type:"required"}]},{component:"text-field",name:"role-copy-description",type:"text",label:"Role description"}]},{name:"add-permissions",title:"Add permissions",StepTemplate:H,nextStep:function(e){var t=e.values;return t&&t["add-permissions-table"]&&t["add-permissions-table"].some((function(e){return e.uuid.split(":")[0].includes("cost-management")}))?"cost-resources-definition":"review"},fields:[{component:"add-permissions-table",name:"add-permissions-table"}]},{name:"cost-resources-definition",title:"Define Cost Management resources",nextStep:"review",fields:[{component:"plain-text",name:"text-description",label:s().createElement("p",null,"Specify where you would like to apply each cost permission selected in the previous step, using the dropdown below.")},{component:"cost-resources",name:"cost-resources",validate:[function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).every((function(e){return e.resources.length>0}))?void 0:"You need to assign at least one resource to each permission."}]}]},{name:"review",title:"Review details",buttons:U,StepTemplate:he,fields:[{component:"review",name:"review"}]}]}]}}(b.current))}),[]),(0,c.useEffect)((function(){b.current.hidden=m}),[m]);var _=function(){i.success||n((0,S.addNotification)({variant:"warning",title:"Creating role was canceled by the user",dismissDelay:8e3,dismissable:!1})),t("/roles")};return s().createElement(ct.Provider,{value:at(at({},i),{},{setWizardError:function(e){return u((function(t){return at(at({},t),{},{error:e})}))},setWizardSuccess:function(e){return u((function(t){return at(at({},t),{},{success:e})}))},setHideForm:function(e){return u((function(t){return at(at({},t),{},{hideForm:e})}))}})},s().createElement(Ee.R,{type:"role",isOpen:m,onModalCancel:function(){return f(!1)},onConfirmCancel:_}),i.hideForm?s().createElement(F.e,{title:"Create role",isOpen:!0,onClose:function(){return t("/roles")},steps:[{name:"success",component:s().createElement(we,null),isFinishedStep:!0}]}):s().createElement(C.Z,{schema:h,container:b,subscription:{values:!0},FormTemplate:st,componentMapper:at(at({},L.ZP),ut),onSubmit:function(e){var t=e["role-name"],r=e["role-description"],o=e["role-copy-name"],i=e["role-copy-description"],a=e["add-permissions-table"],c=e["cost-resources"],s=e["role-type"];u((function(e){return at(at({},e),{},{submitting:!0})}));var l={applications:v()(new Set(a.map((function(e){return e.uuid.split(":")[0]})))),description:("create"===s?r:i)||null,name:"create"===s?t:o,access:a.map((function(e){var t=e.uuid;return{permission:t,resourceDefinitions:(null==c?void 0:c.find((function(e){return e.permission===t})))?[{attributeFilter:{key:"cost-management.".concat(t.split(":")[1]),operation:"in",value:null==c?void 0:c.find((function(e){return e.permission===t})).resources}}]:[]}}))};return n((0,E.fA)(l)).then((function(){u((function(e){return at(at({},e),{},{submitting:!1,success:!0,hideForm:!0})})),n((0,E.Kt)())}))},onCancel:function(e){Boolean(e&&e["role-name"]||e["role-description"]||e["copy-base-role"])?f(!0):_()}}))};pt.propTypes={history:R().shape({push:R().func.isRequired}).isRequired};const dt=pt;var mt=n(60843),ft=n(31158),bt=n(93537),vt=n(60306),yt=n(95155),gt=(n(19510),n(6562)),ht=n(48140),Et=n(86050),Ot=function(e){return e.reduce((function(e,t){return[].concat(v()(e),[{cells:[t]}])}),[])},_t=n(84049),wt=n(55917),jt=n(71410),Pt=n(87242),xt=n(72389),kt=n(80236),Rt=n(44241);function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(86667);var Dt=function(e){var t=e.ModalProps,n=j()(e,["ModalProps"]),r=(0,A.Z)().getState().values;return s().createElement(Rt.Z,x()({},n,{ModalProps:Ct(Ct({},t),{},{onClose:function(){return t.onClose(r)}}),alert:r["dual-list-select"]?void 0:function(){return s().createElement("div",{className:"ins-m-resource-definitions"},s().createElement(Pe.b,{className:"pf-c-modal__alert",variant:"danger",isInline:!0,title:"At least one resource must be defined for this permission"}))}}))};Dt.propTypes={ModalProps:R().object};const Lt=Dt;var Ft=n(42348),Tt=n.n(Ft);function qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mt={changedResources:void 0,cancelWarningVisible:!1,resourcesPath:void 0,loadingStateVisible:!0};function Zt(e,t){switch(t.type){case"update":return Nt(Nt({},e),t.payload);default:throw new Error}}var zt=function(e,t,n){return{fields:[{component:Pt.Z.DUAL_LIST_SELECT,name:"dual-list-select",leftTitle:"Resources available for the permission",rightTitle:"Resources defined for the permission",filterOptionsTitle:"Filter by resource...",filterValueTitle:"Filter by resource...",options:v()(t&&e?n:[]),validate:[{type:"validate-resources"}]}]}},At={"validate-resources":function(){return function(e){return e&&e.length>0?void 0:"At least one resource must be defined for this permission"}}},It=function(e){var t=e.cancelRoute,n=(0,u.useRouteMatch)(vt._j.nu),r=(0,u.useRouteMatch)(n).params,o=r.permissionId,i=r.roleId,p=(0,u.useHistory)(),d=p.replace,m=p.push,f=(0,l.useDispatch)(),b=(0,c.useReducer)(Zt,Mt),y=a()(b,2),g=y[0],h=y[1],O=(0,l.useSelector)((function(e){var t;return{role:e.roleReducer.selectedRole,definedResources:(null===(t=e.roleReducer.selectedRole)||void 0===t?void 0:t.access)?Tt()(e.roleReducer.selectedRole.access.filter((function(e){return e.permission===o})).map((function(e){return e.resourceDefinitions.map((function(e){return e.attributeFilter.value}))}))):[],isRecordLoading:e.roleReducer.isRecordLoading}}),l.shallowEqual),_=O.definedResources,w=O.role,j=(0,l.useSelector)((function(e){return function(e,t){var n=e.costReducer,r=n.resourceTypes,o=n.isLoading,i=n.loadingResources,a=n.resources;return{resourceTypes:r.data,resources:a[t]?{resourcesPath:a[t]}:a,isLoading:o,isLoadingResources:i>0}}(e,g.resourcesPath)}),l.shallowEqual),P=j.resourceTypes,k=j.isLoading,R=j.isLoadingResources,S=j.resources;(0,c.useEffect)((function(){f(Ze())}),[o]),(0,c.useEffect)((function(){if(!k){var e,t=null===(e=P.find((function(e){var t;return e.value===(null===(t=o.split(":"))||void 0===t?void 0:t[1])})))||void 0===e?void 0:e.path;t&&(h({type:"update",payload:{resourcesPath:t.split("/")[5]}}),f(ze(t)))}}),[P]);var C=function(){return d(t)},D=function(e){e["dual-list-select"]===_?C():h({type:"update",payload:{changedResources:e["dual-list-select"],cancelWarningVisible:!0}})},F=function(e){return Object.entries(e).reduce((function(e,t){var n=a()(t,2),r=n[0],o=n[1];return[].concat(v()(e),v()(o.map((function(e){return{value:e.value,path:r,label:e.value}}))))}),[])}(S);return s().createElement(s().Fragment,null,s().createElement(Ee.R,{customTitle:"Exit edit resource definitions?",customDescription:"All changes will be lost.",isOpen:g.cancelWarningVisible,onModalCancel:function(){return h({type:"update",payload:{cancelWarningVisible:!1}})},onConfirmCancel:C}),(k||R)&&g.loadingStateVisible?s().createElement(kt.u,{className:"ins-m-resource-definitions",isOpen:!0,title:"Edit resource definitions",onClose:function(){h({type:"update",payload:{loadingStateVisible:!1}}),C()}},s().createElement(ee.$,null)):s().createElement(xt.Z,{schema:zt(S,g.resourcesPath,F),componentMapper:L.ZP,initialValues:{"dual-list-select":g.changedResources||_||[]},onSubmit:function(e){var n;h({type:"update",payload:{changedResources:e["dual-list-select"]}});var r={permission:o,resourceDefinitions:[{attributeFilter:{key:"cost-management.".concat(null===(n=o.split(":"))||void 0===n?void 0:n[1]),operation:1===e["dual-list-select"].length?"equal":"in",value:1===e["dual-list-select"].length?e["dual-list-select"][0]:e["dual-list-select"]}}]};f((0,E.ul)(i,Nt(Nt({},w),{},{access:[].concat(v()(w.access.filter((function(e){return e.permission!==o}))),[r])})),!0).then((function(){f((0,E.fp)(i)),m(t)}))},onCancel:function(e){return D(e)},validatorMapper:At,FormTemplate:function(e){return s().createElement(Lt,x()({},e,{ModalProps:{onClose:D,isOpen:!g.cancelWarningVisible,variant:"large",title:"Edit resource definitions",description:"Give or remove permissions to specific resources using the arrows below."}}))}}))};It.propTypes={routeMatch:R().string.isRequired,cancelRoute:R().string.isRequired,resources:R().array,resourcesPath:R().string};const Vt=It;var Wt=n(85564),Bt=n.n(Wt);function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Yt=function(){var e=(0,c.useState)({pagination:$t($t({},jt.he),{},{filter:""})}),t=a()(e,2),n=t[0],r=t[1],o=n.pagination,i=n.filter,p=(0,l.useDispatch)(),m=(0,u.useParams)(),f=m.roleId,b=m.permissionId,v=(0,l.useSelector)((function(e){var t;return{role:e.roleReducer.selectedRole,permission:e.roleReducer.selectedRole.access?$t({},null===(t=e.roleReducer.selectedRole)||void 0===t?void 0:t.access.find((function(e){return e.permission===b}))):{},isRecordLoading:e.roleReducer.isRecordLoading}}),l.shallowEqual),y=v.role,g=v.permission,h=v.isRecordLoading;(0,c.useEffect)((function(){p((0,E.fp)(f))}),[f]),(0,c.useEffect)((function(){r($t($t({},n),{},{pagination:$t($t({},n.pagination),{},{count:y.access?y.access.length:0})}))}),[y]);var w=g.resourceDefinitions?Bt()(g.resourceDefinitions.map((function(e){return e.attributeFilter.value}))).filter((function(e){return!i||e.includes(i)})):[];return s().createElement(c.Fragment,null,s().createElement(O.Q,{breadcrumbs:[{title:"Roles",to:"/roles"},{title:h?void 0:y&&(y.display_name||y.name),to:"/roles/detail/".concat(f)},{title:b,isActive:!0}]},s().createElement(ht.a,null,s().createElement(Et.Z,null,s().createElement(_t.PageHeaderTitle,{title:b||s().createElement(wt.h2,null),className:"ins-rbac-page-header__title"})))),s().createElement("section",{className:"pf-c-page__main-section ins-c-role__permissions"},s().createElement(M.D,null,s().createElement(N.x,{component:N.q.h1},"Defined resources")),s().createElement(_.M,{columns:[{}],createRows:Ot,data:w.slice(o.offset,o.offset+o.limit),filterValue:i,fetchData:function(e){var t=e.limit,o=e.offset,i=e.name;return r($t($t({},n),{},{filter:i,pagination:$t($t({},n.pagination),{},{limit:t,offset:o})}))},isCompact:!0,routes:function(){return s().createElement(c.Fragment,null,s().createElement(u.Route,{exact:!0,path:vt._j.nu},s().createElement(Vt,{cancelRoute:vt._j.T0.replace(":roleId",f).replace(":permissionId",b)})))},setFilterValue:function(e){var t=e.name;return r($t($t({},n),{},{filter:t}))},toolbarButtons:function(){return y.system?[]:[s().createElement(c.Fragment,{key:"edit-resource-definitions"},s().createElement(u.Link,{to:"/roles/detail/".concat(f,"/permission/").concat(b,"/edit")},s().createElement(d.zx,{variant:"primary","aria-label":"Edit"},"Edit")))]},isLoading:h,pagination:$t($t({},o),{},{count:w.length}),titlePlural:"resources",titleSingular:"resource",hideHeader:!0})))};function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gt=[{title:"Name",key:"display_name",transforms:[(0,p.cellWidth)(20),p.sortable]},{title:"Description"},{title:"Permissions",transforms:[p.nowrap]},{title:"Groups",transforms:[p.nowrap]},{title:"Last modified",key:"modified",transforms:[p.nowrap,p.sortable]}],Qt=function(e){var t=e.roleReducer,n=t.roles,r=t.isLoading;return{roles:n.data,pagination:n.meta,userIdentity:n.identity,isLoading:r}};const Ut=function(){var e=(0,c.useState)(""),t=a()(e,2),n=t[0],r=t[1],o=(0,l.useDispatch)(),i=(0,u.useHistory)().push,p=(0,l.useSelector)(Qt,l.shallowEqual),b=p.roles,v=p.isLoading,y=p.pagination,w=p.userIdentity,j=function(e){return o((0,E.Kt)(e))};(0,c.useEffect)((function(){insights.chrome.appNavClick({id:"roles",secondaryNav:!0}),j(Kt(Kt({},y),{},{name:n}))}),[]);var P=function(){return s().createElement(c.Fragment,null,s().createElement(u.Route,{exact:!0,path:vt._j.EM,component:dt}),s().createElement(u.Route,{exact:!0,path:vt._j.fV},!v&&s().createElement(mt.Z,{routeMatch:vt._j.fV,cancelRoute:vt._j.uJ,afterSubmit:function(){return j(Kt(Kt({},y),{},{name:n}))}})),s().createElement(u.Route,{exact:!0,path:vt._j.ld},!v&&s().createElement(yt.Z,{afterSubmit:function(){return j(Kt(Kt({},y),{},{name:n}))},routeMatch:vt._j.ld,cancelRoute:vt._j.uJ})))},x=function(e){return e.system?[]:[{title:"Edit",onClick:function(e,t,n){return i("/roles/edit/".concat(n.uuid))}},{title:"Delete",onClick:function(e,t,n){return i("/roles/remove/".concat(n.uuid))}}]},k=function(){var e,t;return[s().createElement(c.Fragment,{key:"add-role"},(null==w||null===(e=w.user)||void 0===e?void 0:e.is_org_admin)?s().createElement(u.Link,{to:vt._j.EM},s().createElement(d.zx,{ouiaId:"create-role-button",variant:"primary","aria-label":"Create role",className:"pf-m-visible-on-md"},"Create role")):s().createElement(c.Fragment,null)),(null==w||null===(t=w.user)||void 0===t?void 0:t.is_org_admin)?{label:"Create role",props:{className:"pf-m-hidden-on-md"},onClick:function(){i(vt._j.EM)}}:void 0].filter((function(e){return e}))};return s().createElement(u.Switch,null,s().createElement(gt.Z,{pageAction:"role-detail-permission",path:vt._j.T0},s().createElement(Yt,null)),s().createElement(gt.Z,{pageAction:"role-detail",path:vt._j.Fh},s().createElement(bt.Z,null)),s().createElement(gt.Z,{pageAction:"roles-list",path:vt._j.uJ,render:function(){return s().createElement(m.K,null,s().createElement(f.v,null,s().createElement(O.Q,null,s().createElement(O.y,{title:"Roles"}))),s().createElement(f.v,null,s().createElement(ft.$,{type:"content",id:"tab-roles"},s().createElement(_.M,{actionResolver:x,columns:Gt,createRows:g,data:b,filterValue:n,fetchData:function(e){return j((0,h.jl)(e))},setFilterValue:function(e){var t=e.name;return r(t)},isLoading:v,pagination:y,routes:P,ouiaId:"roles-table",titlePlural:"roles",titleSingular:"role",toolbarButtons:k,filterPlaceholder:"name"}))))}}))}},66765:(e,t,n)=>{var r=n(93379),o=n(58434);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.id,o,""]]);var i=r(o,{insert:"head",singleton:!1});if(!o.locals||e.hot.invalidate){var a=o.locals;e.hot.accept(58434,(function(){"string"==typeof(o=(o=n(58434)).__esModule?o.default:o)&&(o=[[e.id,o,""]]),function(e,t){if(!e&&t||e&&!t)return!1;var n;for(n in e)if(e[n]!==t[n])return!1;for(n in t)if(!e[n])return!1;return!0}(a,o.locals)?(a=o.locals,i(o)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=o.locals||{}},66963:(e,t,n)=>{var r=n(93379),o=n(85901);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.id,o,""]]);var i=r(o,{insert:"head",singleton:!1});if(!o.locals||e.hot.invalidate){var a=o.locals;e.hot.accept(85901,(function(){"string"==typeof(o=(o=n(85901)).__esModule?o.default:o)&&(o=[[e.id,o,""]]),function(e,t){if(!e&&t||e&&!t)return!1;var n;for(n in e)if(e[n]!==t[n])return!1;for(n in t)if(!e[n])return!1;return!0}(a,o.locals)?(a=o.locals,i(o)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=o.locals||{}},19510:(e,t,n)=>{var r=n(93379),o=n(97310);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.id,o,""]]);var i=r(o,{insert:"head",singleton:!1});if(!o.locals||e.hot.invalidate){var a=o.locals;e.hot.accept(97310,(function(){"string"==typeof(o=(o=n(97310)).__esModule?o.default:o)&&(o=[[e.id,o,""]]),function(e,t){if(!e&&t||e&&!t)return!1;var n;for(n in e)if(e[n]!==t[n])return!1;for(n in t)if(!e[n])return!1;return!0}(a,o.locals)?(a=o.locals,i(o)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=o.locals||{}}}]);
//# sourceMappingURL=777.b05a57ecc83fa74b5e1c.js.map