"use strict";(self.webpackChunkinsights_rbac_frontend=self.webpackChunkinsights_rbac_frontend||[]).push([[4750,7664],{40472:(e,t)=>{t.__esModule=!0,t.global_breakpoint_2xl={name:"--pf-global--breakpoint--2xl",value:"1450px",var:"var(--pf-global--breakpoint--2xl)"},t.default=t.global_breakpoint_2xl},92732:(e,t)=>{t.__esModule=!0,t.global_breakpoint_lg={name:"--pf-global--breakpoint--lg",value:"992px",var:"var(--pf-global--breakpoint--lg)"},t.default=t.global_breakpoint_lg},60144:(e,t)=>{t.__esModule=!0,t.global_breakpoint_sm={name:"--pf-global--breakpoint--sm",value:"576px",var:"var(--pf-global--breakpoint--sm)"},t.default=t.global_breakpoint_sm},63242:(e,t)=>{t.__esModule=!0,t.global_breakpoint_xl={name:"--pf-global--breakpoint--xl",value:"1200px",var:"var(--pf-global--breakpoint--xl)"},t.default=t.global_breakpoint_xl},79995:(e,t)=>{t.U6={name:"--pf-global--breakpoint--xs",value:"0",var:"var(--pf-global--breakpoint--xs)"},t.ZP=t.U6},62410:(e,t,n)=>{n.d(t,{Z:()=>y});var r=n(85893),a=n(92950),o=n.n(a),l=n(25864),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)},c=36e5,s=24*c,u=30*s,p=365*s,d=function(e,t){return"".concat(e," ").concat(e>1?"".concat(t,"s"):t," ago")},f=[{rightBound:1/0,description:function(e){return d(Math.round(e/p),"year")}},{rightBound:p,description:function(e){return d(Math.round(e/u),"month")}},{rightBound:u,description:function(e){return d(Math.round(e/s),"day")}},{rightBound:s,description:function(e){return d(Math.round(e/c),"hour")}},{rightBound:c,description:function(e){return d(Math.round(e/6e4),"minute")}},{rightBound:6e4,description:function(){return"Just now"}}],m=function(e){return e.toUTCString().split(",")[1].slice(0,-7).trim()},g=function(e){return{exact:function(e){return m(e)+" UTC"},onlyDate:function(e){return m(e).slice(0,-6)},relative:function(e){return f.reduce((function(t,n){return n.rightBound>Date.now()-e.getTime()?n.description(Date.now()-e.getTime()):t}),m(e))},invalid:function(){return"Invalid date"}}[e]},b=function(e,t,n){return{exact:function(t){return g(e)(t)},onlyDate:function(t){return g(e)(t)},relative:function(a){return function(e,t,n,a){return void 0===a&&(a=""),(0,r.jsx)(l.Tooltip,i({},n,{content:(0,r.jsxs)("div",{children:[a,e]})},{children:t}))}(g("exact")(a),(0,r.jsx)("span",{children:g(e)(a)}),t,n)},invalid:function(){return"Invalid date"}}[e]};const y=function(e){var t=e.date,n=e.type,a=void 0===n?"relative":n,l=e.extraTitle,i=e.tooltipProps,c=t instanceof Date?t:new Date(t),s=null==t||"Invalid Date"===c.toString()?"invalid":a;return(0,r.jsx)(o().Fragment,{children:b(s,i,l)(c)})}},39173:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(85893),a=n(94184),o=n.n(a),l=n(25864),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)};const c=function(e){var t=e.className,n=e.title,a=o()(t);return(0,r.jsx)(l.Title,i({headingLevel:"h1",size:"2xl",className:a,"widget-type":"InsightsPageHeaderTitle"},{children:n}))}},44873:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(85893),a=n(94184),o=n.n(a),l=function(){return l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},l.apply(this,arguments)};const i=function(e){var t,n=e.type,a=e.children,i=e.className,c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["type","children","className"]),s=o()(i,((t={})["ins-l-".concat(n)]=void 0!==n,t));return(0,r.jsxs)("section",l({},c,{className:s},{children:[" ",a," "]}))}},92758:(e,t,n)=>{n.d(t,{MS:()=>s,aX:()=>i,qF:()=>c});var r=n(93433),a=n(4942);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=new URLSearchParams(e.search),c=n.reduce((function(e,t){var n=i.getAll(t);return l(l({},e),{},(0,a.Z)({},t,n.length>1?n:n[0]))}),{});return Object.keys(o).forEach((function(e){var t=o[e];c=l(l({},c),{},(0,a.Z)({},e,Array.isArray(c[e])?(0,r.Z)(new Set([].concat((0,r.Z)(c[e]),(0,r.Z)(Array.isArray(t)?t:[t])))):(null==t?void 0:t.length)>0&&t||c[e])),Array.isArray(t)?t.forEach((function(t){return i.getAll(e).includes(t)||i.append(e,t)})):i.get(e)||t&&i.set(e,t)})),t({pathname:e.pathname,search:i.toString()},{replace:!0}),c},c=function(e,t){var n=new URLSearchParams(e.search);return t.some((function(e){return n.get(e)}))},s=function(e,t,n){var r=new URLSearchParams(e.search);Object.keys(n).forEach((function(e){return r.delete(e)})),Object.keys(n).forEach((function(e){var t=n[e];Array.isArray(t)?t.forEach((function(t){return t&&r.append(e,t)})):t&&r.set(e,t)})),t({pathname:e.pathname,search:r.toString()},{replace:!0})}},76137:(e,t,n)=>{n.d(t,{Z:()=>p});var r=n(92950),a=n.n(r),o=n(45697),l=n.n(o),i=n(46801),c=n(25864),s=n(19571),u=function(e){return e?a().createElement(c.Breadcrumb,null,Object.values(e).map((function(e,t){return e.title?a().createElement(c.BreadcrumbItem,{key:e.title,isActive:e.isActive},e.to&&a().createElement(i.NavLink,{end:!0,to:e.to},e.title)||e.title):a().createElement(s.Vj,{key:t})}))):null};u.propTypes={breadcrumbs:l().object};const p=u},51999:(e,t,n)=>{n.d(t,{Q:()=>y,y:()=>v});var r=n(92950),a=n.n(r),o=n(45697),l=n.n(o),i=n(25864),c=n(19571),s=n(76137),u=n(85893),p=n(94184),d=n.n(p);const f=a().createContext("light");var m=function(){return m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},m.apply(this,arguments)};const g=function(e){var t=e.className,n=e.children,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["className","children"]),a=d()(t,"pf-l-page-header","pf-c-page-header","pf-l-page__main-section","pf-c-page__main-section");return(0,u.jsx)(f.Consumer,{children:function(e){var t,o;void 0===e&&(e="light");var l=d()(((t={})["pf-m-".concat(e,"-200")]="dark"===e,t),((o={})["pf-m-light"]="light"===e,o));return(0,u.jsx)("section",m({},r,{className:"".concat(a," ").concat(l),"widget-type":"InsightsPageHeader"},{children:n}))}})};var b=n(39173),y=function(e){var t=e.children,n=e.breadcrumbs;return a().createElement(r.Fragment,null,n&&a().createElement("section",{className:"pf-c-page__main-breadcrumb"},a().createElement(s.Z,n)),a().createElement(g,{className:"rbac-page-header"},t))};y.propTypes={children:l().oneOfType([l().arrayOf(l().node),l().node]).isRequired,breadcrumbs:l().array,paddingBottom:l().bool},y.defaultProps={paddingBottom:!1};var v=function(e){var t=e.title,n=e.renderTitleTag,o=e.description,l=e.children;return a().createElement(r.Fragment,null,a().createElement(i.Flex,null,a().createElement(i.FlexItem,{className:"pf-u-mb-sm"},a().createElement(b.Z,{title:t||a().createElement(c.h2,null),className:"rbac-page-header__title"})),a().createElement(i.FlexItem,{alignSelf:{modifier:"alignSelfCenter"}},n&&n())),o&&a().createElement(i.TextContent,{className:"rbac-page-header__description"},"string"==typeof o?a().createElement(i.Text,{component:i.TextVariants.p},o):o),l)};v.propTypes={title:l().node,renderTitleTag:l().func,description:l().node,children:l().oneOfType([l().node,l().arrayOf(l().node)])}},52821:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var r=n(93433),a=n(4942),o=n(29439),l=n(92950),i=n.n(l),c=n(86896),s=n(50533),u=n(46801),p=n(1936),d=n(25864),f=n(79995),m=n(60144),g=n(78236),b=n(92732),y=n(63242),v=n(40472);const h={xs:parseInt(f.ZP.value.replace("px","")),sm:parseInt(m.default.value.replace("px","")),md:parseInt(g.default.value.replace("px","")),lg:parseInt(b.default.value.replace("px","")),xl:parseInt(y.default.value.replace("px","")),"2xl":parseInt(v.default.value.replace("px",""))},O=function(){for(var e,t=window.innerWidth,n=0,r=Object.entries(h);n<r.length;n++){var a=r[n],o=a[0];if(a[1]>=t)break;e=o}return e};var Z=n(55140),E=n(44873),k=n(62410),x=n(65126),_=n(11107),w=n(30893),j=n(4682),P=n(28090),S=n(51999),M=n(30060),T=n(26794),N=n(65916),I=n(92758),C=n(87462),B=n(45987),D=n(45697),L=n.n(D),R=n(94184),A=n.n(R),F=["className","row"],U=function(e){var t=e.className,n=e.row,r=(0,B.Z)(e,F);return i().createElement(p.RowWrapper,(0,C.Z)({className:A()(t,{"rbac-c-role-default":n.system}),row:n},r))};U.propTypes={row:L().shape({system:L().bool}),className:L().string};const V=U;function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const W=function(){var e,t,n,f,m,g=(0,l.useContext)(T.Z),b=g.orgAdmin,y=g.userAccessAdministrator,v=(0,l.useState)([]),C=(0,o.Z)(v,2),B=C[0],D=C[1],L=(0,c.Z)(),R=(0,s.useDispatch)(),A=(0,l.useRef)(null),F=(0,u.useNavigate)(),U=(0,u.useLocation)(),z=(t=(0,l.useState)((function(){return O()})),n=t[0],f=t[1],m=(0,l.useRef)(n),(0,l.useEffect)((function(){function e(){var e=O();e!==m.current&&(m.current=e,f(e))}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n),W=(0,Z.Z)(),q=(0,s.useSelector)((function(e){var t,n,r=e.roleReducer,a=r.roles,o=a.data,l=a.filters,i=a.pagination,c=r.isLoading;return{roles:o,filters:l,pagination:{limit:null!==(t=i.limit)&&void 0!==t?t:(b?N.HE:N.he).limit,offset:null!==(n=i.offset)&&void 0!==n?n:(b?N.HE:N.he).offset,count:i.count,redirected:i.redirected},isLoading:c}}),s.shallowEqual),G=q.roles,X=q.filters,Q=q.pagination,J=q.isLoading,K=[{title:L.formatMessage(w.Z.name),key:"display_name",transforms:[(0,p.cellWidth)(20),p.sortable]},{title:L.formatMessage(w.Z.description)},{title:L.formatMessage(w.Z.permissions),cellTransforms:[p.compoundExpand],transforms:[p.nowrap]},{title:L.formatMessage(w.Z.groups),cellTransforms:[p.compoundExpand],transforms:[p.nowrap]},{title:L.formatMessage(w.Z.lastModified),key:"modified",transforms:[p.nowrap,p.sortable]}],Y=function(e){return R((0,P.Kt)(H(H({},e),{},{usesMetaInURL:!0,chrome:W})))},$=b||y,ee=(0,l.useState)(X.display_name||""),te=(0,o.Z)(ee,2),ne=te[0],re=te[1],ae=(0,l.useState)({index:Number($),direction:"asc"}),oe=(0,o.Z)(ae,2),le=oe[0],ie=oe[1],ce=(0,l.useState)({}),se=(0,o.Z)(ce,2),ue=se[0],pe=se[1],de=(0,l.useState)([]),fe=(0,o.Z)(de,2),me=fe[0],ge=fe[1],be="".concat("desc"===(null==le?void 0:le.direction)?"-":"").concat(K[(null==le?void 0:le.index)-Number($)].key);(0,l.useEffect)((function(){(0,N.oG)(U,F,Q.limit,Q.offset)}),[Q.offset,Q.limit,Q.count,Q.redirected]),(0,l.useEffect)((function(){(0,I.MS)(U,F,{display_name:ne})}),[ne]),(0,l.useEffect)((function(){var e=(0,N.rj)(U,F,Q),t=e.limit,n=e.offset,r=(0,I.aX)(U,F,["display_name"],{display_name:ne}).display_name;re(r),W.appNavClick({id:"roles",secondaryNav:!0}),Y({limit:t,offset:n,orderBy:be,filters:{display_name:r}})}),[]),(0,l.useEffect)((function(){U.pathname.includes("detail")?(0,_.Gw)(U,F):((0,N.Zc)(U)||(0,N.oG)(U,F,Q.limit,Q.offset),(null==ne?void 0:ne.length)>0&&!(0,I.qF)(U,["display_name"])&&(0,I.aX)(U,F,["display_name"],{display_name:ne}))}),[U.pathname]);var ye=function(e,t,n,a){return e.reduce((function(e,c,s){var u,f=c.uuid,m=c.access,g=void 0===m?[]:m,b=c.display_name,y=c.name,v=c.description,h=c.system,O=c.accessCount,Z=c.groups_in_count,E=c.groups_in,P=c.modified;return[].concat((0,r.Z)(e),[{uuid:f,system:h,disableSelection:!!h,selected:Boolean(null==t||null===(u=t.find)||void 0===u?void 0:u.call(t,(function(e){return e.uuid===f}))),cells:[{title:i().createElement(x.Z,{to:j.Z["role-detail"].link.replace(":roleId",f)},b||y)},{title:v},{title:O,props:{isOpen:3===a[f]}},{title:Z,props:{isOpen:4===a[f]}},{title:i().createElement(k.Z,{date:P,type:(0,_.mh)(P)})}]},{uuid:"".concat(f,"-permissions"),parent:3*s,compoundParent:2,fullWidth:!0,noPadding:!0,cells:[{props:{colSpan:7,className:"pf-m-no-padding"},title:g.length>0?i().createElement(p.Table,{ouiaId:"groups-in-role-nested-table","aria-label":"Simple Table",variant:p.TableVariant.compact,cells:[n.formatMessage(w.Z.application),n.formatMessage(w.Z.resourceType),n.formatMessage(w.Z.operation),n.formatMessage(w.Z.lastCommit)],rows:g.map((function(e){var t=e.permission.split(":"),n=(0,o.Z)(t,3),r=n[0];return{cells:[r,n[1],n[2],i().createElement(l.Fragment,{key:"".concat(r,"-modified")},i().createElement(k.Z,{date:P,type:(0,_.mh)(P)}))]}}))},i().createElement(p.TableHeader,null),i().createElement(p.TableBody,null)):i().createElement(d.Text,{className:"pf-u-mx-lg pf-u-my-sm"},n.formatMessage(w.Z.noPermissions))}]},{uuid:"".concat(f,"-groups"),parent:3*s,compoundParent:3,fullWidth:!0,noPadding:!0,cells:[{props:{colSpan:7,className:"pf-m-no-padding"},title:Z>0?i().createElement(p.Table,{"aria-label":"Simple Table",ouiaId:"permissions-in-role-nested-table",variant:p.TableVariant.compact,cells:[n.formatMessage(w.Z.groupName),n.formatMessage(w.Z.description)],rows:E.map((function(e){return{cells:[e.name,e.description]}}))},i().createElement(p.TableHeader,null),i().createElement(p.TableBody,null)):i().createElement(d.Text,{className:"pf-u-mx-lg pf-u-my-sm"},n.formatMessage(w.Z.noGroups))}]}])}),[])}(G,B,L,ue),ve=Q.count===me.length;return i().createElement(d.Stack,{className:"rbac-c-roles"},i().createElement(d.StackItem,null,i().createElement(S.Q,null,i().createElement(S.y,{title:L.formatMessage(w.Z.roles)}))),i().createElement(d.StackItem,null,i().createElement(E.Z,{type:"content",id:"tab-roles"},i().createElement(M.M,{isSelectable:$,checkedRows:B,textFilterRef:A,setCheckedItems:function(e){D((function(t){return e(t).filter((function(e){var t=e.platform_default,n=e.admin_default,r=e.system;return!(t||n||r)})).map((function(e){return{uuid:e.uuid,label:e.name}}))}))},actionResolver:function(e){return e.compoundParent?[]:[{title:L.formatMessage(w.Z.edit),onClick:function(e,t,n){return F((0,x.n)(j.Z["edit-role"].link.replace(":roleId",n.uuid)))}},{title:L.formatMessage(w.Z.delete),onClick:function(e,t,n){ge([n]),F((0,x.n)(j.Z["remove-role"].link.replace(":roleId",n.uuid)))}}]},columns:K,areActionsDisabled:function(e){return!!e.system},rowWrapper:V,rows:ye,data:G,filterValue:ne,fetchData:function(e){var t=e.name,n=e.limit,r=e.offset,a=e.orderBy;return(0,I.MS)(U,F,{display_name:t}),Y((0,_.jl)({limit:n,offset:r,orderBy:a,filters:{display_name:t}}))},setFilterValue:function(e){var t=e.name;return re(void 0===t?"":t)},isExpandable:!0,onExpand:function(e,t,n,r,o){return pe(H(H({},ue),{},(0,a.Z)({},o.uuid,r?-1:n+Number(!$))))},isLoading:!J&&0===(null==G?void 0:G.length)&&0===(null==ne?void 0:ne.length)||J,pagination:Q,ouiaId:"roles-table",titlePlural:L.formatMessage(w.Z.roles).toLowerCase(),titleSingular:L.formatMessage(w.Z.role).toLowerCase(),toolbarButtons:function(){return b||y?[i().createElement(x.Z,{to:j.Z["add-role"].link,key:"add-role",className:"rbac-m-hide-on-sm"},i().createElement(d.Button,{ouiaId:"create-role-button",variant:"primary","aria-label":"Create role"},L.formatMessage(w.Z.createRole)))].concat((0,r.Z)(function(e){return(null==h?void 0:h[e])<=h.sm}(z)?[{label:L.formatMessage(w.Z.createRole),onClick:function(){return F((0,x.n)(j.Z["add-role"].link))}}]:[]),[{label:L.formatMessage(w.Z.edit),props:{isDisabled:!(1===B.length)},onClick:function(){return F((0,x.n)(j.Z["edit-role"].link.replace(":roleId",B[0].uuid)))}},{label:L.formatMessage(w.Z.delete),props:{isDisabled:!B.length>0},onClick:function(){ge(B),F((0,x.n)(j.Z["remove-role"].link.replace(":roleId",B.map((function(e){return e.uuid})))))}}]):[]},filterPlaceholder:L.formatMessage(w.Z.name).toLowerCase(),tableId:"roles",sortBy:le,onSort:function(e,t,n){var r="".concat("desc"===n?"-":"").concat(K[t-Number($)].key);ie({index:t,direction:n}),Y((0,_.jl)({limit:Q.limit,offset:0,orderBy:r,filters:{display_name:ne}}))}}),i().createElement(l.Suspense,null,i().createElement(u.Outlet,{context:(e={},(0,a.Z)(e,j.Z["add-role"].path,{pagination:Q,filters:{display_name:ne}}),(0,a.Z)(e,j.Z["remove-role"].path,{isLoading:J,cancelRoute:(0,_.zk)(j.Z.roles.link,Q,X),submitRoute:(0,_.zk)(j.Z.roles.link,ve?{}:X),afterSubmit:function(){Y(H(H({},Q),{},{filters:ve?{}:{display_name:ne},offset:0})),ve&&re(""),D([])},setFilterValue:re}),(0,a.Z)(e,j.Z["edit-role"].path,{isLoading:J,cancelRoute:(0,_.zk)(j.Z.roles.link,Q,X),afterSubmit:function(){Y(H(H({},Q),{},{offset:0,filters:{display_name:ne}})),D([])}}),e)})))))}}}]);