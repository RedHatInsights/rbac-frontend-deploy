(self.webpackChunkrbac=self.webpackChunkrbac||[]).push([[9282],{54073:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var i=a(44914),s=a.n(i),r=a(55086),o=a(31971),n=a.n(o);const l=({title:e,icon:t,description:a,actions:i,...o})=>s().createElement(r.EmptyState,{variant:r.EmptyStateVariant.sm,...o},s().createElement(r.EmptyStateHeader,{titleText:s().createElement(s().Fragment,null,e),icon:s().createElement(r.EmptyStateIcon,{icon:t||n()}),headingLevel:"h4"}),s().createElement(r.EmptyStateBody,{className:"pf-v5-u-mb-md"},a.map(((e,t)=>s().createElement(s().Fragment,{key:t},e," ",s().createElement("br",null))))),s().createElement(r.EmptyStateFooter,null,i))},38694:(e,t,a)=>{"use strict";a.d(t,{Z:()=>F});var i=a(44914),s=a.n(i),r=a(6442),o=a(5556),n=a.n(o),l=a(40335),c=a(74459),p=a(73683),u=a(4290),m=a(1104),f=a(97681),d=a(8549),g=a(47143),h=a(79994),y=a(58510),b=a(55086),A=a(31137),E=a.n(A),k=a(42134),v=a(23995),C=a(54073);const F=({className:e,isCompact:t,borders:a,columns:o,rows:n,toolbarButtons:A,data:F,actionResolver:S,areActionsDisabled:R,routes:w,titlePlural:D,titleSingular:M,pagination:B,paginationProps:P,filterValue:O,isLoading:x,emptyFilters:I,setFilterValue:q,checkedRows:L,isSelectable:T,isRowSelectable:V,fetchData:$,setCheckedItems:N,emptyProps:j,filterPlaceholder:W,rowWrapper:H,filters:X,isFilterable:K,onShowMore:Z,showMoreTitle:_,onFilter:U,onChange:z,value:G,sortBy:J,onSort:Q,isExpandable:Y,onExpand:ee,hideFilterChips:te,hideHeader:ae,noData:ie,noDataDescription:se,ouiaId:re,tableId:oe,containerRef:ne,textFilterRef:le,toolbarChildren:ce})=>{const pe=(0,r.A)(),ue=(0,c.useFlag)("platform.rbac.itless");return s().createElement("div",{className:e},w(),!x&&0===n?.length&&0===O?.length&&X.every((({value:e})=>!e))?s().createElement(C.A,{title:pe.formatMessage(l.A.configureItems,{items:D}),icon:E(),description:[pe.formatMessage(l.A.toConfigureUserAccess),pe.formatMessage(l.A.createAtLeastOneItem,{item:M})],actions:A()[0],...j}):(()=>{const e=`${"desc"===J?.direction?"-":""}${o[J?.index]?.key}`;return s().createElement(i.Fragment,null,s().createElement(v.Ay,{isSelectable:T,isRowSelectable:V,checkedRows:L,setCheckedItems:N,isLoading:x||ie,data:F,titleSingular:M,filterValue:O,setFilterValue:q,sortBy:e,pagination:B,paginationProps:P,fetchData:$,toolbarButtons:A,filterPlaceholder:W,filters:X,isFilterable:K,onShowMore:Z,showMoreTitle:_,onFilter:U,onChange:z,value:G,hideFilterChips:te,tableId:oe,containerRef:ne,textFilterRef:le,toolbarChildren:ce}),x?s().createElement(g.A,{variant:t?p.a.compact:void 0,rows:B?.limit,columns:o.map((e=>e.title))}):s().createElement(u.X,{canSelectAll:!1,"aria-label":`${D.toLowerCase()} table`,variant:t?p.a.compact:null,borders:a,...T&&n?.length>0&&{onSelect:(e,t,a,{uuid:i,cells:[s],requires:r})=>N((0,k.vH)([{uuid:i,name:s,requires:r,...ue&&{username:F[a]?.username}}],t))},...Y&&{onExpand:ee},rows:n?.length>0?n:[{fullWidth:!0,cells:[{title:s().createElement(C.A,{title:pe.formatMessage(l.A.noMatchingItemsFound,{items:D}),description:ie&&se?se:[pe.formatMessage(l.A.filterMatchesNoItems,{items:D}),pe.formatMessage(l.A.tryChangingFilters)],actions:ie&&se?void 0:[s().createElement(b.EmptyStateActions,{key:"clear-filters"},s().createElement(h.Button,{variant:"link",ouiaId:"clear-filters-button",onClick:()=>{q(I),$({...B,offset:0,...I||{name:""}})}},pe.formatMessage(l.A.clearAllFilters)))]}),props:{colSpan:o.length}}]}],cells:o,...n?.length>0&&{actionResolver:S},className:0==n?.length?"ins-c-table-empty-state":"",areActionsDisabled:R,rowWrapper:H,sortBy:J,ouiaId:re,onSort:(e,t,a,i)=>Q(e,t,a,i)},!ae&&s().createElement(m.A,null),s().createElement(f.B,null)),!B.noBottom&&s().createElement(d.A,null,!x&&s().createElement(y.Pagination,{...(0,v.WM)(B,$,O,J,P),variant:"bottom",dropDirection:"up"})))})())};F.propTypes={...v.Ay.propTypes,sortBy:n().shape({directions:n().string,index:n().number}),className:n().string,rowWrapper:n().any,isCompact:n().bool,isRowSelectable:n().func,borders:n().bool,emptyFilters:n().object,checkedRows:n().array,columns:n().array.isRequired,rows:n().array.isRequired,titlePlural:n().string,routes:n().func,actionResolver:n().func,areActionsDisabled:n().func,pagination:n().shape({noBottom:n().bool,limit:n().number,offset:n().number,count:n().number}),paginationProps:n().shape({toggleTemplate:n().func,isCompact:n().bool}),isExpandable:n().bool,onExpand:n().func,onSort:n().func,containerRef:n().node,noData:n().bool,hideFilterChips:n().bool,hideHeader:n().bool,noDataDescription:n().arrayOf(n().node),filters:n().array,tableId:n().string.isRequired,toolbarChildren:n().func},F.defaultProps={...v.Ay.defaultProps,emptyFilters:{},isCompact:!1,borders:!0,routes:()=>null,hideFilterChips:!1,checkedRows:[],hideHeader:!1,toolbarChildren:()=>null}},23995:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>b,WM:()=>f});var i=a(44914),s=a.n(i),r=a(45975),o=a(6442),n=a(5556),l=a.n(n),c=a(40335),p=a(2543),u=a(42134),m=a(61361);const f=(e={},t,a="",i="",s)=>({...s,itemCount:e.count,perPage:e.limit,page:(0,m.mq)(e.limit,e.offset),onSetPage:(s,r)=>{t({...e,offset:(0,m.gj)(r,e.limit),name:a,orderBy:i})},perPageOptions:[{title:"5",value:5},{title:"10",value:10},{title:"20",value:20},{title:"50",value:50},{title:"100",value:100}],onPerPageSelect:(e,s)=>{t({offset:0,limit:s,name:a,orderBy:i})}}),d=(e,t=[],a=()=>{},i=[],s,r=()=>!0)=>{const n=(0,o.A)();return{count:t.length,items:[{title:n.formatMessage(c.A.selectNone),onClick:()=>{a((()=>[]))}},{...!e&&i&&i.length>0?{title:n.formatMessage(c.A.selectPage,{length:i.filter(r).length}),onClick:()=>{a((0,u.vH)(i,!0))}}:{}}],checked:(0,u.A9)(i,t,r),onSelect:t=>{!e&&a((0,u.vH)(i,t))},id:s}},g=(e,t=()=>{},a=()=>{},i="",s={},r="",n,l,m,f,d,g,h,y,b,A,E)=>{const k=(0,o.A)();return{onChange:y,value:b,items:[...m&&m.length>0?m.map((({key:r,label:o,value:n,selected:l,placeholder:y,type:b="text",groups:E,items:v,innerRef:C})=>({label:o||(0,u.tt)(r),type:b??"text",filterValues:{innerRef:C,id:`filter-by-${r}`,key:`filter-by-${r}`,placeholder:y||k.formatMessage(c.A.filterByKey,{key:r}),value:n,selected:l,..."text"!==b?{isFilterable:f,onShowMore:d,showMoreTitle:g,onFilter:h}:{},groups:E,items:v,onChange:(e,o)=>{const n="string"==typeof o||Array.isArray(o)?o:Object.keys((0,p.pickBy)(o[""],(e=>e)));t({...i,...s,offset:0,[r]:n}),(0,u.sq)((()=>a({...s,offset:0,orderBy:A,...m.reduce(((e,t)=>({...e,[t.key]:t.value})),{}),[r]:n}))).then((e=>(C?.current?.focus(),e)))},isDisabled:e}}))):[{label:(0,u.tt)(n||r),type:"text",filterValues:{innerRef:E,id:"filter-by-string",key:"filter-by-string",placeholder:k.formatMessage(c.A.filterByKey,{key:n||r}),value:i,onChange:(e,i)=>{t({...s,offset:0,name:i}),(0,u.sq)((()=>a({...s,offset:0,name:i,orderBy:A}))).then((e=>(E?.current?.focus(),e)))},isDisabled:e}}],...l||[]]}},h=(e="",t,a={},i=()=>{},s=()=>{},r)=>({filters:t&&t.length>0?t.map((({key:e,value:t})=>t&&0!==t.length&&{category:(0,u.tt)(e),type:e,chips:Array.isArray(t)?t.map((e=>({name:e}))):[{name:t}]})).filter(Boolean):[{name:e}],onDelete:(e,[o],n)=>{const l=(e,t,a)=>n?"group"===t||"checkbox"===t?[]:"":a!==o.type?e:"checkbox"===t||"group"===t?e.filter((e=>e!==o.chips[0]?.name)):Array.isArray(e)?[]:"",c=t.reduce(((e,{key:t,value:a,type:i})=>({...e,[t]:l(a,i,t)})),{});i({...a,offset:0,name:"",...c}),s({...a,offset:0,orderBy:r,name:"",...c})}}),y=({isSelectable:e,isRowSelectable:t,checkedRows:a,setCheckedItems:i,isLoading:o,data:n,titleSingular:l,filterValue:c,setFilterValue:p,pagination:u,paginationProps:m,fetchData:y,sortBy:b,toolbarButtons:A,filterPlaceholder:E,filterItems:k,filters:v,isFilterable:C,onShowMore:F,showMoreTitle:S,onFilter:R,onChange:w,value:D,hideFilterChips:M,tableId:B,textFilterRef:P,toolbarChildren:O})=>s().createElement(r.A,{...e&&{bulkSelect:d(o,a,i,n,B,t)},filterConfig:g(o,p,y,c,u,l,E,k,v,C,F,S,R,w,D,b,P),actionsConfig:{actions:A()},...!o&&{pagination:f(u,y,c,b,m)},...(c.length>0||v&&v.length>0)&&!M&&{activeFiltersConfig:h(c,v,u,p,y,b)}},O());y.propTypes={isSelectable:l().bool,isRowSelectable:l().func,checkedRows:l().array,setCheckedItems:l().func,isLoading:l().bool,data:l().array,titleSingular:l().string,filterValue:l().oneOfType([l().array,l().string]),setFilterValue:l().func,filters:l().arrayOf(l().shape({value:l().oneOfType([l().string,l().number,l().array]),key:l().string,placeholder:l().string})),isFilterable:l().bool,onShowMore:l().func,showMoreTitle:l().string,onFilter:l().func,onChange:l().func,value:l().any,pagination:l().shape({limit:l().number,offset:l().number,count:l().number}),paginationProps:l().shape({toggleTemplate:l().func,isCompact:l().bool}),sortBy:l().string,filterItems:l().arrayOf(l().object),filterPlaceholder:l().string,isCollapsible:l().bool,fetchData:l().func.isRequired,toolbarButtons:l().func,hideFilterChips:l().bool,tableId:l().string,textFilterRef:l().object,toolbarChildren:l().func},y.defaultProps={isCollapsible:!1,isSelectable:!1,isLoading:!1,data:[],titleSingular:"",filterValue:[],pagination:m.L6,setCheckedItems:()=>{},setFilterValue:()=>{},sortBy:void 0,toolbarButtons:()=>[],filterItems:[],filters:[],isFilterable:!1,hideFilterChips:!1,toolbarChildren:()=>null};const b=y},61107:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var i=a(79994),s=a(20380),r=a(44914),o=a.n(r),n=a(5556),l=a.n(n),c=a(38694),p=a(61361),u=a(6442),m=a(58065),f=a(40335);const d=({isOpen:e,handleClose:t,permission:a,resourceDefinitions:n})=>{const l=(0,u.A)(),[{rows:d,pagination:g,filterValue:h},y]=(0,r.useState)((()=>({filterValue:"",rows:n.map((({attributeFilter:{value:e}})=>e)).slice(0,p.L6.limit),pagination:{...p.L6,count:n.length}}))),b=({name:e="",limit:t,offset:a},i=!1)=>y((({pagination:s,filterValue:r})=>{const o=n.map((({attributeFilter:{value:e}})=>e)).filter((t=>t.includes(e))).slice(a,t);return{rows:o,filterValue:i?e:r,pagination:{...s,offset:i?0:a,limit:t,count:o.length}}}));return o().createElement(s.Modal,{actions:[o().createElement(i.Button,{key:"close-action",variant:"primary",onClick:t},l.formatMessage(f.A.close))],variant:"large",isOpen:e,onClose:t,title:l.formatMessage(f.A.resourceDefinitions),description:o().createElement(m.A,{...f.A.viewResourceDefinitions,values:{strong:e=>o().createElement("strong",null,e),permission:a}})},o().createElement(c.Z,{columns:[""],data:d,filterValue:h,setFilterValue:e=>b(e,!0),pagination:g,ouiaId:"resource-definition-table",noData:0===n.length,rows:d.map((e=>({cells:[e]}))),titlePlural:l.formatMessage(f.A.resourceDefinitions),titleSingular:l.formatMessage(f.A.resourceDefinition),noDataDescription:[l.formatMessage(f.A.resourceDefinition,{permission:a})],fetchData:b,tableId:"resource-definitions-modal"}))};d.propTypes={isOpen:l().bool,handleClose:l().func.isRequired,permission:l().string.isRequired,resourceDefinitions:l().arrayOf(l().shape({attributeFilter:l().shape({value:l().string.isRequired}).isRequired})).isRequired};const g=d},34879:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>$});var i=a(44914),s=a.n(i),r=a(5556),o=a.n(r),n=a(85718),l=a(69733),c=a(71966);const p=(0,a(19872).lF)();async function u({limit:e,offset:t,username:a,application:i="",status:s,orderBy:r}){return await p.getPrincipalAccess(i,a,r,s,e,t)}var m=a(61361),f=a(38694),d=a(6442),g=a(40335);const h=({onClick:e,access:t})=>{const a=(0,d.A)();return 0===t.resourceDefinitions.length?s().createElement("span",null,a.formatMessage(g.A.notApplicable)):s().createElement("a",{onClick:()=>(e(),!1)},t.resourceDefinitions.length)};h.propTypes={onClick:o().func.isRequired,access:o().shape({resourceDefinitions:o().array.isRequired}).isRequired};const y=h,b=(e,t,a)=>e.reduce(((e,{permission:r,...o},n)=>{const[l,c,p]=r.split(":");return[...e,{cells:[l,c,p,...t?[s().createElement(i.Fragment,{key:"rd"},s().createElement(y,{onClick:()=>a(n),access:o}))]:[]]}]}),[]);var A=a(61107),E=a(73317);const k=({filters:e,setFilters:t,apps:a,hasActiveFilters:r,showResourceDefinitions:o})=>{const n=(0,d.A)(),[{rdOpen:p,rdPermission:h,resourceDefinitions:y},k]=(0,i.useState)({rdOpen:!1}),{current:v}=(0,i.useRef)([{title:n.formatMessage(g.A.application),key:"application",transforms:[E.X]},{title:n.formatMessage(g.A.resourceType),key:"resource_type",transforms:[E.X]},{title:n.formatMessage(g.A.operation),key:"verb",transforms:[E.X]},...o?[{title:n.formatMessage(g.A.resourceDefinitions)}]:[]]),C=(0,l.useDispatch)(),{permissions:F,isLoading:S}=(0,l.useSelector)((e=>({permissions:e.accessReducer.access,isLoading:e.accessReducer.isLoading})),l.shallowEqual),R=({application:e,...t})=>{C((e=>({type:c.LR,payload:u(e)}))({application:(e?.length>0?e:a).join(","),...t}))};(0,i.useEffect)((()=>{R({...m.L6,orderBy:M})}),[]);const[w,D]=(0,i.useState)({index:0,direction:"asc"}),M=`${"desc"===w?.direction?"-":""}${v[w?.index].key}`,B=F?.data||[];return s().createElement(i.Fragment,null,s().createElement(f.Z,{columns:v,rows:b(B,o,(e=>k({rdOpen:!0,rdPermission:F.data[e].permission,resourceDefinitions:F.data[e].resourceDefinitions}))),data:B,fetchData:R,sortBy:w,onSort:(t,a,i)=>{const s=`${"desc"===i?"-":""}${v[a].key}`;D({index:a,direction:i}),R({...F?.meta,offset:0,orderBy:s,...e?.length>0?{...e.reduce(((e,t)=>({...e,[t.key]:t.value})),{})}:{name:"",application:[]}})},filters:e,setFilterValue:t,isLoading:S,pagination:F?.meta,ouiaId:"permissions-table",titlePlural:n.formatMessage(g.A.permissions).toLowerCase(),titleSingular:n.formatMessage(g.A.permission).toLowerCase(),noData:!S&&!r&&0===B.length,noDataDescription:[n.formatMessage(g.A.noPermissionsForInsights),n.formatMessage(g.A.contactOrgAdministrator)],tableId:"mua-access"}),s().createElement(i.Suspense,{fallback:s().createElement(i.Fragment,null)},p&&s().createElement(A.default,{resourceDefinitions:y,isOpen:p,handleClose:()=>k({rdOpen:!1}),permission:h})))};k.propTypes={filters:o().arrayOf(o().object).isRequired,setFilters:o().func.isRequired,apps:o().arrayOf(o().string).isRequired,hasActiveFilters:o().bool,showResourceDefinitions:o().bool};const v=k;var C=a(38221),F=a.n(C),S=a(47143),R=a(8582),w=a(99608),D=a(35725),M=a(73683),B=a(4290),P=a(1104),O=a(97681);const x=(0,i.lazy)((()=>Promise.resolve().then(a.bind(a,61107)))),I=({filters:e,setFilters:t,apps:a,showResourceDefinitions:r})=>{const o=(0,d.A)(),[n,c]=(0,i.useState)({}),[{rdOpen:p,rdPermission:u,resourceDefinitions:m},h]=(0,i.useState)({rdOpen:!1}),b=[{title:o.formatMessage(g.A.roles),key:"display_name",transforms:[E.X]},{title:o.formatMessage(g.A.description)},{title:o.formatMessage(g.A.permissions),cellTransforms:[w.w,(0,D.B)(20)]}],A=[o.formatMessage(g.A.application),o.formatMessage(g.A.resourceType),o.formatMessage(g.A.operation),...r?[o.formatMessage(g.A.resourceDefinitions)]:[]],{roles:k,isLoading:v,rolesWithAccess:C}=(0,l.useSelector)((({roleReducer:{roles:e,isLoading:t,rolesWithAccess:a}})=>({roles:e,isLoading:t,rolesWithAccess:a})),l.shallowEqual),[I,q]=(0,i.useState)({index:0,direction:"asc"}),L=`${"desc"===I?.direction?"-":""}${b[I?.index].key}`,T=(0,l.useDispatch)();(0,i.useEffect)((()=>{T((0,R.kN)({limit:20,offset:0,orderBy:L,scope:"principal",application:a.join(",")}))}),[]);let V=(0,i.useCallback)(F()(((e,t,i,s,r,o)=>{const n=s?.length>0?s:a;return T((0,R.kN)({limit:e,offset:t,scope:"principal",orderBy:o,name:i,application:n.join(","),permission:r}))}),800),[]);return s().createElement(i.Fragment,null,s().createElement(f.Z,{filters:e,columns:b,rows:($=k.data,$?.reduce(((e,{uuid:t,display_name:a,name:o,description:l,accessCount:c},p)=>[...e,{uuid:t,cells:[{title:a||o,props:{component:"th",isOpen:!1}},{title:l,props:{isOpen:!1}},{title:c,props:{isOpen:2===n[t]}}]},{uuid:`${t}-groups`,parent:2*p,compoundParent:2,cells:[{props:{colSpan:4,className:"pf-m-no-padding"},title:C?.[t]?s().createElement(B.X,{ouiaId:"permissions-in-role-nested-table","aria-label":"Simple Table",borders:!1,variant:M.a.compact,cells:A,rows:C[t].access.map((e=>({cells:[...e.permission.split(":"),...r?[s().createElement(i.Fragment,{key:"rd"},s().createElement(y,{onClick:()=>h({rdOpen:!0,rdPermission:e.permission,resourceDefinitions:e.resourceDefinitions}),access:e}))]:[]]})))},s().createElement(P.A,null),s().createElement(O.B,null)):s().createElement(S.A,{columns:A,rows:c,variant:M.a.compact})}]}]),[])),data:k.data,isCompact:!1,isExpandable:!0,onExpand:(e,t,a,i,s)=>{i?c((e=>({...e,[s.uuid]:-1}))):(c((e=>({...e,[s.uuid]:a}))),2===a&&T((0,R.E1)(s.uuid)))},ouiaId:"roles-table",fetchData:({limit:e,offset:t,name:a,application:i,permission:s})=>{V(e,t,a,i,s,L)},sortBy:I,onSort:(t,a,i)=>{const s=`${"desc"===i?"-":""}${b[a].key}`;q({index:a,direction:i}),T((0,R.kN)({offset:0,orderBy:s,...e?.length>0?{...e.reduce(((e,t)=>({...e,[t.key]:t.value})),{})}:{name:"",application:[]}}))},emptyFilters:{name:"",application:[]},setFilterValue:t,isLoading:v,pagination:k.meta,filterPlaceholder:"role name",titlePlural:"roles",titleSingular:"role",tableId:"mua-roles"}),s().createElement(i.Suspense,{fallback:s().createElement(i.Fragment,null)},p&&s().createElement(x,{resourceDefinitions:m,isOpen:p,handleClose:()=>h({rdOpen:!1}),permission:u})));var $};I.propTypes={fetchRoles:o().func,fetchRoleForPrincipal:o().func,fetchUsers:o().func,roles:o().object,isLoading:o().bool,rolesWithAccess:o().object,filters:o().arrayOf(o().object).isRequired,setFilters:o().func.isRequired,apps:o().arrayOf(o().string).isRequired,showResourceDefinitions:o().bool};const q=I,L=({apps:e})=>{const t=(0,i.useContext)(n.A),[a,r]=(0,i.useState)(""),[o,l]=(0,i.useState)(""),[c,p]=(0,i.useState)([]),u=({name:e,application:t,permission:a})=>{"string"==typeof e&&r(e),"string"==typeof a&&l(a),t&&p("string"==typeof t?[]:t)},m=(({apps:e,isOrgAdmin:t,name:a="",application:i=[]})=>{const s=(0,d.A)();return[{key:"application",value:i,placeholder:s.formatMessage(g.A.filterByKey,{key:s.formatMessage(g.A.application).toLowerCase()}),type:"checkbox",items:e.map((e=>({label:e,value:e})))},...t?[{key:"name",type:"text",value:a,label:s.formatMessage(g.A.roleName),placeholder:s.formatMessage(g.A.filterByKey,{key:s.formatMessage(g.A.roleName).toLowerCase()})}]:[]]})({apps:e,isOrgAdmin:t,name:a,application:c,permission:o});return t?s().createElement(q,{setFilters:u,filters:m,apps:e}):s().createElement(v,{setFilters:u,filters:m,apps:e,hasActiveFilters:a.length>0||c.length>0})};L.propTypes={apps:o().arrayOf(o().string).isRequired};const T=L,V=({apps:e})=>s().createElement(T,{apps:e});V.propTypes={apps:o().arrayOf(o().string).isRequired};const $=V},2580:()=>{}}]);
//# sourceMappingURL=../sourcemaps/9282.bdfa8a361a86947c7027885e1afd7a41.js.map